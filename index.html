<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="theme-color" content="#0a1628">
<link rel="manifest" href="manifest.json">
<title>ğŸŸ æ°´æ§½ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: #0a0e1a;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    font-family: 'Zen Maru Gothic', sans-serif;
    overflow: hidden;
    user-select: none;
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }

  .header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: min(800px, calc(100vw - 40px));
    margin-bottom: 10px;
  }

  h1 {
    color: #7ec8e3;
    font-size: 1.3rem;
    letter-spacing: 0.1em;
    text-shadow: 0 0 20px rgba(126, 200, 227, 0.4);
  }

  .header-right {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .progress-display {
    font-size: 0.7rem;
    color: rgba(126, 200, 227, 0.55);
    display: flex;
    align-items: center;
    gap: 4px;
  }
  .progress-display .prog-bar {
    width: 48px;
    height: 6px;
    background: rgba(126, 200, 227, 0.1);
    border-radius: 3px;
    overflow: hidden;
  }
  .progress-display .prog-fill {
    height: 100%;
    border-radius: 3px;
    background: linear-gradient(90deg, #7ec8e3, #ffd700);
    transition: width 0.5s;
  }

  .income-display {
    color: rgba(126, 200, 227, 0.6);
    font-size: 0.75rem;
  }

  .coin-display {
    display: flex;
    align-items: center;
    gap: 8px;
    background: rgba(255, 215, 0, 0.1);
    border: 1px solid rgba(255, 215, 0, 0.3);
    border-radius: 20px;
    padding: 6px 16px;
    color: #ffd700;
    font-weight: 700;
    font-size: 1rem;
    text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
    transition: all 0.3s;
  }
  .coin-display.flash {
    background: rgba(255, 215, 0, 0.25);
    transform: scale(1.08);
  }

  .tank-wrapper {
    position: relative;
    border-radius: 16px;
    padding: 6px;
    background: linear-gradient(135deg, #1a3a4a, #0d1f2d);
    box-shadow: 0 0 40px rgba(30, 100, 160, 0.15), inset 0 0 30px rgba(0,0,0,0.3);
  }

  canvas { display: block; border-radius: 12px; cursor: pointer; }

  .coin-popup {
    position: absolute;
    color: #ffd700;
    font-weight: 700;
    font-size: 0.9rem;
    pointer-events: none;
    animation: coinPop 1s ease-out forwards;
    text-shadow: 0 0 6px rgba(255, 215, 0, 0.6);
    z-index: 10;
  }
  @keyframes coinPop {
    0% { opacity: 1; transform: translateY(0) scale(1); }
    100% { opacity: 0; transform: translateY(-40px) scale(1.3); }
  }

  .fish-tooltip {
    position: absolute;
    background: rgba(10, 20, 40, 0.92);
    border: 1px solid rgba(126, 200, 227, 0.4);
    border-radius: 12px;
    padding: 8px 14px;
    color: #cde4f0;
    font-size: 0.78rem;
    pointer-events: none;
    z-index: 20;
    white-space: nowrap;
    opacity: 0;
    transition: opacity 0.2s;
    box-shadow: 0 0 16px rgba(30, 100, 160, 0.3);
  }
  .fish-tooltip.visible { opacity: 1; }
  .fish-tooltip .tt-name { font-weight: 700; font-size: 0.85rem; margin-bottom: 2px; }
  .fish-tooltip .tt-greeting { color: rgba(126, 200, 227, 0.7); }
  .fish-tooltip .tt-stats { color: rgba(255, 215, 0, 0.7); font-size: 0.7rem; margin-top: 3px; }

  .notification {
    position: absolute;
    top: 16px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(10, 20, 40, 0.9);
    border: 1px solid rgba(126, 200, 227, 0.3);
    border-radius: 16px;
    padding: 8px 20px;
    color: #cde4f0;
    font-size: 0.8rem;
    z-index: 30;
    animation: notifAnim 3s ease-out forwards;
    white-space: nowrap;
  }
  @keyframes notifAnim {
    0% { opacity: 0; transform: translateX(-50%) translateY(-10px); }
    10% { opacity: 1; transform: translateX(-50%) translateY(0); }
    80% { opacity: 1; }
    100% { opacity: 0; transform: translateX(-50%) translateY(-10px); }
  }

  .food-selector {
    display: flex;
    gap: 6px;
    margin-top: 10px;
    align-items: center;
    flex-wrap: wrap;
    justify-content: center;
  }
  .food-selector span {
    color: rgba(126, 200, 227, 0.5);
    font-size: 0.75rem;
    margin-right: 4px;
  }

  .food-btn {
    font-family: 'Zen Maru Gothic', sans-serif;
    padding: 5px 12px;
    border: 1px solid rgba(126, 200, 227, 0.2);
    border-radius: 14px;
    background: rgba(126, 200, 227, 0.06);
    color: #7ec8e3;
    font-size: 0.75rem;
    cursor: pointer;
    transition: all 0.3s;
    white-space: nowrap;
  }
  .food-btn:hover { background: rgba(126, 200, 227, 0.15); }
  .food-btn.active {
    background: rgba(126, 200, 227, 0.2);
    border-color: rgba(126, 200, 227, 0.6);
    box-shadow: 0 0 8px rgba(126, 200, 227, 0.2);
  }
  .food-btn.locked { opacity: 0.4; cursor: not-allowed; }

  .controls {
    display: flex;
    gap: 8px;
    margin-top: 10px;
    flex-wrap: wrap;
    justify-content: center;
  }
  .controls button {
    font-family: 'Zen Maru Gothic', sans-serif;
    padding: 7px 14px;
    border: 1px solid rgba(126, 200, 227, 0.3);
    border-radius: 20px;
    background: rgba(126, 200, 227, 0.08);
    color: #7ec8e3;
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.3s;
  }
  .controls button:hover {
    background: rgba(126, 200, 227, 0.2);
    border-color: rgba(126, 200, 227, 0.6);
  }
  .controls button.active-toggle {
    background: rgba(126, 200, 227, 0.25);
    border-color: rgba(126, 200, 227, 0.7);
    box-shadow: 0 0 8px rgba(126, 200, 227, 0.2);
  }

  .shop-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.7);
    z-index: 100;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(4px);
  }
  .shop-overlay.open { display: flex; }

  .shop-panel {
    background: linear-gradient(145deg, #0f2233, #162d44);
    border: 1px solid rgba(126, 200, 227, 0.2);
    border-radius: 20px;
    padding: 28px 32px;
    max-width: 560px;
    width: 90vw;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: 0 0 60px rgba(30, 100, 160, 0.3);
  }

  .shop-title {
    color: #ffd700;
    font-size: 1.3rem;
    text-align: center;
    margin-bottom: 6px;
  }
  .shop-coins {
    text-align: center;
    color: #ffd700;
    font-size: 0.9rem;
    margin-bottom: 18px;
    opacity: 0.8;
  }
  .shop-section-title {
    color: #7ec8e3;
    font-size: 0.85rem;
    margin: 16px 0 10px;
    padding-bottom: 4px;
    border-bottom: 1px solid rgba(126, 200, 227, 0.15);
  }

  .shop-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 10px 14px;
    border-radius: 12px;
    margin-bottom: 8px;
    background: rgba(126, 200, 227, 0.04);
    border: 1px solid rgba(126, 200, 227, 0.08);
    transition: all 0.2s;
  }
  .shop-item:hover {
    background: rgba(126, 200, 227, 0.1);
    border-color: rgba(126, 200, 227, 0.2);
  }
  .shop-item-icon { font-size: 1.8rem; min-width: 36px; display: flex; align-items: center; justify-content: center; }
  .shop-item-icon img { border-radius: 6px; background: rgba(126,200,227,0.08); }
  .shop-item-info { flex: 1; }
  .shop-item-name { color: #cde4f0; font-size: 0.9rem; font-weight: 700; }
  .shop-item-desc { color: rgba(126, 200, 227, 0.5); font-size: 0.7rem; margin-top: 2px; }

  .shop-buy-btn {
    font-family: 'Zen Maru Gothic', sans-serif;
    padding: 6px 14px;
    border: 1px solid rgba(255, 215, 0, 0.3);
    border-radius: 14px;
    background: rgba(255, 215, 0, 0.1);
    color: #ffd700;
    font-size: 0.8rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s;
    white-space: nowrap;
  }
  .shop-buy-btn:hover:not(:disabled) {
    background: rgba(255, 215, 0, 0.25);
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.2);
  }
  .shop-buy-btn:disabled { opacity: 0.3; cursor: not-allowed; }
  .shop-buy-btn.owned {
    border-color: rgba(100, 200, 100, 0.4);
    color: #6bcb77;
    background: rgba(100, 200, 100, 0.1);
  }

  .shop-close {
    display: block;
    margin: 18px auto 0;
    font-family: 'Zen Maru Gothic', sans-serif;
    padding: 8px 28px;
    border: 1px solid rgba(126, 200, 227, 0.3);
    border-radius: 20px;
    background: rgba(126, 200, 227, 0.08);
    color: #7ec8e3;
    font-size: 0.85rem;
    cursor: pointer;
    transition: all 0.3s;
  }
  .shop-close:hover { background: rgba(126, 200, 227, 0.2); }

  /* ===== ã‚¬ãƒãƒ£æ¼”å‡º ===== */
  .gacha-overlay {
    display:none; position:fixed; inset:0; z-index:200;
    align-items:center; justify-content:center;
    background:rgba(0,0,0,0);
    transition: background 0.5s;
  }
  .gacha-overlay.open { display:flex; background:rgba(0,0,0,0.92); }

  /* æ‰‰æ¼”å‡º */
  .gacha-doors {
    position:fixed; inset:0; z-index:201; display:none; pointer-events:none;
  }
  .gacha-door {
    width:50%; height:100%;
    background: linear-gradient(180deg, #1a1a3e 0%, #0d0d2b 50%, #1a1a3e 100%);
    border: none; position:relative; overflow:hidden;
    transition: transform 0.8s cubic-bezier(0.6, 0, 0.2, 1);
  }
  .gacha-door::after {
    content:''; position:absolute; top:0; width:3px; height:100%;
    background: linear-gradient(180deg, transparent, rgba(126,200,227,0.6), rgba(255,215,0,0.6), rgba(126,200,227,0.6), transparent);
  }
  .gacha-door-left::after { right:0; }
  .gacha-door-right::after { left:0; }
  .gacha-door-left { transform-origin:left center; }
  .gacha-door-right { transform-origin:right center; }
  .gacha-doors.open .gacha-door-left { transform:translateX(-105%); }
  .gacha-doors.open .gacha-door-right { transform:translateX(105%); }
  .gacha-door-emblem {
    position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
    font-size:4rem; opacity:0.3;
  }

  /* å…‰ã®æŸ± */
  .gacha-pillar {
    position:fixed; top:-10%; left:50%; transform:translateX(-50%); z-index:202;
    width:0; height:120%; pointer-events:none;
    background: linear-gradient(180deg, transparent, rgba(126,200,227,0.4), rgba(255,255,255,0.6), rgba(126,200,227,0.4), transparent);
    opacity:0; transition: width 0.4s, opacity 0.3s;
  }
  .gacha-pillar.active { width:120px; opacity:1; }
  .gacha-pillar.rare {
    background: linear-gradient(180deg, transparent, rgba(255,215,0,0.5), rgba(255,255,255,0.8), rgba(255,215,0,0.5), transparent);
    width:200px;
  }

  /* ç”»é¢å‰²ã‚Œï¼ˆãƒ¬ã‚¢æ¼”å‡ºï¼‰ */
  .gacha-crack {
    position:fixed; inset:0; z-index:203; pointer-events:none;
    opacity:0; transition:opacity 0.3s;
  }
  .gacha-crack.active { opacity:1; }
  .gacha-crack svg { width:100%; height:100%; }

  /* ã‚«ãƒ¼ãƒ‰æœ¬ä½“ */
  .gacha-card {
    position:relative; width:280px; text-align:center; z-index:204;
    transform: scale(0) rotateY(180deg);
    transition: transform 0.7s cubic-bezier(0.34, 1.56, 0.64, 1);
  }
  .gacha-overlay.reveal .gacha-card { transform: scale(1) rotateY(0deg); }

  .gacha-glow {
    position:absolute; inset:-60px; border-radius:50%;
    background:radial-gradient(circle, rgba(126,200,227,0.2) 0%, transparent 70%);
    animation: gachaPulse 2s ease-in-out infinite;
  }
  .gacha-glow.rare {
    background:radial-gradient(circle, rgba(255,215,0,0.4) 0%, rgba(255,100,0,0.15) 40%, transparent 70%);
    animation: gachaPulseRare 1.5s ease-in-out infinite;
  }
  @keyframes gachaPulse {
    0%, 100% { transform:scale(1); opacity:0.6; }
    50% { transform:scale(1.2); opacity:1; }
  }
  @keyframes gachaPulseRare {
    0%, 100% { transform:scale(1); opacity:0.7; }
    50% { transform:scale(1.4); opacity:1; }
  }

  /* æ”¾å°„çŠ¶ã®å…‰ç·š */
  .gacha-rays {
    position:absolute; inset:-100px; z-index:0; pointer-events:none;
    opacity:0; transition: opacity 0.5s;
  }
  .gacha-overlay.reveal .gacha-rays { opacity:1; }
  .gacha-ray {
    position:absolute; top:50%; left:50%;
    width:2px; height:150px; transform-origin:bottom center;
    background: linear-gradient(to top, rgba(255,215,0,0.3), transparent);
    animation: rayRotate 8s linear infinite;
  }
  .gacha-rays.rare .gacha-ray {
    background: linear-gradient(to top, rgba(255,215,0,0.6), transparent);
    height:200px; width:3px;
  }
  @keyframes rayRotate { 0%{transform:rotate(var(--r))} 100%{transform:rotate(calc(var(--r) + 360deg))} }

  .gacha-icon {
    font-size:5rem; position:relative; z-index:1;
    filter: drop-shadow(0 0 20px rgba(126,200,227,0.4));
    animation: gachaFloat 2.5s ease-in-out infinite;
  }
  .gacha-icon.rare {
    filter: drop-shadow(0 0 35px rgba(255,215,0,0.9));
    animation: gachaFloat 2s ease-in-out infinite, gachaShine 3s linear infinite;
  }
  @keyframes gachaFloat {
    0%, 100% { transform:translateY(0); }
    50% { transform:translateY(-10px); }
  }
  @keyframes gachaShine {
    0% { filter: drop-shadow(0 0 35px rgba(255,215,0,0.9)) hue-rotate(0deg); }
    100% { filter: drop-shadow(0 0 35px rgba(255,215,0,0.9)) hue-rotate(360deg); }
  }

  .gacha-label {
    color:#7ec8e3; font-size:0.85rem; margin-top:8px; letter-spacing:2px;
    opacity:0; transform:translateY(10px);
    transition: opacity 0.4s 0.3s, transform 0.4s 0.3s;
  }
  .gacha-overlay.reveal .gacha-label { opacity:0.8; transform:translateY(0); }
  .gacha-label.rare { color:#ffd700; font-size:1rem; text-shadow:0 0 15px rgba(255,215,0,0.5); }

  .gacha-name {
    color:#fff; font-size:1.5rem; font-weight:900; margin-top:8px;
    text-shadow: 0 0 20px rgba(126,200,227,0.5);
    opacity:0; transform:translateY(15px) scale(0.8);
    transition: opacity 0.4s 0.5s, transform 0.5s 0.5s cubic-bezier(0.34,1.56,0.64,1);
  }
  .gacha-overlay.reveal .gacha-name { opacity:1; transform:translateY(0) scale(1); }
  .gacha-name.rare {
    color:#ffd700; font-size:1.7rem;
    text-shadow: 0 0 25px rgba(255,215,0,0.6), 0 0 50px rgba(255,100,0,0.3);
  }

  .gacha-variant-badge {
    display:inline-block; margin-top:10px; padding:5px 16px;
    border-radius:20px; font-size:0.85rem; font-weight:700;
    opacity:0; transform:scale(0);
    transition: opacity 0.3s 0.7s, transform 0.4s 0.7s cubic-bezier(0.34,1.56,0.64,1);
  }
  .gacha-overlay.reveal .gacha-variant-badge { opacity:1; transform:scale(1); }
  .gacha-variant-badge.gold { background:linear-gradient(135deg,#ffd700,#ff8f00); color:#3e2723; }
  .gacha-variant-badge.albino { background:linear-gradient(135deg,#fff,#ffcdd2); color:#4a148c; }
  .gacha-variant-badge.neon { background:linear-gradient(135deg,#00ffc8,#00b8d4); color:#004d40; }
  .gacha-variant-badge.holo { background:linear-gradient(135deg,#f44336,#4caf50,#2196f3,#ff9800); color:#fff; }

  .gacha-income {
    color:rgba(255,215,0,0.8); font-size:0.85rem; margin-top:8px;
    opacity:0; transition: opacity 0.4s 0.8s;
  }
  .gacha-overlay.reveal .gacha-income { opacity:1; }

  .gacha-close-hint {
    color:rgba(126,200,227,0.35); font-size:0.7rem; margin-top:24px;
    opacity:0; transition: opacity 0.4s 1s;
    animation: gachaBlink 2s ease-in-out infinite 1.5s;
  }
  .gacha-overlay.reveal .gacha-close-hint { opacity:1; }
  @keyframes gachaBlink {
    0%, 100% { opacity:0.35; }
    50% { opacity:0.7; }
  }

  /* ã‚¹ã‚­ãƒƒãƒ—ãƒ’ãƒ³ãƒˆ */
  .gacha-skip-hint {
    position:fixed; bottom:12%; left:50%; transform:translateX(-50%);
    z-index:210; color:rgba(126,200,227,0.4); font-size:0.75rem;
    opacity:0; transition:opacity 0.3s;
    pointer-events:none;
  }
  .gacha-skip-hint.show { opacity:1; }

  /* ç´™å¹é›ª */
  .gacha-confetti {
    position:absolute; width:8px; height:8px; border-radius:2px;
    animation: confettiFall linear forwards;
    pointer-events:none;
  }
  @keyframes confettiFall {
    0% { transform:translateY(-30px) rotate(0deg) scale(1); opacity:1; }
    100% { transform:translateY(350px) rotate(720deg) scale(0.2); opacity:0; }
  }

  /* ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ */
  .gacha-flash {
    position:fixed; inset:0; z-index:205; pointer-events:none;
    background:#fff; opacity:0; transition: opacity 0.1s;
  }
  .gacha-flash.active { opacity:0.8; }

  /* ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ */
  .gacha-opening {
    color:#ffd700; font-size:3rem; font-weight:900;
    text-shadow: 0 0 40px rgba(255,215,0,0.6);
    animation: gachaCountPulse 0.45s ease-out;
  }
  @keyframes gachaCountPulse {
    0% { transform:scale(2.5); opacity:0; }
    60% { transform:scale(0.9); opacity:1; }
    100% { transform:scale(1); opacity:1; }
  }

  /* å¤šé€£ã‚¬ãƒãƒ£çµæœã®ã‚°ãƒªãƒƒãƒ‰é …ç›®ã‚¢ãƒ‹ãƒ¡ */
  .gacha-multi-card {
    opacity:0; transform:translateY(20px) scale(0.9);
    animation: multiCardIn 0.4s ease-out forwards;
  }
  @keyframes multiCardIn {
    to { opacity:1; transform:translateY(0) scale(1); }
  }

  /* å¤šé€£çµæœã®ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ */
  .gacha-counter {
    position:fixed; top:8%; left:50%; transform:translateX(-50%);
    z-index:210; color:rgba(255,255,255,0.6); font-size:0.9rem;
    font-weight:bold; pointer-events:none;
  }

  .info {
    color: rgba(126, 200, 227, 0.45);
    font-size: 0.7rem;
    margin-top: 8px;
  }

  .area-tabs {
    display: flex;
    gap: 4px;
    margin-bottom: 6px;
    justify-content: center;
    width: min(800px, calc(100vw - 40px));
  }
  .area-tab {
    font-family: 'Zen Maru Gothic', sans-serif;
    padding: 5px 13px;
    border: 1px solid rgba(126, 200, 227, 0.15);
    border-bottom: none;
    border-radius: 12px 12px 0 0;
    background: rgba(126, 200, 227, 0.04);
    color: rgba(126, 200, 227, 0.5);
    font-size: 0.72rem;
    cursor: pointer;
    transition: all 0.3s;
    white-space: nowrap;
  }
  .area-tab:hover { background: rgba(126, 200, 227, 0.1); }
  .area-tab.active {
    background: rgba(126, 200, 227, 0.18);
    border-color: rgba(126, 200, 227, 0.5);
    color: #7ec8e3;
    font-weight: 700;
  }
  .area-tab.locked {
    opacity: 0.3;
    cursor: not-allowed;
  }
  .area-tab .tab-count {
    font-size: 0.6rem;
    opacity: 0.6;
    margin-left: 3px;
  }
</style>
</head>
<body>

<div class="header">
  <h1>ğŸŸ æ°´æ§½ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h1>
  <div class="header-right">
    <div class="progress-display" id="progressDisplay" style="cursor:pointer" onclick="openCollection()"></div>
    <div class="income-display" id="incomeDisplay"></div>
    <div class="coin-display" id="coinDisplay">
      <span>ğŸª™</span>
      <span id="coinText">0</span>
    </div>
  </div>
</div>

<div class="area-tabs" id="areaTabs"></div>

<div class="tank-wrapper" id="tankWrapper">
  <canvas id="tank"></canvas>
  <div class="fish-tooltip" id="fishTooltip">
    <div class="tt-name" id="ttName"></div>
    <div class="tt-greeting" id="ttGreeting"></div>
    <div class="tt-stats" id="ttStats"></div>
  </div>
</div>

<div class="food-selector" id="foodSelector"></div>

<div class="controls">
  <button onclick="openShop()">ğŸ›’ ã‚·ãƒ§ãƒƒãƒ—</button>
  <button onclick="openCollection()">ğŸ“– å›³é‘‘</button>
  <button id="bubbleBtn" onclick="toggleBubbler()">ğŸ«§ ãƒ–ã‚¯ãƒ–ã‚¯</button>
  <button onclick="toggleLight()">ğŸ’¡ ãƒ©ã‚¤ãƒˆ</button>
  <button onclick="killAll()" style="background:rgba(255,60,60,0.15);border-color:rgba(255,60,60,0.3)">ğŸ’€ å…¨æ»…</button>
</div>

<p class="info">æ°´æ§½ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚¨ã‚µã‚’ã‚ã’ã‚ˆã† ãƒ» é­šãŒã‚¨ã‚µã‚’é£Ÿã¹ã‚‹ã¨ã‚³ã‚¤ãƒ³GET ãƒ» æ”¾ç½®ã§ã‚‚ç¨¼ã’ã‚‹ã‚ˆï¼</p>

<div class="shop-overlay" id="shopOverlay">
  <div class="shop-panel">
    <div class="shop-title">ğŸ›’ ã‚·ãƒ§ãƒƒãƒ—</div>
    <div class="shop-coins" id="shopCoins">ğŸª™ 0</div>
    <div id="shopContents"></div>
    <button class="shop-close" onclick="closeShop()">ã¨ã˜ã‚‹</button>
  </div>
</div>

<div class="shop-overlay" id="collectionOverlay">
  <div class="shop-panel" style="max-width:640px">
    <div class="shop-title">ğŸ“– ãŠã•ã‹ãªå›³é‘‘</div>
    <div id="collectionProgress" style="text-align:center;color:rgba(126,200,227,0.7);font-size:0.85rem;margin-bottom:12px"></div>
    <div id="collectionGrid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(90px,1fr));gap:6px;max-height:60vh;overflow-y:auto;padding:4px"></div>
    <button class="shop-close" onclick="closeCollection()">ã¨ã˜ã‚‹</button>
  </div>
</div>

<!-- å›³é‘‘ é­šè©³ç´° -->
<div class="shop-overlay" id="fishDetailOverlay" style="z-index:10001">
  <div class="shop-panel" id="fishDetailPanel" style="max-width:420px">
  </div>
</div>

<!-- æ‰‰ -->
<div class="gacha-doors" id="gachaDoors">
  <div class="gacha-door gacha-door-left"><div class="gacha-door-emblem">ğŸ°</div></div>
  <div class="gacha-door gacha-door-right"><div class="gacha-door-emblem">ğŸ°</div></div>
</div>
<!-- å…‰ã®æŸ± -->
<div class="gacha-pillar" id="gachaPillar"></div>
<!-- ç”»é¢å‰²ã‚Œ -->
<div class="gacha-crack" id="gachaCrack">
  <svg viewBox="0 0 100 100" preserveAspectRatio="none">
    <path d="M50 0 L48 18 L42 25 L46 38 L38 50 L44 62 L40 75 L46 88 L50 100" stroke="rgba(255,215,0,0.7)" stroke-width="0.4" fill="none"/>
    <path d="M50 0 L53 15 L58 28 L54 42 L60 55 L56 68 L62 82 L50 100" stroke="rgba(255,215,0,0.7)" stroke-width="0.4" fill="none"/>
    <path d="M0 50 L15 48 L28 44 L40 50 L55 46 L68 50 L80 44 L100 50" stroke="rgba(255,215,0,0.5)" stroke-width="0.3" fill="none"/>
  </svg>
</div>
<!-- ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ -->
<div class="gacha-flash" id="gachaFlash"></div>
<!-- ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ï¼ˆè¤‡æ•°é€£ç”¨ï¼‰ -->
<div class="gacha-counter" id="gachaCounter" style="display:none;"></div>
<!-- ã‚¹ã‚­ãƒƒãƒ—ãƒ’ãƒ³ãƒˆ -->
<div class="gacha-skip-hint" id="gachaSkipHint">ã‚¿ãƒƒãƒ—ã§ã‚¹ã‚­ãƒƒãƒ—</div>

<div class="gacha-overlay" id="gachaOverlay">
  <div class="gacha-card" id="gachaCard">
    <div class="gacha-rays" id="gachaRays"></div>
    <div class="gacha-glow" id="gachaGlow"></div>
    <div class="gacha-icon" id="gachaIcon"></div>
    <div class="gacha-label" id="gachaLabel"></div>
    <div class="gacha-name" id="gachaName"></div>
    <div id="gachaBadge"></div>
    <div class="gacha-income" id="gachaIncome"></div>
    <div class="gacha-close-hint" id="gachaCloseHint">ã‚¿ãƒƒãƒ—ã—ã¦é–‰ã˜ã‚‹</div>
  </div>
</div>

<!-- è¤‡æ•°é€£ã¾ã¨ã‚çµæœ -->
<div class="gacha-overlay" id="gachaMultiOverlay" onclick="closeMultiGacha(event)">
  <div id="gachaMultiPanel" style="background:rgba(10,14,26,0.95);border-radius:16px;padding:20px;max-width:520px;width:92%;max-height:80vh;overflow-y:auto;border:2px solid rgba(126,200,227,0.3);">
    <div id="gachaMultiTitle" style="text-align:center;font-size:1.3rem;font-weight:bold;color:#7ec8e3;margin-bottom:14px;"></div>
    <div id="gachaMultiGrid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:10px;"></div>
    <div style="text-align:center;margin-top:16px;color:rgba(255,255,255,0.5);font-size:0.85rem;">ã‚¿ãƒƒãƒ—ã—ã¦é–‰ã˜ã‚‹</div>
  </div>
</div>

<script>
// ============================================================
// Canvas & åŸºæœ¬è¨­å®š
// ============================================================
const canvas = document.getElementById('tank');
const ctx = canvas.getContext('2d');
const tankWrapper = document.getElementById('tankWrapper');

function resize() {
  const w = Math.min(window.innerWidth - 40, 800);
  const h = Math.min(window.innerHeight - 220, 480);
  canvas.width = w;
  canvas.height = h;
}
resize();
window.addEventListener('resize', () => { resize(); initEnvironment(); });

// ============================================================
// ğŸ’° çµŒæ¸ˆã‚·ã‚¹ãƒ†ãƒ 
// ============================================================
let coins = 0;
let passiveTimer = 0;

function addCoins(amount, x, y) {
  coins += amount;
  updateCoinDisplay();
  if (x !== undefined) showCoinPopup(amount, x, y);
}

function spendCoins(amount) {
  if (coins >= amount) { coins -= amount; updateCoinDisplay(); return true; }
  return false;
}

function updateCoinDisplay() {
  document.getElementById('coinText').textContent = Math.floor(coins).toLocaleString();
  const el = document.getElementById('coinDisplay');
  el.classList.add('flash');
  setTimeout(() => el.classList.remove('flash'), 300);
}

function showCoinPopup(amount, cx, cy) {
  const popup = document.createElement('div');
  popup.className = 'coin-popup';
  popup.textContent = '+' + amount + ' ğŸª™';
  popup.style.left = (cx + 6) + 'px';
  popup.style.top = (cy - 10) + 'px';
  tankWrapper.appendChild(popup);
  setTimeout(() => popup.remove(), 1000);
}

function showNotification(text) {
  const div = document.createElement('div');
  div.className = 'notification';
  div.textContent = text;
  tankWrapper.appendChild(div);
  setTimeout(() => div.remove(), 3500);
}

function getTotalPassiveIncome() {
  let income = 0;
  // ç¾åœ¨ã®ã‚¨ãƒªã‚¢
  for (const f of fishes) income += f.getPassiveIncome();
  // ä»–ã®ã‚¨ãƒªã‚¢ã‚‚åˆç®—
  for (const a of AREAS) {
    if (a.id === currentAreaId || !a.unlocked) continue;
    for (const f of areaStates[a.id].fishes) income += f.getPassiveIncome();
  }
  return income;
}

function updateIncomeDisplay() {
  const income = getTotalPassiveIncome();
  const el = document.getElementById('incomeDisplay');
  el.textContent = income > 0 ? ('ğŸ’° ' + Math.floor(income) + 'ğŸª™/10ç§’') : '';
  updateProgressDisplay();
}

function updateProgressDisplay() {
  const col = getCollectionCompletion();
  const unlockedAreas = AREAS.filter(a => a.unlocked).length;
  const totalAreas = AREAS.length;
  // å›³é‘‘80% + ã‚¨ãƒªã‚¢20%ã®åŠ é‡å¹³å‡
  const pct = Math.round(col.percent * 0.8 + (unlockedAreas / totalAreas * 100) * 0.2);
  const el = document.getElementById('progressDisplay');
  el.innerHTML = 'ğŸ“Š ' + pct + '%<div class="prog-bar"><div class="prog-fill" style="width:'+pct+'%"></div></div>';
}

// ============================================================
// ğŸ ã‚¨ã‚µã®ç¨®é¡
// ============================================================
const FOOD_TYPES = [
  { id:'normal',    name:'æ™®é€šã®ã‚¨ã‚µ',       icon:'ğŸ', baseCoinReward:1, baseGrowAmount:0.15, color:{r:210,g:160,b:60},  size:3,   basePrice:0,    desc:'åŸºæœ¬ã®ã‚¨ã‚µã€‚ç„¡æ–™ã§ä½¿ãˆã‚‹' },
  { id:'premium',   name:'é«˜ç´šãƒ•ãƒ¬ãƒ¼ã‚¯',     icon:'âœ¨', baseCoinReward:2, baseGrowAmount:0.3,  color:{r:255,g:200,b:50},  size:3.5, basePrice:100,  desc:'å ±é…¬2å€ã€‚æˆé•·ã‚‚ã¡ã‚‡ã£ã¨æ—©ã„' },
  { id:'royal',     name:'ãƒ­ã‚¤ãƒ¤ãƒ«ãƒšãƒ¬ãƒƒãƒˆ', icon:'ğŸ‘‘', baseCoinReward:4, baseGrowAmount:0.5,  color:{r:220,g:100,b:255}, size:4,   basePrice:500,  desc:'å ±é…¬4å€ã€‚è‚²ã¡ã‚„ã™ã„ã‘ã©å¯¿å‘½æ³¨æ„' },
  { id:'legendary', name:'ä¼èª¬ã®ç”Ÿãé¤Œ',     icon:'ğŸ¦', baseCoinReward:8, baseGrowAmount:0.8,  color:{r:255,g:80,b:80},   size:4.5, basePrice:2000, desc:'å ±é…¬8å€ï¼æˆé•·ã‚‚æ—©ã„â€¦å¯¿å‘½ã‚‚æ—©ã„' },
];
let selectedFoodId = 'normal';
let foodLevels = { normal:1, premium:0, royal:0, legendary:0 };
let autoFeederLevel = 0;

function getFoodLevel(id) { return foodLevels[id] || 0; }
function isFoodUnlocked(id) { return getFoodLevel(id) >= 1; }
function getFoodCoinReward(id) {
  const ft = FOOD_TYPES.find(f => f.id === id); const lv = getFoodLevel(id);
  if (lv <= 0) return 0;
  return Math.round(ft.baseCoinReward * Math.pow(1.3, lv-1) * 10) / 10;
}
function getFoodGrowAmount(id) {
  const ft = FOOD_TYPES.find(f => f.id === id); const lv = getFoodLevel(id);
  if (lv <= 0) return 0;
  return +(ft.baseGrowAmount * (1 + (lv-1)*0.15)).toFixed(3);
}
function getFoodUpgradeCost(id) {
  const ft = FOOD_TYPES.find(f => f.id === id); const lv = getFoodLevel(id);
  if (lv >= 10) return Infinity;
  if (lv === 0) return ft.basePrice;
  if (ft.basePrice === 0) return Math.floor(10 * Math.pow(2, lv));
  return Math.floor(ft.basePrice * Math.pow(2.5, lv));
}
function getAutoFeederUpgradeCost() {
  if (autoFeederLevel >= 10) return Infinity;
  return Math.floor(300 * Math.pow(2.5, autoFeederLevel));
}
function getAutoFeederInterval() {
  if (autoFeederLevel <= 0) return Infinity;
  return Math.floor(900 - (autoFeederLevel-1)*65);
}
function getAutoFeederFoodCount() {
  if (autoFeederLevel <= 0) return 0;
  return 1 + Math.floor(autoFeederLevel / 3);
}
function getAutoFeederFoodType() {
  if (autoFeederLevel >= 10) return FOOD_TYPES.find(f => f.id === 'legendary');
  if (autoFeederLevel >= 7) return FOOD_TYPES.find(f => f.id === 'royal');
  if (autoFeederLevel >= 4) return FOOD_TYPES.find(f => f.id === 'premium');
  return FOOD_TYPES[0];
}
function getSelectedFood() { return FOOD_TYPES.find(f => f.id === selectedFoodId); }

// ============================================================
// ğŸŸ é­šã®ç¨®é¡ï¼ˆ20ç¨®ï¼‰
// ============================================================
const FISH_TYPES = [
  { id:'common', area:'freshwater', name:'ãƒãƒ¼ãƒãƒ«', icon:'ğŸŸ', shopPrice:0, unlocked:true, passiveIncome:1,
    sizeRange:[12,16], speedRange:[0.5,1.2], shape:'standard', bodyW:0.65, bodyH:0.45,
    tailStyle:'tri', dorsalStyle:'normal', patternType:'random',
    palettes:[
      {body:'#ff6b6b',fin:'#ee5a5a',belly:'#ffaaaa'},
      {body:'#ffd93d',fin:'#f0c030',belly:'#fff3b0'},
      {body:'#6bcb77',fin:'#4caf50',belly:'#a5d6a7'},
      {body:'#4dabf7',fin:'#339af0',belly:'#a5d8ff'},
    ],
    desc:'å…ƒæ°—ã„ã£ã±ã„ã®æ™®é€šã®é­š',
    greeting:'ãƒãƒ¼ãƒãƒ«ã ã‚ˆï¼å…ƒæ°—ã„ã£ã±ã„æ³³ã„ã§ã‚‹ã‚ˆï½' },

  { id:'medaka', area:'freshwater', name:'ãƒ¡ãƒ€ã‚«', icon:'ğŸ’›', shopPrice:2000, unlocked:false, passiveIncome:2,
    sizeRange:[8,11], speedRange:[0.6,1.3], shape:'standard', bodyW:0.6, bodyH:0.38,
    tailStyle:'tri', dorsalStyle:'normal', patternType:'none',
    palettes:[
      {body:'#ff9a3c',fin:'#ff8020',belly:'#ffd0a0'},
      {body:'#f5f5f5',fin:'#ddd',belly:'#fff'},
      {body:'#ffeb3b',fin:'#fdd835',belly:'#fff9c4'},
    ],
    desc:'å°ã•ãã¦ã‹ã‚ã„ã„ãƒ¡ãƒ€ã‚«',
    greeting:'ãƒ¡ãƒ€ã‚«ã ã‚ˆï½å°ã•ã„ã‘ã©é ‘å¼µã£ã¦ã‚‹ã‚ˆï¼' },

  { id:'neon', area:'freshwater', name:'ãƒã‚ªãƒ³ãƒ†ãƒˆãƒ©', icon:'âœ¨', shopPrice:5000, unlocked:false, passiveIncome:3,
    sizeRange:[9,13], speedRange:[0.8,1.5], shape:'standard', bodyW:0.65, bodyH:0.35,
    tailStyle:'fork', dorsalStyle:'normal', patternType:'neon', glowColor:'#00d4ff',
    palettes:[{body:'#00d4ff',fin:'#0099cc',belly:'#80eaff',stripe:'#ff3366'}],
    desc:'å…‰ã‚‹ä½“ãŒç¾ã—ã„ã€‚åå…¥3å€',
    greeting:'ãƒã‚ªãƒ³ãƒ†ãƒˆãƒ©ã ã‚ˆï¼ã‚­ãƒ©ã‚­ãƒ©ã§ã—ã‚‡âœ¨' },

  { id:'guppy', area:'freshwater', name:'ã‚°ãƒƒãƒ”ãƒ¼', icon:'ğŸŒˆ', shopPrice:10000, unlocked:false, passiveIncome:5,
    sizeRange:[10,14], speedRange:[0.6,1.2], shape:'standard', bodyW:0.58, bodyH:0.4,
    tailStyle:'fan', dorsalStyle:'normal', patternType:'none',
    palettes:[
      {body:'#4dabf7',fin:'#e040fb',belly:'#b3e5fc'},
      {body:'#66bb6a',fin:'#ff7043',belly:'#c8e6c9'},
      {body:'#ffa726',fin:'#ab47bc',belly:'#ffe0b2'},
    ],
    desc:'ã‚«ãƒ©ãƒ•ãƒ«ãªå°»å°¾ãŒè‡ªæ…¢ï¼',
    greeting:'ã‚°ãƒƒãƒ”ãƒ¼ã ã‚ˆï¼ã—ã£ã½ãŒè‡ªæ…¢ãªã®â™ª' },

  { id:'platy', area:'freshwater', name:'ãƒ—ãƒ©ãƒ†ã‚£', icon:'ğŸ‘', shopPrice:18000, unlocked:false, passiveIncome:7,
    sizeRange:[10,14], speedRange:[0.5,1.1], shape:'standard', bodyW:0.6, bodyH:0.42,
    tailStyle:'tri', dorsalStyle:'normal', patternType:'none',
    palettes:[
      {body:'#ff5722',fin:'#e64a19',belly:'#ffab91'},
      {body:'#ffeb3b',fin:'#f9a825',belly:'#fff9c4'},
      {body:'#29b6f6',fin:'#0288d1',belly:'#b3e5fc'},
    ],
    desc:'ä¸ˆå¤«ã§äººæ‡ã£ã“ã„ï¼',
    greeting:'ãƒ—ãƒ©ãƒ†ã‚£ã ã‚ˆï¼äººæ‡ã£ã“ã„ã‚“ã ï½' },

  { id:'corydoras', area:'freshwater', name:'ã‚³ãƒªãƒ‰ãƒ©ã‚¹', icon:'ğŸ±', shopPrice:28000, unlocked:false, passiveIncome:9,
    sizeRange:[10,14], speedRange:[0.3,0.8], shape:'standard', bodyW:0.55, bodyH:0.46,
    tailStyle:'tri', dorsalStyle:'normal', patternType:'dots', hasWhiskers:true, bottomDweller:true,
    palettes:[
      {body:'#a1887f',fin:'#8d6e63',belly:'#d7ccc8'},
      {body:'#90a4ae',fin:'#78909c',belly:'#cfd8dc'},
    ],
    desc:'åº•ã§ã‚‚ãã‚‚ãâ™ª ç™’ã—ç³»',
    greeting:'ã‚³ãƒªãƒ‰ãƒ©ã‚¹ã ã‚ˆï¼åº•ã§ã‚‚ãã‚‚ãâ™ª' },

  { id:'angel', area:'freshwater', name:'ã‚¨ãƒ³ã‚¼ãƒ«ãƒ•ã‚£ãƒƒã‚·ãƒ¥', icon:'ğŸ‘¼', shopPrice:55000, unlocked:false, passiveIncome:15,
    sizeRange:[18,24], speedRange:[0.3,0.8], shape:'standard', bodyW:0.5, bodyH:0.5,
    tailStyle:'tri', dorsalStyle:'tall', patternType:'vbands', hasVentralFin:true,
    palettes:[
      {body:'#f0f0f0',fin:'#ddd',belly:'#fff',stripe:'#333'},
      {body:'#ffd700',fin:'#e6c200',belly:'#fff3b0',stripe:'#996600'},
    ],
    desc:'å„ªé›…ãªæ³³ãã€‚åå…¥14å€',
    greeting:'ã‚¨ãƒ³ã‚¼ãƒ«ãƒ•ã‚£ãƒƒã‚·ãƒ¥ã ã‚ˆï¼å„ªé›…ã§ã—ã‚‡ï¼Ÿ' },

  { id:'betta', area:'freshwater', name:'ãƒ™ã‚¿', icon:'ğŸŒ¸', shopPrice:75000, unlocked:false, passiveIncome:18,
    sizeRange:[16,22], speedRange:[0.3,0.7], shape:'standard', bodyW:0.55, bodyH:0.42,
    tailStyle:'flowing', dorsalStyle:'flowing', patternType:'none',
    palettes:[
      {body:'#cc5de8',fin:'#9b30d1',belly:'#e599f7'},
      {body:'#e53935',fin:'#c62828',belly:'#ff8a80'},
      {body:'#1e88e5',fin:'#1565c0',belly:'#90caf9'},
    ],
    desc:'ãƒ’ãƒ©ãƒ’ãƒ©ã®å¤§ããªãƒ’ãƒ¬',
    greeting:'ãƒ™ã‚¿ã ã‚ˆï¼ãƒ’ãƒ©ãƒ’ãƒ©ï½ç¶ºéº—ã§ã—ã‚‡ï¼Ÿ' },

  { id:'clown', area:'coral', name:'ã‚¯ãƒãƒãƒŸ', icon:'ğŸ ', shopPrice:1100000, unlocked:false, passiveIncome:60,
    sizeRange:[11,15], speedRange:[0.5,1.0], shape:'standard', bodyW:0.55, bodyH:0.44,
    tailStyle:'tri', dorsalStyle:'normal', patternType:'bands',
    palettes:[{body:'#ff6d00',fin:'#e65100',belly:'#ffab40',stripe:'#fff'}],
    desc:'ç™½ã„å¸¯ãŒãƒãƒ£ãƒ¼ãƒ ãƒã‚¤ãƒ³ãƒˆ',
    greeting:'ã‚¯ãƒãƒãƒŸã ã‚ˆï¼ã‚¤ã‚½ã‚®ãƒ³ãƒãƒ£ã‚¯æ¢ã—ä¸­â€¦' },

  { id:'discus', area:'coral', name:'ãƒ‡ã‚£ã‚¹ã‚«ã‚¹', icon:'ğŸ”®', shopPrice:2000000, unlocked:false, passiveIncome:100,
    sizeRange:[18,24], speedRange:[0.3,0.7], shape:'standard', bodyW:0.48, bodyH:0.52,
    tailStyle:'tri', dorsalStyle:'normal', patternType:'swirl',
    palettes:[
      {body:'#e53935',fin:'#c62828',belly:'#ff8a80',stripe:'#1e88e5'},
      {body:'#1e88e5',fin:'#1565c0',belly:'#90caf9',stripe:'#ff6f00'},
      {body:'#43a047',fin:'#2e7d32',belly:'#a5d6a7',stripe:'#fdd835'},
    ],
    desc:'ç†±å¸¯é­šã®ç‹æ§˜ï¼å††ç›¤å‹',
    greeting:'ãƒ‡ã‚£ã‚¹ã‚«ã‚¹ã ã‚ˆï¼ç†±å¸¯é­šã®ç‹æ§˜âœ¨' },

  { id:'arowana', area:'tropical', name:'ã‚¢ãƒ­ãƒ¯ãƒŠ', icon:'ğŸ‰', shopPrice:25000000, unlocked:false, passiveIncome:880,
    sizeRange:[28,36], speedRange:[0.4,0.8], shape:'standard', bodyW:0.85, bodyH:0.33,
    tailStyle:'tri', dorsalStyle:'normal', patternType:'scales', hasWhiskers:true,
    palettes:[{body:'#ffd700',fin:'#daa520',belly:'#fff8dc',stripe:'#b8860b'}],
    desc:'ä¼èª¬ã®é¾é­šã€‚å¨å³ãŒã™ã”ã„',
    greeting:'ã‚¢ãƒ­ãƒ¯ãƒŠã ã‚ˆï¼é¾ã¿ãŸã„ã§ã—ã‚‡ï¼Ÿ' },

  { id:'mandarin', area:'coral', name:'ãƒãƒ³ãƒ€ãƒªãƒ³ãƒ•ã‚£ãƒƒã‚·ãƒ¥', icon:'ğŸ¨', shopPrice:2500000, unlocked:false, passiveIncome:120,
    sizeRange:[10,14], speedRange:[0.3,0.7], shape:'standard', bodyW:0.55, bodyH:0.46,
    tailStyle:'tri', dorsalStyle:'normal', patternType:'swirl', glowColor:'rgba(0,180,255,0.3)',
    palettes:[{body:'#0097a7',fin:'#00838f',belly:'#80deea',stripe:'#ff6f00'}],
    desc:'ä¸–ç•Œä¸€ãŠã—ã‚ƒã‚Œãªé­šï¼',
    greeting:'ãƒãƒ³ãƒ€ãƒªãƒ³ã ã‚ˆï¼ä¸–ç•Œä¸€ãŠã—ã‚ƒã‚Œâ™ª' },

  { id:'seahorse', area:'coral', name:'ã‚¿ãƒ„ãƒã‚ªãƒˆã‚·ã‚´', icon:'ğŸª¸', shopPrice:3200000, unlocked:false, passiveIncome:150,
    sizeRange:[16,22], speedRange:[0.2,0.5], shape:'seahorse', bodyW:0.3, bodyH:0.8,
    tailStyle:'curl', dorsalStyle:'small', patternType:'none',
    palettes:[
      {body:'#ffb300',fin:'#ff8f00',belly:'#ffe082'},
      {body:'#e91e63',fin:'#c2185b',belly:'#f48fb1'},
    ],
    desc:'ã‚†ã‚‰ã‚†ã‚‰æ³³ãä¸æ€è­°ãªå§¿',
    greeting:'ã‚¿ãƒ„ãƒã‚ªãƒˆã‚·ã‚´ã ã‚ˆï¼ã‚†ã‚‰ã‚†ã‚‰ï½' },

  { id:'puffer', area:'coral', name:'ãƒ•ã‚°', icon:'ğŸ¡', shopPrice:4000000, unlocked:false, passiveIncome:180,
    sizeRange:[14,20], speedRange:[0.3,0.7], shape:'puffer', bodyW:0.5, bodyH:0.5,
    tailStyle:'tiny', dorsalStyle:'small', patternType:'dots',
    palettes:[
      {body:'#a1887f',fin:'#8d6e63',belly:'#efebe9',stripe:'#5d4037'},
      {body:'#78909c',fin:'#546e7a',belly:'#eceff1',stripe:'#37474f'},
    ],
    desc:'ã·ãã·ãè†¨ã‚‰ã‚€ã‚ˆï¼Ÿ',
    greeting:'ãƒ•ã‚°ã ã‚ˆï¼ã·ãã·ãè†¨ã‚‰ã‚€ã‚ˆï¼Ÿ' },

  { id:'butterfly', area:'coral', name:'ãƒãƒ§ã‚¦ãƒãƒ§ã‚¦ã‚¦ã‚ª', icon:'ğŸ¦‹', shopPrice:6500000, unlocked:false, passiveIncome:270,
    sizeRange:[14,18], speedRange:[0.4,0.9], shape:'standard', bodyW:0.45, bodyH:0.5,
    tailStyle:'tri', dorsalStyle:'tall', patternType:'eyespot',
    palettes:[
      {body:'#ffd600',fin:'#ffab00',belly:'#fff9c4',stripe:'#1a1a2e'},
      {body:'#e0e0e0',fin:'#bdbdbd',belly:'#fafafa',stripe:'#ff6f00'},
    ],
    desc:'è¶ã®ã‚ˆã†ã«ç¾ã—ã„ï¼',
    greeting:'ãƒãƒ§ã‚¦ãƒãƒ§ã‚¦ã‚¦ã‚ªã ã‚ˆï¼è¶ã¿ãŸã„ã§ã—ã‚‡ï¼Ÿ' },

  { id:'oarfish', area:'deepsea', name:'ãƒªãƒ¥ã‚¦ã‚°ã‚¦ãƒãƒ„ã‚«ã‚¤', icon:'ğŸ', shopPrice:2000000, unlocked:false, passiveIncome:100,
    sizeRange:[20,28], speedRange:[0.3,0.6], shape:'serpent', bodyW:1.2, bodyH:0.15,
    tailStyle:'long', dorsalStyle:'crest', patternType:'none',
    palettes:[{body:'#b0bec5',fin:'#e53935',belly:'#eceff1',stripe:'#c62828'}],
    desc:'æ·±æµ·ã‹ã‚‰ã‚„ã£ã¦ããŸï¼è¶…ãƒ¬ã‚¢',
    greeting:'ãƒªãƒ¥ã‚¦ã‚°ã‚¦ãƒãƒ„ã‚«ã‚¤ã ã‚ˆï¼æ·±æµ·ã‹ã‚‰æ¥ãŸã‚ˆï½' },

  { id:'coelacanth', area:'deepsea', name:'ã‚·ãƒ¼ãƒ©ã‚«ãƒ³ã‚¹', icon:'ğŸ¦•', shopPrice:12000000, unlocked:false, passiveIncome:520,
    sizeRange:[24,32], speedRange:[0.3,0.6], shape:'standard', bodyW:0.75, bodyH:0.42,
    tailStyle:'lobe', dorsalStyle:'normal', patternType:'scales',
    palettes:[{body:'#37474f',fin:'#263238',belly:'#546e7a',stripe:'#455a64'}],
    desc:'ç”ŸããŸåŒ–çŸ³ï¼å¤ªå¤ã®é­š',
    greeting:'ã‚·ãƒ¼ãƒ©ã‚«ãƒ³ã‚¹ã ã‚ˆï¼ç”ŸããŸåŒ–çŸ³ãªã‚“ã ï¼' },

  { id:'manta', area:'deepsea', name:'ãƒãƒ³ã‚¿', icon:'ğŸ¦‡', shopPrice:24000000, unlocked:false, passiveIncome:980,
    sizeRange:[30,40], speedRange:[0.3,0.6], shape:'manta', bodyW:1.0, bodyH:0.3,
    tailStyle:'whip', dorsalStyle:'none', patternType:'none',
    palettes:[{body:'#37474f',fin:'#263238',belly:'#eceff1'}],
    desc:'å¤§ããªç¿¼ã§å„ªé›…ã«æ³³ã',
    greeting:'ãƒãƒ³ã‚¿ã ã‚ˆï¼å¤§ãã„ç¿¼ã§ã—ã‚‡ï½ï¼Ÿ' },

  { id:'whaleshark', area:'deepsea', name:'ã‚¸ãƒ³ãƒ™ã‚¨ã‚¶ãƒ¡', icon:'ğŸ³', shopPrice:45000000, unlocked:false, passiveIncome:1750,
    sizeRange:[34,44], speedRange:[0.25,0.5], shape:'standard', bodyW:0.85, bodyH:0.4,
    tailStyle:'fork', dorsalStyle:'normal', patternType:'spots',
    palettes:[{body:'#455a64',fin:'#37474f',belly:'#cfd8dc',stripe:'#eceff1'}],
    desc:'å„ªã—ã„å·¨äººã€‚æ°´æ§½ã®ä¸»',
    greeting:'ã‚¸ãƒ³ãƒ™ã‚¨ã‚¶ãƒ¡ã ã‚ˆï¼å„ªã—ã„å·¨äººã ã‚ˆâœ¨' },

  { id:'dragongod', area:'mystic', name:'é¾ç¥', icon:'ğŸ²', shopPrice:50000000, unlocked:false, passiveIncome:1500,
    sizeRange:[32,42], speedRange:[0.3,0.7], shape:'mythic', bodyW:0.9, bodyH:0.3,
    tailStyle:'flowing', dorsalStyle:'flowing', patternType:'scales',
    glowColor:'rgba(255,215,0,0.5)',
    palettes:[{body:'#ffd700',fin:'#ff6f00',belly:'#fff8e1',stripe:'#e65100'}],
    desc:'ä¼èª¬ã®å®ˆã‚Šç¥ã€‚æœ€å¼·ã®é­š',
    greeting:'é¾ç¥ã ã‚ˆâ€¦æ°´æ§½ã®å®ˆã‚Šç¥ã˜ã‚ƒ' },

  // ===== æ–°é­šï¼šæ·¡æ°´ =====
  { id:'killifish', area:'freshwater', name:'ã‚­ãƒªãƒ•ã‚£ãƒƒã‚·ãƒ¥', icon:'ğŸŒ¿', shopPrice:800, unlocked:false, passiveIncome:1,
    sizeRange:[8,11], speedRange:[0.7,1.4], shape:'standard', bodyW:0.58, bodyH:0.35,
    tailStyle:'tri', dorsalStyle:'normal', patternType:'vstripes',
    palettes:[{body:'#e65100',fin:'#bf360c',belly:'#ffcc80',stripe:'#fff3e0'},{body:'#1565c0',fin:'#0d47a1',belly:'#90caf9',stripe:'#bbdefb'}],
    desc:'å°ã•ãã¦ã‚«ãƒ©ãƒ•ãƒ«ãªç†±å¸¯é­š',
    greeting:'ã‚­ãƒªãƒ•ã‚£ãƒƒã‚·ãƒ¥ã ã‚ˆï¼ã¡ã£ã¡ã‚ƒã„ã§ã—ã‚‡ï¼Ÿ' },
  { id:'loach', area:'freshwater', name:'ãƒ‰ã‚¸ãƒ§ã‚¦', icon:'ğŸ', shopPrice:40000, unlocked:false, passiveIncome:12,
    sizeRange:[16,22], speedRange:[0.3,0.7], shape:'serpent', bodyW:0.9, bodyH:0.15,
    tailStyle:'long', dorsalStyle:'small', patternType:'dots', hasWhiskers:true, bottomDweller:true,
    palettes:[{body:'#8d6e63',fin:'#6d4c41',belly:'#d7ccc8',stripe:'#a1887f'}],
    desc:'åº•ã§ã‚‚ãã‚‚ãã€‚ãƒ’ã‚²ãŒãƒãƒ£ãƒ¼ãƒ ãƒã‚¤ãƒ³ãƒˆ',
    greeting:'ãƒ‰ã‚¸ãƒ§ã‚¦ã ã‚ˆï½åº•ãŒè½ã¡ç€ãã‚“ã â™ª' },
  { id:'goldfish', area:'freshwater', name:'é‡‘é­š', icon:'ğŸ®', shopPrice:100000, unlocked:false, passiveIncome:22,
    sizeRange:[14,20], speedRange:[0.4,0.9], shape:'standard', bodyW:0.5, bodyH:0.48,
    tailStyle:'flowing', dorsalStyle:'flowing', patternType:'none',
    palettes:[{body:'#ff3d00',fin:'#dd2c00',belly:'#ffab91'},{body:'#fff176',fin:'#fff9c4',belly:'#ffffff'}],
    desc:'ã²ã‚‰ã²ã‚‰å„ªé›…ãªå’Œã®é­š',
    greeting:'é‡‘é­šã ã‚ˆï½ã²ã‚‰ã²ã‚‰ï½â™ª' },
  { id:'koi', area:'freshwater', name:'éŒ¦é¯‰', icon:'ğŸ', shopPrice:140000, unlocked:false, passiveIncome:28,
    sizeRange:[22,30], speedRange:[0.3,0.7], shape:'standard', bodyW:0.75, bodyH:0.38,
    tailStyle:'fan', dorsalStyle:'normal', patternType:'bands',
    palettes:[{body:'#ffffff',fin:'#ffccbc',belly:'#fff',stripe:'#ff3d00'},{body:'#ffd600',fin:'#ff6f00',belly:'#fff8e1',stripe:'#e65100'}],
    desc:'æ³³ãå®çŸ³ã€‚å’Œã®è±¡å¾´',
    greeting:'éŒ¦é¯‰ã ã‚ˆï¼æ³³ãå®çŸ³ã£ã¦å‘¼ã°ã‚Œã¦ã‚‹ã®âœ¨' },
  { id:'axolotl', area:'freshwater', name:'ã‚¦ãƒ¼ãƒ‘ãƒ¼ãƒ«ãƒ¼ãƒ‘ãƒ¼', icon:'ğŸ©·', shopPrice:200000, unlocked:false, passiveIncome:35,
    sizeRange:[16,22], speedRange:[0.2,0.5], shape:'puffer', bodyW:0.5, bodyH:0.45,
    tailStyle:'tiny', dorsalStyle:'small', patternType:'dots',
    palettes:[{body:'#ffcdd2',fin:'#ef9a9a',belly:'#fff',stripe:'#e57373'},{body:'#e0e0e0',fin:'#bdbdbd',belly:'#fafafa',stripe:'#9e9e9e'}],
    desc:'ã«ã£ã“ã‚Šç¬‘é¡”ã®ç™’ã—ç³»',
    greeting:'ã‚¦ãƒ¼ãƒ‘ãƒ¼ãƒ«ãƒ¼ãƒ‘ãƒ¼ã ã‚ˆï¼ã«ã“ã£â˜º' },
  { id:'arapaima', area:'freshwater', name:'ãƒ”ãƒ©ãƒ«ã‚¯ãƒ¼', icon:'ğŸŠ', shopPrice:300000, unlocked:false, passiveIncome:45,
    sizeRange:[32,42], speedRange:[0.3,0.6], shape:'standard', bodyW:0.9, bodyH:0.35,
    tailStyle:'tri', dorsalStyle:'normal', patternType:'scales',
    palettes:[{body:'#455a64',fin:'#37474f',belly:'#78909c',stripe:'#e53935'}],
    desc:'ä¸–ç•Œæœ€å¤§ç´šã®æ·¡æ°´é­šï¼',
    greeting:'ãƒ”ãƒ©ãƒ«ã‚¯ãƒ¼ã ã‚ˆï¼ã§ã£ã‹ã„ã§ã—ã‚‡ï¼Ÿ' },

  // ===== æ–°é­šï¼šã‚µãƒ³ã‚´ç¤ =====
  { id:'surgeonfish', area:'coral', name:'ãƒŠãƒ³ãƒ¨ã‚¦ãƒã‚®', icon:'ğŸ’™', shopPrice:500000, unlocked:false, passiveIncome:30,
    sizeRange:[12,16], speedRange:[0.5,1.1], shape:'standard', bodyW:0.52, bodyH:0.48,
    tailStyle:'fork', dorsalStyle:'normal', patternType:'bands',
    palettes:[{body:'#1565c0',fin:'#0d47a1',belly:'#42a5f5',stripe:'#ffd600'}],
    desc:'é’ã¨é»„è‰²ã®ã‚µãƒ³ã‚´ã®äººæ°—è€…',
    greeting:'ãƒŠãƒ³ãƒ¨ã‚¦ãƒã‚®ã ã‚ˆï¼ãƒ‰ãƒªãƒ¼ã£ã¦å‘¼ã‚“ã§â™ª' },
  { id:'lionfish', area:'coral', name:'ãƒŸãƒã‚«ã‚µã‚´', icon:'ğŸ¦', shopPrice:800000, unlocked:false, passiveIncome:45,
    sizeRange:[16,22], speedRange:[0.3,0.7], shape:'standard', bodyW:0.55, bodyH:0.45,
    tailStyle:'flowing', dorsalStyle:'tall', patternType:'vstripes',
    palettes:[{body:'#d32f2f',fin:'#b71c1c',belly:'#ffcdd2',stripe:'#fff'}],
    desc:'ç¾ã—ãã‚‚å±é™ºãªãƒ’ãƒ¬æŒã¡',
    greeting:'ãƒŸãƒã‚«ã‚µã‚´ã ã‚ˆï¼ãƒ’ãƒ¬ã«è§¦ã‚‰ãªã„ã§ã­ï¼' },
  { id:'moorishidol', area:'coral', name:'ãƒ„ãƒãƒ€ã‚·', icon:'ğŸ¹', shopPrice:1500000, unlocked:false, passiveIncome:80,
    sizeRange:[14,20], speedRange:[0.4,0.9], shape:'standard', bodyW:0.4, bodyH:0.55,
    tailStyle:'tri', dorsalStyle:'tall', patternType:'vbands',
    palettes:[{body:'#fff176',fin:'#ffd600',belly:'#fff9c4',stripe:'#212121'}],
    desc:'é•·ã„ãƒ„ãƒãŒãƒˆãƒ¬ãƒ¼ãƒ‰ãƒãƒ¼ã‚¯',
    greeting:'ãƒ„ãƒãƒ€ã‚·ã ã‚ˆï¼ã“ã®ãƒ„ãƒã€ã‚«ãƒƒã‚³ã„ã„ã§ã—ã‚‡ï¼Ÿ' },
  { id:'triggerfish', area:'coral', name:'ãƒ¢ãƒ³ã‚¬ãƒ©ã‚«ãƒ¯ãƒã‚®', icon:'ğŸ¯', shopPrice:5000000, unlocked:false, passiveIncome:220,
    sizeRange:[14,20], speedRange:[0.4,0.8], shape:'standard', bodyW:0.55, bodyH:0.5,
    tailStyle:'tri', dorsalStyle:'normal', patternType:'dots',
    palettes:[{body:'#1a237e',fin:'#283593',belly:'#e8eaf6',stripe:'#ffd600'}],
    desc:'ãƒ‰æ´¾æ‰‹ãªæ°´ç‰æ¨¡æ§˜ï¼',
    greeting:'ãƒ¢ãƒ³ã‚¬ãƒ©ã‚«ãƒ¯ãƒã‚®ã ã‚ˆï¼æ´¾æ‰‹ã§ã—ã‚‡ï½ï¼Ÿ' },
  { id:'napoleonfish', area:'coral', name:'ãƒŠãƒãƒ¬ã‚ªãƒ³ãƒ•ã‚£ãƒƒã‚·ãƒ¥', icon:'ğŸ«…', shopPrice:8000000, unlocked:false, passiveIncome:330,
    sizeRange:[26,34], speedRange:[0.3,0.6], shape:'standard', bodyW:0.7, bodyH:0.45,
    tailStyle:'tri', dorsalStyle:'normal', patternType:'scales',
    palettes:[{body:'#1565c0',fin:'#0d47a1',belly:'#64b5f6',stripe:'#0d47a1'}],
    desc:'ã§ã£ã‹ã„ã‚ªãƒ‡ã‚³ã®ç‹è€…',
    greeting:'ãƒŠãƒãƒ¬ã‚ªãƒ³ãƒ•ã‚£ãƒƒã‚·ãƒ¥ã ã‚ˆï¼ã“ã®ã‚ªãƒ‡ã‚³ãŒè‡ªæ…¢ï¼' },
  { id:'seaturtle', area:'coral', name:'ã‚¦ãƒŸã‚¬ãƒ¡', icon:'ğŸ¢', shopPrice:10000000, unlocked:false, passiveIncome:400,
    sizeRange:[28,36], speedRange:[0.25,0.5], shape:'manta', bodyW:0.8, bodyH:0.35,
    tailStyle:'whip', dorsalStyle:'none', patternType:'scales',
    palettes:[{body:'#2e7d32',fin:'#1b5e20',belly:'#a5d6a7',stripe:'#388e3c'}],
    desc:'æ‚ ã€…ã¨æ³³ãæµ·ã®æ—…äºº',
    greeting:'ã‚¦ãƒŸã‚¬ãƒ¡ã ã‚ˆï½ã®ã‚“ã³ã‚Šæ—…ã—ã¦ã‚‹ã®ğŸŒŠ' },

  // ===== æ–°é­šï¼šæ·±æµ· =====
  { id:'anglerfish', area:'deepsea', name:'ãƒãƒ§ã‚¦ãƒãƒ³ã‚¢ãƒ³ã‚³ã‚¦', icon:'ğŸ”¦', shopPrice:3500000, unlocked:false, passiveIncome:160,
    sizeRange:[14,20], speedRange:[0.2,0.5], shape:'puffer', bodyW:0.55, bodyH:0.5,
    tailStyle:'tiny', dorsalStyle:'small', patternType:'none',
    glowColor:'rgba(100,255,100,0.4)',
    palettes:[{body:'#37474f',fin:'#263238',belly:'#455a64',stripe:'#69f0ae'}],
    desc:'æš—é—‡ã§å…‰ã‚‹ä¸æ€è­°ãªé‡£ã‚Šç«¿',
    greeting:'ãƒãƒ§ã‚¦ãƒãƒ³ã‚¢ãƒ³ã‚³ã‚¦ã ã‚ˆâ€¦å…‰ã«ã¤ã„ã¦ãã¦â€¦' },
  { id:'viperfish', area:'deepsea', name:'ãƒ›ã‚¦ãƒ©ã‚¤ã‚¨ã‚½', icon:'ğŸ—¡ï¸', shopPrice:5500000, unlocked:false, passiveIncome:250,
    sizeRange:[14,20], speedRange:[0.4,0.9], shape:'standard', bodyW:0.7, bodyH:0.3,
    tailStyle:'fork', dorsalStyle:'normal', patternType:'neon',
    glowColor:'rgba(0,255,136,0.4)',
    palettes:[{body:'#212121',fin:'#111',belly:'#424242',stripe:'#00ff88'}],
    desc:'é‹­ã„ç‰™ã¨å…‰ã‚‹ä½“',
    greeting:'ãƒ›ã‚¦ãƒ©ã‚¤ã‚¨ã‚½ã ã‚ˆâ€¦ã“ã®ç‰™ã€æ€–ã„ï¼Ÿ' },
  { id:'giantisopod', area:'deepsea', name:'ãƒ€ã‚¤ã‚ªã‚¦ã‚°ã‚½ã‚¯ãƒ ã‚·', icon:'ğŸª²', shopPrice:8000000, unlocked:false, passiveIncome:360,
    sizeRange:[16,22], speedRange:[0.15,0.4], shape:'puffer', bodyW:0.55, bodyH:0.5,
    tailStyle:'tiny', dorsalStyle:'small', patternType:'scales', bottomDweller:true,
    palettes:[{body:'#78909c',fin:'#546e7a',belly:'#b0bec5',stripe:'#607d8b'}],
    desc:'æ·±æµ·ã®ãƒ€ãƒ³ã‚´ãƒ ã‚·ã€‚å¤§äººæ°—ï¼',
    greeting:'ã‚°ã‚½ã‚¯ãƒ ã‚·ã ã‚ˆâ€¦ã˜ã£ã¨ã—ã¦ã‚‹ã®ãŒå¥½ãâ€¦' },
  { id:'gulpereel', area:'deepsea', name:'ãƒ•ã‚¯ãƒ­ã‚¦ãƒŠã‚®', icon:'ğŸ‘„', shopPrice:17000000, unlocked:false, passiveIncome:720,
    sizeRange:[18,26], speedRange:[0.2,0.5], shape:'serpent', bodyW:1.0, bodyH:0.2,
    tailStyle:'long', dorsalStyle:'small', patternType:'none',
    glowColor:'rgba(255,50,100,0.3)',
    palettes:[{body:'#212121',fin:'#d32f2f',belly:'#424242',stripe:'#ff5252'}],
    desc:'å·¨å¤§ãªå£ãŒç‰¹å¾´ã®æ·±æµ·é­š',
    greeting:'ãƒ•ã‚¯ãƒ­ã‚¦ãƒŠã‚®ã ã‚ˆâ€¦ãŠå£ãŠã£ãã„ã§ã—ã‚‡ï¼Ÿ' },
  { id:'vampiresquid', area:'deepsea', name:'ãƒ¡ãƒ³ãƒ€ã‚³', icon:'ğŸ‘»', shopPrice:33000000, unlocked:false, passiveIncome:1300,
    sizeRange:[16,22], speedRange:[0.2,0.5], shape:'manta', bodyW:0.7, bodyH:0.4,
    tailStyle:'whip', dorsalStyle:'none', patternType:'none',
    glowColor:'rgba(255,51,102,0.4)',
    palettes:[{body:'#c62828',fin:'#b71c1c',belly:'#ef9a9a',stripe:'#ff5252'}],
    desc:'æ·±æµ·ã®å¹½éœŠã€‚ã²ã‚‰ã²ã‚‰æ¼‚ã†',
    greeting:'ãƒ¡ãƒ³ãƒ€ã‚³ã ã‚ˆâ€¦ãµã‚ãµã‚ï½ğŸ‘»' },
  { id:'barreleye', area:'deepsea', name:'ãƒ‡ãƒ¡ãƒ‹ã‚®ã‚¹', icon:'ğŸ”®', shopPrice:60000000, unlocked:false, passiveIncome:2300,
    sizeRange:[12,18], speedRange:[0.2,0.5], shape:'standard', bodyW:0.6, bodyH:0.45,
    tailStyle:'tri', dorsalStyle:'normal', patternType:'none',
    glowColor:'rgba(0,255,204,0.5)',
    palettes:[{body:'rgba(100,130,160,0.6)',fin:'rgba(80,110,140,0.5)',belly:'rgba(200,220,240,0.4)',stripe:'#00ffcc'}],
    desc:'é€æ˜ãªé ­ã®ä¸­ã«ç·‘ã®ç›®ï¼',
    greeting:'ãƒ‡ãƒ¡ãƒ‹ã‚®ã‚¹ã ã‚ˆâ€¦é ­ã®ä¸­ã€è¦‹ãˆã‚‹ï¼Ÿ' },

  // ===== æ–°é­šï¼šç†±å¸¯æ²³å· =====
  { id:'piranha', area:'tropical', name:'ãƒ”ãƒ©ãƒ‹ã‚¢', icon:'ğŸ˜ˆ', shopPrice:15000000, unlocked:false, passiveIncome:550,
    sizeRange:[12,16], speedRange:[0.6,1.2], shape:'standard', bodyW:0.5, bodyH:0.48,
    tailStyle:'tri', dorsalStyle:'normal', patternType:'none',
    palettes:[{body:'#546e7a',fin:'#37474f',belly:'#e53935',stripe:'#c62828'}],
    desc:'å°ã•ã„ã‘ã©å‡¶æš´ï¼ç¾¤ã‚ŒãŒæ€–ã„',
    greeting:'ãƒ”ãƒ©ãƒ‹ã‚¢ã ã‚ˆï¼ã‚¬ãƒ–ãƒƒï¼â€¦ãªã‚“ã¦ã­ğŸ˜ˆ' },
  { id:'oscar', area:'tropical', name:'ã‚ªã‚¹ã‚«ãƒ¼', icon:'ğŸ”¥', shopPrice:40000000, unlocked:false, passiveIncome:1400,
    sizeRange:[18,24], speedRange:[0.3,0.7], shape:'standard', bodyW:0.6, bodyH:0.42,
    tailStyle:'tri', dorsalStyle:'normal', patternType:'spots',
    palettes:[{body:'#37474f',fin:'#263238',belly:'#455a64',stripe:'#ff6d00'}],
    desc:'è³¢ãã¦äººæ‡ã£ã“ã„å¤§å‹é­š',
    greeting:'ã‚ªã‚¹ã‚«ãƒ¼ã ã‚ˆï¼ã”é£¯ã¾ã ï¼ŸğŸ”¥' },
  { id:'stingray', area:'tropical', name:'æ·¡æ°´ã‚¨ã‚¤', icon:'ğŸŒ€', shopPrice:65000000, unlocked:false, passiveIncome:2200,
    sizeRange:[22,30], speedRange:[0.25,0.5], shape:'manta', bodyW:0.9, bodyH:0.3,
    tailStyle:'whip', dorsalStyle:'none', patternType:'dots',
    palettes:[{body:'#5d4037',fin:'#4e342e',belly:'#d7ccc8',stripe:'#fff176'}],
    desc:'æ°´ç‰æ¨¡æ§˜ã®ç¾ã—ã„ã‚¨ã‚¤',
    greeting:'æ·¡æ°´ã‚¨ã‚¤ã ã‚ˆï½æ°´ç‰ãŒãƒãƒ£ãƒ¼ãƒ ãƒã‚¤ãƒ³ãƒˆâ™ª' },
  { id:'flowerhorn', area:'tropical', name:'ãƒ•ãƒ©ãƒ¯ãƒ¼ãƒ›ãƒ¼ãƒ³', icon:'ğŸŒº', shopPrice:100000000, unlocked:false, passiveIncome:3300,
    sizeRange:[20,28], speedRange:[0.3,0.7], shape:'standard', bodyW:0.55, bodyH:0.5,
    tailStyle:'tri', dorsalStyle:'tall', patternType:'swirl',
    palettes:[{body:'#e53935',fin:'#c62828',belly:'#ff8a80',stripe:'#ffd600'}],
    desc:'ç«‹æ´¾ãªã‚³ãƒ–ãŒç¦ã‚’å‘¼ã¶ï¼',
    greeting:'ãƒ•ãƒ©ãƒ¯ãƒ¼ãƒ›ãƒ¼ãƒ³ã ã‚ˆï¼ã“ã®ã‚³ãƒ–ã€ç¸èµ·ã„ã„ã®âœ¨' },
  { id:'redtailcatfish', area:'tropical', name:'ãƒ¬ãƒƒãƒ‰ãƒ†ãƒ¼ãƒ«ã‚­ãƒ£ãƒƒãƒˆ', icon:'ğŸ±', shopPrice:160000000, unlocked:false, passiveIncome:5100,
    sizeRange:[30,38], speedRange:[0.25,0.5], shape:'standard', bodyW:0.8, bodyH:0.38,
    tailStyle:'tri', dorsalStyle:'normal', patternType:'bands', hasWhiskers:true,
    palettes:[{body:'#37474f',fin:'#263238',belly:'#eceff1',stripe:'#e53935'}],
    desc:'èµ¤ã„å°»å°¾ã®å·¨å¤§ãƒŠãƒã‚º',
    greeting:'ãƒ¬ãƒƒãƒ‰ãƒ†ãƒ¼ãƒ«ã‚­ãƒ£ãƒƒãƒˆã ã‚ˆï¼å¤§ãããªã‚‹ã‚ˆï½' },
  { id:'electriceel', area:'tropical', name:'ãƒ‡ãƒ³ã‚­ã‚¦ãƒŠã‚®', icon:'âš¡', shopPrice:250000000, unlocked:false, passiveIncome:7800,
    sizeRange:[22,30], speedRange:[0.3,0.6], shape:'serpent', bodyW:1.1, bodyH:0.15,
    tailStyle:'long', dorsalStyle:'small', patternType:'neon',
    glowColor:'rgba(255,255,0,0.4)',
    palettes:[{body:'#37474f',fin:'#263238',belly:'#78909c',stripe:'#ffff00'}],
    desc:'ãƒ“ãƒªãƒ“ãƒªé›»æ°—ã®å±é™ºãªå¥´',
    greeting:'ãƒ‡ãƒ³ã‚­ã‚¦ãƒŠã‚®ã ã‚ˆâš¡ ãƒ“ãƒªãƒƒã¨ã—ã¡ã‚ƒã†ãï¼' },

  // ===== æ–°é­šï¼šç¥ç§˜ =====
  { id:'phoenix', area:'mystic', name:'é³³å‡°é­š', icon:'ğŸ”¥', shopPrice:90000000, unlocked:false, passiveIncome:2600,
    sizeRange:[28,36], speedRange:[0.3,0.7], shape:'mythic', bodyW:0.85, bodyH:0.3,
    tailStyle:'flowing', dorsalStyle:'flowing', patternType:'scales',
    glowColor:'rgba(255,100,0,0.5)',
    palettes:[{body:'#ff6d00',fin:'#dd2c00',belly:'#ffe0b2',stripe:'#ff3d00'}],
    desc:'ç‚ã‚’ã¾ã¨ã†ä¸æ­»é³¥ã®é­š',
    greeting:'é³³å‡°é­šã ã‚ˆâ€¦ç‚ã®ç¿¼ã§èˆã†ã®ã˜ã‚ƒğŸ”¥' },
  { id:'leviathan', area:'mystic', name:'ãƒªãƒ´ã‚¡ã‚¤ã‚¢ã‚µãƒ³', icon:'ğŸŒŠ', shopPrice:150000000, unlocked:false, passiveIncome:4200,
    sizeRange:[34,44], speedRange:[0.2,0.5], shape:'serpent', bodyW:1.3, bodyH:0.18,
    tailStyle:'long', dorsalStyle:'crest', patternType:'scales',
    glowColor:'rgba(0,100,255,0.4)',
    palettes:[{body:'#0d47a1',fin:'#1a237e',belly:'#42a5f5',stripe:'#82b1ff'}],
    desc:'æµ·ã®åº•ã«æ½œã‚€ä¼èª¬ã®å·¨ç£',
    greeting:'ãƒªãƒ´ã‚¡ã‚¤ã‚¢ã‚µãƒ³ã â€¦æ·±æ·µã‚ˆã‚Šæ¥ãŸã‚Šâ€¦' },
  { id:'moonjellyfish', area:'mystic', name:'æœˆå…‰ã‚¯ãƒ©ã‚²', icon:'ğŸŒ™', shopPrice:250000000, unlocked:false, passiveIncome:6800,
    sizeRange:[18,26], speedRange:[0.15,0.4], shape:'seahorse', bodyW:0.4, bodyH:0.6,
    tailStyle:'curl', dorsalStyle:'small', patternType:'none',
    glowColor:'rgba(200,200,255,0.5)',
    palettes:[{body:'rgba(180,180,255,0.7)',fin:'rgba(150,150,230,0.5)',belly:'rgba(220,220,255,0.6)'}],
    desc:'æœˆã®å…‰ã‚’å®¿ã™å¹»ã®ã‚¯ãƒ©ã‚²',
    greeting:'æœˆå…‰ã‚¯ãƒ©ã‚²ã ã‚ˆâ€¦æœˆã®å…‰ã‚’ã‚ã’ã‚‹ğŸŒ™' },
  { id:'crystaldragon', area:'mystic', name:'æ°´æ™¶é¾', icon:'ğŸ’', shopPrice:400000000, unlocked:false, passiveIncome:10500,
    sizeRange:[32,42], speedRange:[0.3,0.6], shape:'mythic', bodyW:0.9, bodyH:0.3,
    tailStyle:'flowing', dorsalStyle:'flowing', patternType:'scales',
    glowColor:'rgba(180,100,255,0.5)',
    palettes:[{body:'rgba(180,140,255,0.8)',fin:'#7c4dff',belly:'rgba(220,200,255,0.6)',stripe:'#b388ff'}],
    desc:'æ°´æ™¶ã®é±—ã‚’æŒã¤ç¥é¾',
    greeting:'æ°´æ™¶é¾ã ã‚ˆâ€¦ã“ã®é±—ã€ç¶ºéº—ã§ã—ã‚‡ï¼ŸğŸ’' },
  { id:'cosmicwhale', area:'mystic', name:'å®‡å®™ã‚¯ã‚¸ãƒ©', icon:'ğŸŒŒ', shopPrice:650000000, unlocked:false, passiveIncome:16500,
    sizeRange:[36,46], speedRange:[0.2,0.4], shape:'manta', bodyW:1.1, bodyH:0.35,
    tailStyle:'whip', dorsalStyle:'none', patternType:'spots',
    glowColor:'rgba(100,0,200,0.4)',
    palettes:[{body:'#1a0a3a',fin:'#0a0020',belly:'#311b92',stripe:'#e0e0e0'}],
    desc:'æ˜Ÿç©ºã‚’æ³³ãè¶…å·¨å¤§ã‚¯ã‚¸ãƒ©',
    greeting:'å®‡å®™ã‚¯ã‚¸ãƒ©ã ã‚ˆâ€¦æ˜Ÿã®æµ·ã‚’æ—…ã—ã¦ããŸã®ğŸŒŒ' },
  { id:'worldserpent', area:'mystic', name:'ä¸–ç•Œè›‡', icon:'ğŸ', shopPrice:1000000000, unlocked:false, passiveIncome:25000,
    sizeRange:[36,46], speedRange:[0.25,0.5], shape:'serpent', bodyW:1.4, bodyH:0.2,
    tailStyle:'long', dorsalStyle:'crest', patternType:'scales',
    glowColor:'rgba(0,255,100,0.5)',
    palettes:[{body:'#1b5e20',fin:'#2e7d32',belly:'#a5d6a7',stripe:'#69f0ae'}],
    desc:'ä¸–ç•Œã‚’ä¸€å‘¨ã™ã‚‹ä¼èª¬ã®å¤§è›‡',
    greeting:'ä¸–ç•Œè›‡ã â€¦ä¸‡ç‰©ã®å§‹ã¾ã‚Šã¨çµ‚ã‚ã‚Šã‚’è¦‹ã¦ããŸâ€¦' },
];

// ============================================================
// ğŸ”§ è¨­å‚™ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰
// ============================================================
const UPGRADES = [
  { id:'treasureGen', name:'ãŠå®ãƒãƒ–ãƒ«è£…ç½®', icon:'ğŸ’', price:800, desc:'ãŠå®ãƒãƒ–ãƒ«ãŒå‡ºã‚„ã™ããªã‚‹', owned:false },
  { id:'breedBoost', name:'ç¹æ®–ã‚µãƒãƒ¼ã‚¿ãƒ¼', icon:'ğŸ’•', price:2000, desc:'é­šã®ç¹æ®–ç¢ºç‡2å€ï¼', owned:false },
];

const FISH_SVGS = {
  'common': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <path d='M 30 64 C 30 40 70 30 90 40 C 110 50 110 70 90 80 C 70 90 30 88 30 64 Z' fill='%238DA6AD'/> <path d='M 90 60 C 95 50 105 45 115 50 C 120 55 120 75 115 80 C 105 85 95 80 90 70 Z' fill='%238DA6AD'/> <path d='M 50 40 C 55 30 65 25 70 30 C 65 35 55 38 50 40 Z' fill='%238DA6AD'/> <path d='M 50 88 C 55 98 65 103 70 98 C 65 93 55 90 50 88 Z' fill='%238DA6AD'/> <circle cx='65' cy='55' r='12' fill='white'/> <circle cx='67' cy='57' r='8' fill='black'/> <circle cx='70' cy='52' r='3' fill='white'/> <path d='M 40 68 Q 45 72 50 68' stroke='black' stroke-width='2' fill='none'/> <path d='M 50 50 Q 55 58 50 65' stroke='black' stroke-width='1.5' fill='none'/> </svg>",
  'medaka': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' fill='none' xmlns='http://www.w3.org/2000/svg'> <path d='M20 64C20 40 35 30 50 30H75C90 30 100 40 100 64C100 88 90 98 75 98H50C35 98 20 88 20 64Z' fill='%23FFD700'/> <path d='M100 64C100 88 90 98 75 98H50C35 98 20 88 20 64C20 40 35 30 50 30H75C90 30 100 40 100 64Z' stroke='%23CCAA00' stroke-width='2'/> <path d='M100 64C100 64 110 54 115 50L117 64L115 78C110 74 100 64 100 64Z' fill='%23FFD700'/> <path d='M100 64C100 64 110 54 115 50L117 64L115 78C110 74 100 64 100 64Z' stroke='%23CCAA00' stroke-width='2'/> <ellipse cx='60' cy='55' rx='10' ry='12' fill='white'/> <ellipse cx='62' cy='56' rx='5' ry='6' fill='black'/> <circle cx='64' cy='53' r='2' fill='white'/> <path d='M50 80C55 85 65 85 70 80' stroke='black' stroke-width='2' stroke-linecap='round'/> <path d='M60 40C60 35 55 30 50 30C45 30 40 35 40 40' stroke='%23CCAA00' stroke-width='2'/> <path d='M70 40C70 35 75 30 80 30C85 30 90 35 90 40' stroke='%23CCAA00' stroke-width='2'/> <path d='M50 88C50 93 55 98 60 98C65 98 70 93 70 88' stroke='%23CCAA00' stroke-width='2'/> <path d='M80 88C80 93 85 98 90 98C95 98 100 93 100 88' stroke='%23CCAA00' stroke-width='2'/> </svg>",
  'neon': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <path d='M25 64 C25 40 70 30 100 45 C110 50 115 60 110 70 C100 85 70 90 25 64Z' fill='%23ff69b4'/> <path d='M100 45 L115 35 L120 64 L115 90 L100 70 Z' fill='%23DA70D6'/> <path d='M70 45 L75 35 L80 45 Z' fill='%23DA70D6'/> <path d='M70 80 L75 90 L80 80 Z' fill='%23DA70D6'/> <path d='M28 58 C28 50 70 40 95 50 C100 52 100 58 95 60 C70 70 28 66 28 58Z' fill='%2300bfff'/> <path d='M28 68 C28 60 70 50 95 60 C100 62 100 68 95 70 C70 80 28 76 28 68Z' fill='%23ff0000'/> <circle cx='45' cy='55' r='10' fill='white'/> <circle cx='48' cy='58' r='5' fill='black'/> <circle cx='45' cy='55' r='3' fill='white' opacity='0.8'/> <circle cx='47' cy='57' r='1.5' fill='white' opacity='0.8'/> </svg>",
  'guppy': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <path d='M 30 55 C 20 65, 20 75, 30 85 L 50 85 C 60 85, 70 75, 70 65 C 70 55, 60 45, 50 45 L 30 55 Z' fill='%23FFC0CB'/> <path d='M 25 65 C 25 55, 35 45, 45 45 C 50 45, 55 55, 55 65 C 55 75, 50 85, 45 85 C 35 85, 25 75, 25 65 Z' fill='%23FFECB3'/> <circle cx='40' cy='58' r='8' fill='black'/> <circle cx='43' cy='55' r='3' fill='white'/> <path d='M 50 45 C 60 35, 70 35, 75 45 C 70 45, 60 50, 50 45 Z' fill='%2390EE90'/> <path d='M 45 75 C 50 80, 55 75, 50 70 C 45 65, 40 70, 45 75 Z' fill='%23ADD8E6'/> <path d='M 70 65 C 80 50, 90 40, 110 45 C 105 55, 100 65, 110 75 C 90 80, 80 70, 70 65 Z' fill='url(%23rainbowGradient)'/> <defs> <linearGradient id='rainbowGradient' x1='0%' y1='0%' x2='100%' y2='0%'> <stop offset='0%' style='stop-color:red;stop-opacity:1' /> <stop offset='16.6%' style='stop-color:orange;stop-opacity:1' /> <stop offset='33.3%' style='stop-color:yellow;stop-opacity:1' /> <stop offset='50%' style='stop-color:green;stop-opacity:1' /> <stop offset='66.6%' style='stop-color:blue;stop-opacity:1' /> <stop offset='83.3%' style='stop-color:indigo;stop-opacity:1' /> <stop offset='100%' style='stop-color:violet;stop-opacity:1' /> </linearGradient> </defs> </svg>",
  'platy': "data:image/svg+xml,<svg viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <path d='M30 64 C30 35, 75 30, 95 64 C75 98, 30 93, 30 64' fill='%23FF5733'/> <path d='M95 64 C100 50, 115 55, 120 64 C115 73, 100 78, 95 64' fill='%23FF5733'/> <path d='M60 40 C65 30, 75 35, 70 45 L60 40' fill='%23FF5733'/> <path d='M55 88 C60 98, 70 93, 65 83 L55 88' fill='%23FF5733'/> <ellipse cx='45' cy='64' rx='4' ry='8' fill='%23FF7F50' transform='rotate(5 45 64)'/> <circle cx='58' cy='55' r='10' fill='white'/> <circle cx='62' cy='58' r='6' fill='black'/> <circle cx='64' cy='54' r='2' fill='white'/> <path d='M35 70 Q40 75, 45 70' stroke='black' stroke-width='2' fill='none'/> </svg>",
  'corydoras': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <path d='M 30 70 C 20 50, 40 30, 70 30 C 100 30, 110 50, 100 70 C 90 90, 60 90, 30 70 Z' fill='%23b0c4de'/> <path d='M 100 70 C 105 75, 110 70, 115 65 C 110 60, 105 55, 100 60 Z' fill='%23a8d8e0'/> <path d='M 60 30 C 65 20, 75 20, 80 30 C 75 35, 65 35, 60 30 Z' fill='%23a8d8e0'/> <path d='M 40 75 C 35 80, 40 85, 45 80 C 50 75, 45 70, 40 75 Z' fill='%23a8d8e0'/> <path d='M 70 85 C 75 90, 80 90, 85 85 C 80 80, 75 80, 70 85 Z' fill='%23a8d8e0'/> <circle cx='50' cy='45' r='3' fill='%238090a0'/> <circle cx='65' cy='40' r='2' fill='%238090a0'/> <circle cx='75' cy='50' r='4' fill='%238090a0'/> <circle cx='60' cy='60' r='3' fill='%238090a0'/> <circle cx='85' cy='60' r='2' fill='%238090a0'/> <circle cx='55' cy='48' r='8' fill='white'/> <circle cx='55' cy='48' r='5' fill='black'/> <circle cx='57' cy='46' r='2' fill='white'/> <path d='M 30 65 C 35 68, 35 62, 30 65 Z' fill='none' stroke='black' stroke-width='1.5'/> <path d='M 30 65 Q 25 60, 20 65' fill='none' stroke='black' stroke-width='1.5'/> <path d='M 30 65 Q 25 70, 20 75' fill='none' stroke='black' stroke-width='1.5'/> <path d='M 30 68 Q 28 72, 23 72' fill='none' stroke='black' stroke-width='1.5'/> </svg>",
  'angel': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' fill='none' xmlns='http://www.w3.org/2000/svg'> <defs> <linearGradient id='stripes' x1='0%' y1='0%' x2='100%' y2='0%'> <stop offset='0%' stop-color='%23FFDD00'/> <stop offset='15%' stop-color='%23FFDD00'/> <stop offset='15%' stop-color='%23FFFFFF'/> <stop offset='30%' stop-color='%23FFFFFF'/> <stop offset='30%' stop-color='%23FFDD00'/> <stop offset='45%' stop-color='%23FFDD00'/> <stop offset='45%' stop-color='%23FFFFFF'/> <stop offset='60%' stop-color='%23FFFFFF'/> <stop offset='60%' stop-color='%23FFDD00'/> <stop offset='75%' stop-color='%23FFDD00'/> <stop offset='75%' stop-color='%23FFFFFF'/> <stop offset='90%' stop-color='%23FFFFFF'/> <stop offset='90%' stop-color='%23FFDD00'/> <stop offset='100%' stop-color='%23FFDD00'/> </linearGradient> </defs> <path d='M64 16L96 64L64 112L32 64L64 16Z' fill='url(%23stripes)' stroke='%23000000' stroke-width='2'/> <path d='M64 16C70 10 75 10 75 10C85 15 90 20 90 20L96 64C90 50 75 30 64 16Z' fill='%23FFAAAA' stroke='%23000000' stroke-width='2'/> <path d='M64 16C58 10 53 10 53 10C43 15 38 20 38 20L32 64C38 50 53 30 64 16Z' fill='%23FFAAAA' stroke='%23000000' stroke-width='2'/> <path d='M64 112C70 118 75 118 75 118C85 113 90 108 90 108L96 64C90 78 75 98 64 112Z' fill='%23FFAAAA' stroke='%23000000' stroke-width='2'/> <path d='M64 112C58 118 53 118 53 118C43 113 38 108 38 108L32 64C38 78 53 98 64 112Z' fill='%23FFAAAA' stroke='%23000000' stroke-width='2'/> <path d='M96 64C105 60 115 55 120 50C125 55 125 73 120 78C115 73 105 68 96 64Z' fill='%23FFAAAA' stroke='%23000000' stroke-width='2'/> <path d='M78 58C80 59 80 62 78 63' stroke='%23000000' stroke-width='2' stroke-linecap='round'/> <circle cx='70' cy='50' r='10' fill='%23FFFFFF' stroke='%23000000' stroke-width='2'/> <circle cx='73' cy='53' r='4' fill='%23000000'/> <circle cx='74' cy='52' r='1.5' fill='%23FFFFFF'/> </svg>",
  'betta': "data:image/svg+xml,<svg viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <defs> <linearGradient id='bodyGradient' x1='0%' y1='0%' x2='100%' y2='0%'> <stop offset='0%' style='stop-color:%23FF69B4' /> <stop offset='100%' style='stop-color:%23DA70D6' /> </linearGradient> <linearGradient id='finGradient' x1='0%' y1='0%' x2='100%' y2='0%'> <stop offset='0%' style='stop-color:%23DA70D6' /> <stop offset='100%' style='stop-color:%23FF6347' /> </linearGradient> </defs> <ellipse cx='60' cy='64' rx='30' ry='20' fill='url(%23bodyGradient)' /> <path d='M78 64 Q85 50 90 60 Q85 78 78 64 Z' fill='url(%23bodyGradient)' /> <path d='M55 45 Q70 20 85 40 Q75 55 55 45 Z' fill='url(%23finGradient)' stroke='%238A2BE2' stroke-width='1' /> <path d='M85 64 Q105 40 120 55 Q100 70 120 80 Q105 95 85 64 Z' fill='url(%23finGradient)' stroke='%238A2BE2' stroke-width='1' /> <path d='M55 80 Q70 105 85 85 Q75 70 55 80 Z' fill='url(%23finGradient)' stroke='%238A2BE2' stroke-width='1' /> <path d='M45 70 Q55 80 65 70 Q55 60 45 70 Z' fill='url(%23finGradient)' opacity='0.8' /> <circle cx='50' cy='55' r='8' fill='white' /> <circle cx='50' cy='55' r='4' fill='black' /> <circle cx='52' cy='53' r='1.5' fill='white' /> </svg>",
  'clown': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <ellipse cx='60' cy='64' rx='45' ry='30' fill='%23FF8C00'/> <path d='M95 64 C105 54, 105 74, 95 64 Z' fill='%23FF8C00'/> <path d='M100 64 C105 50, 120 50, 115 64 C120 78, 105 78, 100 64 Z' fill='%23FF8C00'/> <path d='M40 38 C45 30, 55 30, 50 38 C55 46, 45 46, 40 38 Z' fill='%23FF8C00'/> <path d='M35 75 C40 65, 50 65, 45 75 C50 85, 40 85, 35 75 Z' fill='%23FF8C00'/> <rect x='25' y='40' width='10' height='48' fill='white' rx='3' ry='3'/> <rect x='55' y='38' width='10' height='52' fill='white' rx='3' ry='3'/> <rect x='85' y='40' width='10' height='48' fill='white' rx='3' ry='3'/> <circle cx='38' cy='50' r='10' fill='white'/> <circle cx='38' cy='50' r='6' fill='black'/> <circle cx='41' cy='48' r='2' fill='white'/> </svg>",
  'discus': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <ellipse cx='60' cy='64' rx='45' ry='40' fill='%23FFC0CB'/> <ellipse cx='60' cy='64' rx='43' ry='38' fill='%23ADD8E6'/> <path d='M60 24 C50 10, 40 20, 45 40 L60 24' fill='%23FFA07A'/> <path d='M60 104 C50 118, 40 108, 45 88 L60 104' fill='%23FFA07A'/> <path d='M95 64 C110 50, 110 78, 95 64' fill='%23FFA07A'/> <path d='M25 60 C30 50, 35 55, 30 65 L25 60' fill='%23C0C0C0'/> <circle cx='40' cy='50' r='8' fill='%23FFFFFF'/> <circle cx='42' cy='52' r='5' fill='%23000000'/> <circle cx='44' cy='49' r='2' fill='%23FFFFFF'/> </svg>",
  'arowana': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <path d='M20 55 C10 65 10 75 20 85 L100 85 C115 85 120 75 115 65 C120 55 115 45 100 45 L20 45 Z' fill='%23C0C0C0' stroke='%23808080' stroke-width='2'/> <ellipse cx='40' cy='65' rx='7' ry='5' fill='%23E0E0E0' stroke='%23A0A0A0' stroke-width='1'/> <ellipse cx='55' cy='65' rx='7' ry='5' fill='%23E0E0E0' stroke='%23A0A0A0' stroke-width='1'/> <ellipse cx='70' cy='65' rx='7' ry='5' fill='%23E0E0E0' stroke='%23A0A0A0' stroke-width='1'/> <ellipse cx='85' cy='65' rx='7' ry='5' fill='%23E0E0E0' stroke='%23A0A0A0' stroke-width='1'/> <ellipse cx='47' cy='55' rx='7' ry='5' fill='%23E0E0E0' stroke='%23A0A0A0' stroke-width='1'/> <ellipse cx='62' cy='55' rx='7' ry='5' fill='%23E0E0E0' stroke='%23A0A0A0' stroke-width='1'/> <ellipse cx='77' cy='55' rx='7' ry='5' fill='%23E0E0E0' stroke='%23A0A0A0' stroke-width='1'/> <ellipse cx='47' cy='75' rx='7' ry='5' fill='%23E0E0E0' stroke='%23A0A0A0' stroke-width='1'/> <ellipse cx='62' cy='75' rx='7' ry='5' fill='%23E0E0E0' stroke='%23A0A0A0' stroke-width='1'/> <ellipse cx='77' cy='75' rx='7' ry='5' fill='%23E0E0E0' stroke='%23A0A0A0' stroke-width='1'/> <path d='M70 45 L90 35 L85 45 Z' fill='%23D3D3D3' stroke='%23A0A0A0' stroke-width='1'/> <path d='M70 85 L90 95 L85 85 Z' fill='%23D3D3D3' stroke='%23A0A0A0' stroke-width='1'/> <path d='M100 45 C110 35 120 40 115 65 C120 90 110 95 100 85 Z' fill='%23D3D3D3' stroke='%23A0A0A0' stroke-width='2'/> <ellipse cx='35' cy='75' rx='8' ry='5' transform='rotate(-20 35 75)' fill='%23D3D3D3' stroke='%23A0A0A0' stroke-width='1'/> <path d='M20 55 C25 50 35 50 40 55 C40 80 25 80 20 85 Z' fill='%23C0C0C0' stroke='%23808080' stroke-width='2'/> <circle cx='35' cy='60' r='10' fill='white' stroke='black' stroke-width='2'/> <circle cx='38' cy='63' r='4' fill='black'/> <circle cx='32' cy='58' r='2' fill='white'/> <circle cx='36' cy='60' r='1' fill='white'/> <path d='M25 70 C30 70 30 73 25 73' stroke='black' stroke-width='1' fill='none'/> </svg>",
  'mandarin': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <path d='M20 64 C20 30, 80 30, 100 60 C110 90, 80 98, 20 64' fill='%2300BFFF'/> <path d='M40 50 C45 35, 60 35, 65 50 L60 55 C55 40, 40 40, 35 55 Z' fill='%23FFA500'/> <path d='M60 60 C65 45, 80 45, 85 60 L80 65 C75 50, 60 50, 55 65 Z' fill='%23FFA500'/> <path d='M80 70 C85 55, 100 55, 105 70 L100 75 C95 60, 80 60, 75 75 Z' fill='%23FFA500'/> <path d='M45 35 Q55 20, 70 30 L65 38 Q50 25, 45 35 Z' fill='%23FFA500'/> <path d='M45 93 Q55 108, 70 98 L65 90 Q50 103, 45 93 Z' fill='%23FFA500'/> <path d='M30 70 Q25 80, 40 78 L38 68 Q28 72, 30 70 Z' fill='%2300BFFF'/> <path d='M100 60 Q115 50, 120 60 Q115 70, 100 68 C100 68, 100 60, 100 60 Z' fill='%23FFA500'/> <path d='M100 64 L120 64 L100 64 Z' fill='%2300BFFF'/> <circle cx='55' cy='60' r='10' fill='white'/> <circle cx='58' cy='62' r='6' fill='black'/> <circle cx='60' cy='58' r='2' fill='white'/> </svg>",
  'seahorse': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <defs> <radialGradient id='seahorseGradient' cx='50%' cy='50%' r='50%' fx='50%' fy='50%'> <stop offset='0%' style='stop-color:%23FFD700;stop-opacity:1' /> <stop offset='100%' style='stop-color:%23FFA500;stop-opacity:1' /> </radialGradient> </defs> <path d='M60 20 C40 5 30 30 30 50 C30 70 50 80 60 85 C70 90 90 90 90 70 C90 50 70 30 60 20 Z' fill='url(%23seahorseGradient)' stroke='%23FF8C00' stroke-width='2'/> <path d='M60 20 C75 10 90 10 95 20 C100 30 85 40 70 30 Z' fill='url(%23seahorseGradient)' stroke='%23FF8C00' stroke-width='2'/> <path d='M60 85 C40 100 30 110 40 120 C50 130 70 110 60 95 Z' fill='url(%23seahorseGradient)' stroke='%23FF8C00' stroke-width='2'/> <path d='M40 120 C30 115 20 110 30 100 C40 90 50 100 40 105 Z' fill='url(%23seahorseGradient)' stroke='%23FF8C00' stroke-width='2'/> <path d='M90 70 C100 60 105 50 95 45 C85 40 80 50 90 60 Z' fill='%23FF8C00' opacity='0.7'/> <circle cx='80' cy='30' r='8' fill='white'/> <circle cx='82' cy='32' r='3' fill='black'/> <circle cx='83' cy='29' r='1.5' fill='white'/> </svg>",
  'puffer': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' fill='none' xmlns='http://www.w3.org/2000/svg'> <g id='pufferfish'> <ellipse cx='64' cy='64' rx='45' ry='35' fill='%23FFDDC1'/> <circle cx='35' cy='45' r='4' fill='%23FFA07A'/> <circle cx='50' cy='35' r='4' fill='%23FFA07A'/> <circle cx='70' cy='30' r='4' fill='%23FFA07A'/> <circle cx='85' cy='40' r='4' fill='%23FFA07A'/> <circle cx='95' cy='55' r='4' fill='%23FFA07A'/> <circle cx='90' cy='70' r='4' fill='%23FFA07A'/> <circle cx='75' cy='85' r='4' fill='%23FFA07A'/> <circle cx='55' cy='90' r='4' fill='%23FFA07A'/> <circle cx='40' cy='78' r='4' fill='%23FFA07A'/> <path d='M109 64 C115 58, 120 60, 115 70 C110 75, 109 64, 109 64 Z' fill='%23FFA07A'/> <path d='M70 30 C75 20, 80 25, 75 35 L70 30 Z' fill='%23FFA07A'/> <path d='M70 95 C75 105, 80 100, 75 90 L70 95 Z' fill='%23FFA07A'/> <circle cx='75' cy='55' r='10' fill='white'/> <circle cx='78' cy='57' r='7' fill='black'/> <circle cx='80' cy='53' r='3' fill='white'/> <circle cx='58' cy='55' r='8' fill='white'/> <circle cx='60' cy='57' r='5' fill='black'/> <circle cx='62' cy='53' r='2' fill='white'/> <path d='M68 75 C70 78, 75 78, 77 75 C75 73, 70 73, 68 75 Z' fill='%238B4513'/> </g> </svg>",
  'butterfly': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <path d='M15,64 C15,35 60,10 95,30 C120,40 120,80 95,98 C60,118 15,90 15,64 Z' fill='%23FFD700'/> <path d='M45,30 C50,15 70,10 80,25 L75,30 L45,30 Z' fill='%23FFD700'/> <path d='M45,30 C50,15 70,10 80,25' stroke='%23000000' stroke-width='2' fill='none'/> <path d='M45,98 C50,113 70,118 80,103 L75,98 L45,98 Z' fill='%23FFD700'/> <path d='M45,98 C50,113 70,118 80,103' stroke='%23000000' stroke-width='2' fill='none'/> <path d='M110,64 C115,50 125,55 120,64 C125,73 115,78 110,64 Z' fill='%23FFD700'/> <path d='M110,64 C115,50 M125,55 L120,64 M125,55 L120,64 C125,73 M115,78 L110,64' stroke='%23000000' stroke-width='2' fill='none'/> <path d='M40,50 C45,40 60,40 65,50 L60,75 C55,85 40,85 35,75 L40,50 Z' fill='%23000000'/> <circle cx='50' cy='62' r='10' fill='%23FFFFFF'/> <circle cx='55' cy='64' r='5' fill='%23000000'/> <circle cx='57' cy='60' r='1.5' fill='%23FFFFFF'/> <circle cx='52' cy='66' r='1' fill='%23FFFFFF'/> <path d='M25,70 C30,75 35,75 40,70' stroke='%23000000' stroke-width='2' fill='none'/> </svg>",
  'oarfish': "data:image/svg+xml,<svg viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <path d='M10 64 C20 50, 40 55, 60 60 S80 65, 100 68 S115 70, 120 72 M10 64 C20 78, 40 73, 60 68 S80 63, 100 60 S115 58, 120 56' fill='%23C0C0C0' stroke='%23A9A9A9' stroke-width='2' stroke-linejoin='round' stroke-linecap='round'/> <path d='M10 64 C20 50, 40 55, 60 60 S80 65, 100 68 S115 70, 120 72' fill='none' stroke='%23C0C0C0' stroke-width='6'/> <path d='M10 64 C20 78, 40 73, 60 68 S80 63, 100 60 S115 58, 120 56' fill='none' stroke='%23C0C0C0' stroke-width='6'/> <path d='M10 64 C20 50, 40 55, 60 60 S80 65, 100 68 S115 70, 120 72 M10 64 C20 78, 40 73, 60 68 S80 63, 100 60 S115 58, 120 56' fill='%23E0E0E0' stroke='none'/> <path d='M10 64 Q25 58, 40 64 Q25 70, 10 64 Z' fill='%23E0E0E0' stroke='%23A9A9A9' stroke-width='1'/> <path d='M18 68 Q22 69, 26 68 Q22 67, 18 68 Z' fill='%23F0F0F0' stroke='%23A9A9A9' stroke-width='0.5'/> <path d='M25 50 Q30 40, 35 50 Q30 45, 25 50 Z' fill='%23FF0000' stroke='%23CC0000' stroke-width='1'/> <path d='M30 52 Q35 42, 40 52 Q35 47, 30 52 Z' fill='%23FF0000' stroke='%23CC0000' stroke-width='1'/> <path d='M35 54 Q40 44, 45 54 Q40 49, 35 54 Z' fill='%23FF0000' stroke='%23CC0000' stroke-width='1'/> <circle cx='30' cy='62' r='6' fill='%23FFF'/> <circle cx='30' cy='62' r='4' fill='%23000'/> <circle cx='32' cy='60' r='1.5' fill='%23FFF'/> </svg>",
  'coelacanth': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <path d='M25 60 C10 60 15 85 30 85 H90 C110 85 115 65 105 55 C95 45 80 40 70 45 C60 50 40 50 25 60 Z' fill='%23778899'/> <path d='M100 55 L120 45 L115 60 L120 75 L100 65 Z' fill='%23778899'/> <path d='M60 40 C65 30 75 30 80 40 L70 45 L60 40 Z' fill='%23778899'/> <path d='M35 65 C40 75 40 85 30 80 L25 70 L35 65 Z' fill='%23778899'/> <path d='M55 75 C60 85 65 85 60 80 L50 75 L55 75 Z' fill='%23778899'/> <path d='M75 75 C80 85 85 85 80 80 L70 75 L75 75 Z' fill='%23778899'/> <circle cx='50' cy='55' r='10' fill='%23000'/> <circle cx='55' cy='52' r='3' fill='%23fff'/> <path d='M30 65 Q40 70 45 65' stroke='%23000' stroke-width='2' fill='none'/> </svg>",
  'manta': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <defs> <radialGradient id='bellyGradient' cx='50%' cy='50%' r='50%' fx='50%' fy='50%'> <stop offset='0%' stop-color='%23FFFFFF'/> <stop offset='100%' stop-color='%23E0E0E0'/> </radialGradient> </defs> <path d='M 30 50 C 10 55, 10 75, 30 80 L 100 80 C 120 75, 120 55, 100 50 L 30 50 Z' fill='%23202028'/> <path d='M 35 60 C 20 62, 20 70, 35 72 L 95 72 C 110 70, 110 62, 95 60 L 35 60 Z' fill='url(%23bellyGradient)'/> <path d='M 25 60 C 20 60, 20 70, 25 70 L 35 70 L 35 60 Z' fill='%23202028'/> <circle cx='45' cy='58' r='7' fill='%23FFFFFF'/> <circle cx='45' cy='58' r='4' fill='%23000000'/> <circle cx='47' cy='56' r='1.5' fill='%23FFFFFF'/> <path d='M 95 66 C 100 66, 110 68, 115 70 C 110 72, 100 74, 95 74 Z' fill='%23202028'/> <path d='M 115 70 C 120 71, 125 71, 128 70 C 125 69, 120 69, 115 70 Z' fill='%23202028'/> </svg>",
  'whaleshark': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <ellipse cx='58' cy='64' rx='52' ry='30' fill='%237A8B99'/> <ellipse cx='55' cy='72' rx='42' ry='16' fill='%23B0BEC5'/> <circle cx='35' cy='50' r='3' fill='white' opacity='0.7'/> <circle cx='50' cy='45' r='2.5' fill='white' opacity='0.7'/> <circle cx='65' cy='48' r='3' fill='white' opacity='0.7'/> <circle cx='80' cy='52' r='2.5' fill='white' opacity='0.7'/> <circle cx='42' cy='58' r='2' fill='white' opacity='0.7'/> <circle cx='58' cy='55' r='2.5' fill='white' opacity='0.7'/> <circle cx='72' cy='60' r='2' fill='white' opacity='0.7'/> <circle cx='30' cy='65' r='2' fill='white' opacity='0.7'/> <circle cx='88' cy='62' r='2' fill='white' opacity='0.7'/> <path d='M105 55 L120 38 L118 64 L120 90 L105 73 Z' fill='%236B7B8A'/> <path d='M55 35 L62 22 L70 35 Z' fill='%236B7B8A'/> <path d='M35 78 L28 92 L45 88 Z' fill='%236B7B8A'/> <path d='M6 54 C6 50 12 46 20 48 L20 80 C12 82 6 78 6 74 Z' fill='%237A8B99'/> <path d='M6 64 L18 64' stroke='%23546E7A' stroke-width='2' fill='none'/> <circle cx='22' cy='54' r='8' fill='white'/> <circle cx='25' cy='56' r='5' fill='%231A1A2E'/> <circle cx='23' cy='53' r='2' fill='white'/> <circle cx='26' cy='55' r='1' fill='white'/> </svg>",
  'dragongod': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <defs> <radialGradient id='dgGlow' cx='50%' cy='50%' r='60%'> <stop offset='0%' stop-color='%23FFD700' stop-opacity='0.4'/> <stop offset='100%' stop-color='%23FFD700' stop-opacity='0'/> </radialGradient> <linearGradient id='dgBody' x1='0' y1='0' x2='1' y2='1'> <stop offset='0%' stop-color='%23FFD700'/> <stop offset='100%' stop-color='%23FF8C00'/> </linearGradient> </defs> <ellipse cx='60' cy='64' rx='58' ry='50' fill='url(%23dgGlow)'/> <path d='M15 64 C20 40 40 30 60 35 C80 40 90 50 100 55 C110 60 115 64 110 72 C105 80 90 82 70 78 C50 74 30 80 15 64Z' fill='url(%23dgBody)' stroke='%23DAA520' stroke-width='1.5'/> <ellipse cx='45' cy='50' rx='6' ry='4' fill='%23FFEC80' opacity='0.5'/> <ellipse cx='60' cy='48' rx='6' ry='4' fill='%23FFEC80' opacity='0.5'/> <ellipse cx='75' cy='52' rx='6' ry='4' fill='%23FFEC80' opacity='0.5'/> <ellipse cx='90' cy='58' rx='5' ry='3' fill='%23FFEC80' opacity='0.5'/> <path d='M25 42 L18 28 L28 36 Z' fill='%23DAA520'/> <path d='M32 38 L28 24 L36 32 Z' fill='%23DAA520'/> <path d='M40 35 C35 25 50 20 55 30' fill='%23FF6347' opacity='0.7'/> <path d='M50 33 C48 22 62 18 60 28' fill='%23FF4500' opacity='0.6'/> <path d='M105 60 L120 48 L118 64 L120 80 L105 72 Z' fill='%23FF8C00'/> <path d='M120 48 L125 42 L122 52 Z' fill='%23FF6347' opacity='0.7'/> <path d='M120 80 L125 86 L122 76 Z' fill='%23FF6347' opacity='0.7'/> <path d='M18 58 C8 52 2 48 0 44' stroke='%23DAA520' stroke-width='1.5' fill='none'/> <path d='M18 62 C10 60 4 62 0 58' stroke='%23DAA520' stroke-width='1.5' fill='none'/> <circle cx='26' cy='50' r='8' fill='white'/> <circle cx='29' cy='52' r='5' fill='%238B0000'/> <circle cx='27' cy='49' r='2' fill='white'/> <circle cx='30' cy='51' r='1' fill='%23FFD700'/> </svg>",
  'killifish': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <ellipse cx='58' cy='64' rx='35' ry='18' fill='%234CAF50'/> <ellipse cx='65' cy='60' rx='15' ry='10' fill='%23E53935' opacity='0.6'/> <ellipse cx='48' cy='68' rx='10' ry='7' fill='%23FF7043' opacity='0.5'/> <circle cx='40' cy='58' r='2.5' fill='%23FFD600' opacity='0.7'/> <circle cx='55' cy='55' r='2' fill='%23FFD600' opacity='0.7'/> <circle cx='70' cy='58' r='2.5' fill='%23FFD600' opacity='0.7'/> <circle cx='50' cy='70' r='2' fill='%23FFD600' opacity='0.7'/> <path d='M55 47 L60 38 L68 46 Z' fill='%2366BB6A' opacity='0.8'/> <path d='M90 58 L108 48 L105 64 L108 80 L90 70 Z' fill='%23E53935' opacity='0.8'/> <path d='M42 72 L38 82 L48 78 Z' fill='%2366BB6A' opacity='0.7'/> <path d='M62 80 L65 88 L70 80 Z' fill='%2366BB6A' opacity='0.7'/> <circle cx='35' cy='60' r='8' fill='white'/> <circle cx='38' cy='62' r='5' fill='black'/> <circle cx='36' cy='59' r='2' fill='white'/> <circle cx='39' cy='61' r='1' fill='white'/> <path d='M23 65 C26 67 26 67 24 69' stroke='%232E7D32' stroke-width='1' fill='none'/> </svg>",
  'loach': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <path d='M15 62 C15 52 30 45 55 45 C80 45 100 50 110 58 C115 62 115 70 110 74 C100 80 80 82 55 82 C30 82 15 75 15 62Z' fill='%238D6E63'/> <path d='M20 68 C20 65 35 62 55 62 C80 62 100 64 108 68 C108 74 95 78 55 78 C30 78 20 74 20 68Z' fill='%23D7CCC8'/> <ellipse cx='45' cy='60' rx='8' ry='6' fill='%235D4037' opacity='0.4'/> <ellipse cx='70' cy='58' rx='8' ry='6' fill='%235D4037' opacity='0.4'/> <ellipse cx='92' cy='62' rx='6' ry='5' fill='%235D4037' opacity='0.4'/> <path d='M55 46 L60 36 L68 46 Z' fill='%23A1887F'/> <path d='M108 60 L120 52 L118 66 L120 80 L108 72 Z' fill='%23A1887F'/> <path d='M35 74 L30 84 L42 80 Z' fill='%23A1887F' opacity='0.7'/> <path d='M15 60 C8 55 4 50 0 48' stroke='%236D4C41' stroke-width='1.5' fill='none'/> <path d='M15 64 C8 62 4 64 0 62' stroke='%236D4C41' stroke-width='1.5' fill='none'/> <path d='M15 68 C8 72 4 76 0 78' stroke='%236D4C41' stroke-width='1.5' fill='none'/> <circle cx='25' cy='58' r='7' fill='white'/> <circle cx='28' cy='59' r='4' fill='black'/> <circle cx='26' cy='56' r='2' fill='white'/> <path d='M16 66 C18 68 18 68 16 70' stroke='%235D4037' stroke-width='1' fill='none'/> </svg>",
  'goldfish': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <defs> <radialGradient id='gfBody' cx='40%' cy='40%' r='60%'> <stop offset='0%' stop-color='%23FF6F00'/> <stop offset='100%' stop-color='%23E65100'/> </radialGradient> </defs> <ellipse cx='52' cy='62' rx='32' ry='28' fill='url(%23gfBody)'/> <ellipse cx='48' cy='70' rx='20' ry='12' fill='%23FF8F00' opacity='0.5'/> <path d='M82 52 C95 38 110 32 115 40 C118 48 105 55 90 58' fill='%23FF6F00' opacity='0.85'/> <path d='M82 72 C95 88 110 94 115 86 C118 78 105 72 90 68' fill='%23FF6F00' opacity='0.85'/> <path d='M85 58 C92 56 98 58 95 64 C98 70 92 72 85 68' fill='%23E65100' opacity='0.6'/> <path d='M42 36 C45 24 55 20 60 28 C65 22 68 26 65 36' fill='%23FF8F00' opacity='0.8'/> <path d='M38 78 L30 92 L46 86 Z' fill='%23FF8F00' opacity='0.7'/> <path d='M60 86 L58 96 L66 88 Z' fill='%23FF8F00' opacity='0.7'/> <circle cx='36' cy='55' r='9' fill='white'/> <circle cx='39' cy='57' r='5' fill='black'/> <circle cx='37' cy='53' r='2.5' fill='white'/> <circle cx='40' cy='56' r='1' fill='white'/> <path d='M22 64 C24 66 24 68 22 70' stroke='%23BF360C' stroke-width='1.5' fill='none'/> </svg>",
  'koi': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <ellipse cx='55' cy='64' rx='40' ry='25' fill='%23FFF8E1'/> <ellipse cx='38' cy='55' rx='14' ry='12' fill='%23D32F2F' opacity='0.85'/> <ellipse cx='68' cy='60' rx='16' ry='11' fill='%23D32F2F' opacity='0.85'/> <ellipse cx='52' cy='72' rx='10' ry='8' fill='%23D32F2F' opacity='0.7'/> <path d='M92 55 C100 42 115 38 118 48 C120 55 112 60 100 62' fill='%23FFF8E1'/> <path d='M92 73 C100 86 115 90 118 80 C120 73 112 68 100 66' fill='%23FFF8E1'/> <path d='M100 55 C104 50 108 48 106 58' fill='%23D32F2F' opacity='0.6'/> <path d='M100 73 C104 78 108 80 106 70' fill='%23D32F2F' opacity='0.6'/> <path d='M50 40 L55 28 L64 40 Z' fill='%23FFCDD2'/> <path d='M35 78 L28 90 L42 86 Z' fill='%23FFCDD2' opacity='0.8'/> <path d='M16 60 C10 56 6 54 2 52' stroke='%23BCAAA4' stroke-width='1' fill='none'/> <path d='M16 68 C10 72 6 74 2 76' stroke='%23BCAAA4' stroke-width='1' fill='none'/> <circle cx='28' cy='56' r='8' fill='white'/> <circle cx='31' cy='58' r='5' fill='black'/> <circle cx='29' cy='55' r='2' fill='white'/> <circle cx='32' cy='57' r='1' fill='white'/> <path d='M16 64 C18 66 18 66 16 68' stroke='%23795548' stroke-width='1' fill='none'/> </svg>",
  'axolotl': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <path d='M25 60 C15 75, 20 95, 45 95 C70 95, 95 85, 95 65 C95 45, 80 30, 60 30 C40 30, 30 45, 25 60Z' fill='%23FFC0CB'/> <path d='M95 65 C105 75, 115 70, 110 55 C105 40, 95 50, 95 65Z' fill='%23FFC0CB'/> <ellipse cx='28' cy='40' rx='3' ry='8' transform='rotate(-20 28 40)' fill='%23FF69B4'/> <ellipse cx='32' cy='35' rx='3' ry='8' transform='rotate(0 32 35)' fill='%23FF69B4'/> <ellipse cx='36' cy='30' rx='3' ry='8' transform='rotate(20 36 30)' fill='%23FF69B4'/> <ellipse cx='28' cy='50' rx='3' ry='8' transform='rotate(-20 28 50)' fill='%23FF69B4'/> <ellipse cx='32' cy='45' rx='3' ry='8' transform='rotate(0 32 45)' fill='%23FF69B4'/> <ellipse cx='36' cy='40' rx='3' ry='8' transform='rotate(20 36 40)' fill='%23FF69B4'/> <circle cx='58' cy='45' r='8' fill='%23000'/> <circle cx='55' cy='42' r='3' fill='%23FFF'/> <path d='M60 60 Q65 65, 70 60' stroke='%23000' stroke-width='2' fill='none'/> </svg>",
  'arapaima': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <path d='M10 58 C10 42 30 34 60 34 C85 34 105 42 112 55 C115 62 115 70 112 77 C105 90 85 94 60 94 C30 94 10 82 10 58Z' fill='%232E7D32'/> <path d='M15 70 C15 65 35 60 60 60 C85 60 105 64 110 70 C108 82 88 88 60 88 C35 88 15 82 15 70Z' fill='%234CAF50'/> <ellipse cx='50' cy='55' rx='7' ry='4' fill='%23C62828' opacity='0.5'/> <ellipse cx='65' cy='52' rx='7' ry='4' fill='%23C62828' opacity='0.5'/> <ellipse cx='80' cy='56' rx='7' ry='4' fill='%23C62828' opacity='0.5'/> <ellipse cx='55' cy='70' rx='7' ry='4' fill='%23C62828' opacity='0.4'/> <ellipse cx='72' cy='68' rx='7' ry='4' fill='%23C62828' opacity='0.4'/> <ellipse cx='88' cy='64' rx='6' ry='3' fill='%23C62828' opacity='0.4'/> <path d='M75 35 L80 24 L88 34 Z' fill='%231B5E20'/> <path d='M110 58 L124 48 L122 66 L124 84 L110 74 Z' fill='%231B5E20'/> <path d='M30 80 L24 94 L38 88 Z' fill='%23388E3C' opacity='0.7'/> <circle cx='22' cy='52' r='9' fill='white'/> <circle cx='25' cy='54' r='5' fill='black'/> <circle cx='23' cy='51' r='2.5' fill='white'/> <circle cx='26' cy='53' r='1' fill='white'/> <path d='M10 60 C14 62 14 62 10 65' stroke='%231B5E20' stroke-width='1.5' fill='none'/> </svg>",
  'surgeonfish': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <ellipse cx='55' cy='64' rx='38' ry='26' fill='%231565C0'/> <path d='M40 50 C50 42 65 42 80 50 C85 55 88 60 88 64 C88 68 85 74 80 78 C65 86 50 86 40 78 L55 64 Z' fill='%230D47A1' opacity='0.5'/> <path d='M90 54 L110 42 L108 64 L110 86 L90 74 Z' fill='%23FFD600'/> <path d='M40 40 C45 30 55 28 60 38' fill='%231976D2'/> <path d='M45 88 C50 96 58 98 62 90' fill='%231976D2'/> <path d='M38 72 L32 82 L44 78 Z' fill='%231976D2' opacity='0.7'/> <path d='M86 56 L92 56 L92 72 L86 72 Z' fill='%230D47A1'/> <circle cx='34' cy='58' r='9' fill='white'/> <circle cx='37' cy='60' r='5' fill='black'/> <circle cx='35' cy='57' r='2.5' fill='white'/> <circle cx='38' cy='59' r='1' fill='white'/> <path d='M18 66 C20 68 20 68 18 70' stroke='%230D47A1' stroke-width='1' fill='none'/> </svg>",
  'lionfish': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <line x1='35' y1='48' x2='25' y2='8' stroke='%23C62828' stroke-width='1.5'/> <line x1='45' y1='46' x2='38' y2='6' stroke='%23C62828' stroke-width='1.5'/> <line x1='55' y1='44' x2='52' y2='4' stroke='%23C62828' stroke-width='1.5'/> <line x1='65' y1='46' x2='65' y2='6' stroke='%23C62828' stroke-width='1.5'/> <line x1='75' y1='48' x2='78' y2='10' stroke='%23C62828' stroke-width='1.5'/> <path d='M25 8 L38 6 L35 48 L25 48 Z' fill='%23EF9A9A' opacity='0.3'/> <path d='M38 6 L52 4 L55 44 L35 48 Z' fill='%23EF9A9A' opacity='0.3'/> <path d='M52 4 L65 6 L65 46 L55 44 Z' fill='%23EF9A9A' opacity='0.3'/> <path d='M65 6 L78 10 L75 48 L65 46 Z' fill='%23EF9A9A' opacity='0.3'/> <ellipse cx='55' cy='65' rx='32' ry='22' fill='%23FFEBEE'/> <path d='M28 55 L30 78' stroke='%23C62828' stroke-width='3' stroke-linecap='round'/> <path d='M38 50 L40 82' stroke='%23C62828' stroke-width='3' stroke-linecap='round'/> <path d='M50 48 L52 84' stroke='%23C62828' stroke-width='3' stroke-linecap='round'/> <path d='M62 48 L64 84' stroke='%23C62828' stroke-width='3' stroke-linecap='round'/> <path d='M74 50 L76 82' stroke='%23C62828' stroke-width='3' stroke-linecap='round'/> <path d='M35 72 C28 80 20 95 15 105 C25 100 32 90 38 80' fill='%23EF9A9A' opacity='0.6'/> <line x1='35' y1='72' x2='15' y2='105' stroke='%23C62828' stroke-width='0.8'/> <line x1='35' y1='72' x2='20' y2='98' stroke='%23C62828' stroke-width='0.8'/> <line x1='35' y1='72' x2='26' y2='92' stroke='%23C62828' stroke-width='0.8'/> <path d='M84 58 L100 50 L98 65 L100 80 L84 72 Z' fill='%23FFCDD2'/> <line x1='84' y1='58' x2='100' y2='50' stroke='%23C62828' stroke-width='0.8'/> <line x1='84' y1='65' x2='98' y2='65' stroke='%23C62828' stroke-width='0.8'/> <line x1='84' y1='72' x2='100' y2='80' stroke='%23C62828' stroke-width='0.8'/> <circle cx='36' cy='60' r='8' fill='white'/> <circle cx='39' cy='62' r='5' fill='black'/> <circle cx='37' cy='59' r='2' fill='white'/> <circle cx='40' cy='61' r='1' fill='white'/> </svg>",
  'moorishidol': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <path d='M58 38 C55 20 60 8 68 4 C70 3 72 5 70 8 C65 18 62 30 60 38' fill='none' stroke='white' stroke-width='2'/> <path d='M55 30 C65 25 80 30 85 50 C90 70 80 95 65 100 C50 95 35 70 38 50 C40 35 48 30 55 30Z' fill='%23FFD600'/> <path d='M48 35 C50 30 55 30 57 35 L54 95 C52 100 48 100 46 95 Z' fill='%231A1A1A'/> <path d='M68 35 C72 30 78 32 80 40 L78 90 C76 96 70 98 68 92 Z' fill='%231A1A1A'/> <path d='M57 35 L54 95 C58 98 64 98 68 92 L68 35 C64 30 60 30 57 35Z' fill='white'/> <path d='M42 55 C35 52 28 54 25 58 C28 62 35 64 42 62 Z' fill='%23FFD600'/> <path d='M82 75 L95 70 L92 82 L95 92 L82 88 Z' fill='%231A1A1A'/> <path d='M58 98 L55 112 L65 108 L68 98 Z' fill='%231A1A1A'/> <circle cx='44' cy='55' r='7' fill='white'/> <circle cx='46' cy='56' r='4' fill='black'/> <circle cx='44' cy='54' r='2' fill='white'/> <path d='M25 58 C27 59 27 59 25 60' stroke='%23333' stroke-width='1' fill='none'/> </svg>",
  'triggerfish': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <ellipse cx='55' cy='64' rx='38' ry='28' fill='%231A237E'/> <path d='M30 50 C40 42 50 44 50 55 C50 68 38 70 30 65 Z' fill='%2300BCD4'/> <path d='M50 55 C60 48 75 48 80 58 C80 72 68 78 55 74 C48 70 48 62 50 55Z' fill='%23FDD835'/> <path d='M60 50 C65 48 72 52 70 58' stroke='%231A237E' stroke-width='1.5' fill='none'/> <path d='M58 60 C63 58 72 60 70 68' stroke='%231A237E' stroke-width='1.5' fill='none'/> <path d='M45 38 L48 24 L52 38 Z' fill='%231A237E'/> <path d='M60 38 C65 30 72 30 75 38' fill='%231565C0'/> <path d='M60 90 C65 98 72 98 75 90' fill='%231565C0'/> <path d='M90 55 L108 48 L106 64 L108 80 L90 73 Z' fill='%23FDD835'/> <path d='M38 72 L34 82 L44 78 Z' fill='%2300BCD4' opacity='0.7'/> <circle cx='32' cy='56' r='8' fill='white'/> <circle cx='35' cy='58' r='5' fill='black'/> <circle cx='33' cy='55' r='2' fill='white'/> <circle cx='36' cy='57' r='1' fill='white'/> <path d='M18 64 C20 66 20 66 18 68' stroke='%230D47A1' stroke-width='1.5' fill='none'/> </svg>",
  'napoleonfish': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <ellipse cx='58' cy='66' rx='42' ry='28' fill='%2300796B'/> <path d='M22 50 C18 38 22 28 32 26 C40 24 42 32 40 42 C38 48 30 52 22 50Z' fill='%2300897B'/> <ellipse cx='45' cy='58' rx='6' ry='4' fill='%2326A69A' opacity='0.4'/> <ellipse cx='58' cy='55' rx='6' ry='4' fill='%2326A69A' opacity='0.4'/> <ellipse cx='72' cy='58' rx='6' ry='4' fill='%2326A69A' opacity='0.4'/> <ellipse cx='52' cy='70' rx='6' ry='4' fill='%2326A69A' opacity='0.4'/> <ellipse cx='65' cy='68' rx='6' ry='4' fill='%2326A69A' opacity='0.4'/> <ellipse cx='80' cy='64' rx='5' ry='3' fill='%2326A69A' opacity='0.4'/> <ellipse cx='55' cy='78' rx='30' ry='12' fill='%234DB6AC' opacity='0.5'/> <path d='M40 40 C50 30 65 28 75 38' fill='%2300695C' opacity='0.8'/> <path d='M96 58 L114 48 L112 66 L114 84 L96 74 Z' fill='%2300695C'/> <path d='M38 80 L30 94 L46 88 Z' fill='%2300897B' opacity='0.7'/> <path d='M18 62 C16 60 14 62 14 66 C14 70 16 72 18 70 Z' fill='%23E8967A'/> <circle cx='30' cy='50' r='8' fill='white'/> <circle cx='33' cy='52' r='5' fill='black'/> <circle cx='31' cy='49' r='2' fill='white'/> <circle cx='34' cy='51' r='1' fill='white'/> <path d='M24 46 L22 42' stroke='%23004D40' stroke-width='1.5' fill='none'/> <path d='M24 56 L22 60' stroke='%23004D40' stroke-width='1.5' fill='none'/> </svg>",
  'seaturtle': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <ellipse cx='75' cy='82' rx='18' ry='8' transform='rotate(30 75 82)' fill='%232E7D32'/> <ellipse cx='75' cy='46' rx='18' ry='8' transform='rotate(-30 75 46)' fill='%232E7D32'/> <ellipse cx='60' cy='64' rx='35' ry='26' fill='%2333691E'/> <ellipse cx='50' cy='55' rx='10' ry='8' fill='%23558B2F' stroke='%2333691E' stroke-width='1'/> <ellipse cx='70' cy='55' rx='10' ry='8' fill='%23558B2F' stroke='%2333691E' stroke-width='1'/> <ellipse cx='60' cy='68' rx='10' ry='8' fill='%23558B2F' stroke='%2333691E' stroke-width='1'/> <ellipse cx='42' cy='68' rx='8' ry='6' fill='%23558B2F' stroke='%2333691E' stroke-width='1'/> <ellipse cx='78' cy='68' rx='8' ry='6' fill='%23558B2F' stroke='%2333691E' stroke-width='1'/> <ellipse cx='32' cy='78' rx='16' ry='7' transform='rotate(20 32 78)' fill='%23388E3C'/> <ellipse cx='32' cy='50' rx='16' ry='7' transform='rotate(-20 32 50)' fill='%23388E3C'/> <ellipse cx='26' cy='64' rx='14' ry='12' fill='%234CAF50'/> <ellipse cx='22' cy='60' rx='8' ry='6' fill='%23388E3C'/> <circle cx='18' cy='60' r='6' fill='white'/> <circle cx='16' cy='61' r='4' fill='black'/> <circle cx='15' cy='59' r='1.5' fill='white'/> <path d='M14 68 C16 70 20 70 22 68' stroke='%231B5E20' stroke-width='1.5' fill='none'/> <path d='M94 64 L104 62 L100 66 Z' fill='%232E7D32'/> </svg>",
  'anglerfish': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <defs> <radialGradient id='afLure' cx='50%' cy='50%' r='50%'> <stop offset='0%' stop-color='%2300E5FF' stop-opacity='1'/> <stop offset='100%' stop-color='%2300E5FF' stop-opacity='0'/> </radialGradient> </defs> <path d='M38 42 C35 30 30 22 28 18' stroke='%232D2D3D' stroke-width='2' fill='none'/> <circle cx='28' cy='16' r='10' fill='url(%23afLure)'/> <circle cx='28' cy='16' r='4' fill='%2300E5FF'/> <ellipse cx='55' cy='68' rx='38' ry='30' fill='%231A1A2E'/> <ellipse cx='52' cy='76' rx='28' ry='16' fill='%232D2D44'/> <path d='M18 62 L18 82 C22 86 30 86 35 82 L35 62 Z' fill='%230D0D1A'/> <path d='M18 62 L21 68 L24 62 L27 68 L30 62 L33 68 L35 62' fill='white'/> <path d='M18 82 L21 76 L24 82 L27 76 L30 82 L33 76 L35 82' fill='white'/> <path d='M90 60 L102 52 L100 68 L102 82 L90 76 Z' fill='%231A1A2E'/> <path d='M55 40 L60 32 L68 40 Z' fill='%232D2D44'/> <path d='M50 96 L55 104 L60 96 Z' fill='%232D2D44'/> <circle cx='40' cy='58' r='10' fill='white'/> <circle cx='43' cy='60' r='6' fill='%231A1A2E'/> <circle cx='44' cy='59' r='2' fill='%2300E5FF'/> <circle cx='41' cy='56' r='2.5' fill='white'/> </svg>",
  'viperfish': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <path d='M20 55 C20 42 40 35 65 38 C85 40 105 48 110 58 C112 64 112 72 110 78 C105 88 85 90 65 88 C40 86 20 75 20 55Z' fill='%231A1A2E'/> <circle cx='40' cy='55' r='2' fill='%2300E5FF' opacity='0.8'/> <circle cx='55' cy='50' r='1.5' fill='%2300E5FF' opacity='0.8'/> <circle cx='70' cy='52' r='2' fill='%2300E5FF' opacity='0.8'/> <circle cx='85' cy='56' r='1.5' fill='%2300E5FF' opacity='0.8'/> <circle cx='48' cy='75' r='1.5' fill='%2300E5FF' opacity='0.6'/> <circle cx='65' cy='78' r='2' fill='%2300E5FF' opacity='0.6'/> <circle cx='82' cy='74' r='1.5' fill='%2300E5FF' opacity='0.6'/> <circle cx='95' cy='64' r='1.5' fill='%2300E5FF' opacity='0.7'/> <path d='M20 52 L12 48 L12 78 L20 74 Z' fill='%230D0D1A'/> <path d='M15 52 C16 42 18 36 20 34' stroke='white' stroke-width='2' fill='none' stroke-linecap='round'/> <path d='M18 52 C20 44 22 40 24 38' stroke='white' stroke-width='1.5' fill='none' stroke-linecap='round'/> <path d='M15 74 C16 84 18 90 20 92' stroke='white' stroke-width='2' fill='none' stroke-linecap='round'/> <path d='M18 74 C20 82 22 86 24 88' stroke='white' stroke-width='1.5' fill='none' stroke-linecap='round'/> <path d='M50 38 L48 26 L55 36 Z' fill='%232D2D44'/> <circle cx='48' cy='26' r='3' fill='%2300E5FF' opacity='0.8'/> <path d='M108 58 L120 50 L118 66 L120 82 L108 74 Z' fill='%231A1A2E'/> <circle cx='30' cy='56' r='8' fill='white'/> <circle cx='33' cy='58' r='5' fill='%231A1A2E'/> <circle cx='34' cy='57' r='2' fill='%2300E5FF'/> <circle cx='31' cy='55' r='2' fill='white'/> </svg>",
  'giantisopod': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <ellipse cx='64' cy='64' rx='45' ry='28' fill='%2378909C'/> <path d='M25 64 L103 64' stroke='%23546E7A' stroke-width='1' opacity='0.6'/> <ellipse cx='64' cy='64' rx='45' ry='28' fill='none' stroke='%23546E7A' stroke-width='1.5'/> <path d='M30 52 C50 48 80 48 98 52' stroke='%23546E7A' stroke-width='1.5' fill='none'/> <path d='M28 58 C48 54 82 54 100 58' stroke='%23546E7A' stroke-width='1.5' fill='none'/> <path d='M28 70 C48 74 82 74 100 70' stroke='%23546E7A' stroke-width='1.5' fill='none'/> <path d='M30 76 C50 80 80 80 98 76' stroke='%23546E7A' stroke-width='1.5' fill='none'/> <path d='M20 52 C14 54 12 60 12 64 C12 68 14 74 20 76 L28 76 L28 52 Z' fill='%23607D8B'/> <line x1='35' y1='88' x2='32' y2='98' stroke='%23546E7A' stroke-width='2'/> <line x1='48' y1='90' x2='46' y2='100' stroke='%23546E7A' stroke-width='2'/> <line x1='62' y1='91' x2='62' y2='102' stroke='%23546E7A' stroke-width='2'/> <line x1='76' y1='90' x2='78' y2='100' stroke='%23546E7A' stroke-width='2'/> <line x1='88' y1='88' x2='92' y2='98' stroke='%23546E7A' stroke-width='2'/> <path d='M16 56 C10 50 6 44 2 40' stroke='%23607D8B' stroke-width='1.5' fill='none'/> <path d='M16 60 C10 56 4 54 0 50' stroke='%23607D8B' stroke-width='1.5' fill='none'/> <path d='M104 56 L116 52 L118 64 L116 76 L104 72 Z' fill='%23607D8B'/> <circle cx='20' cy='58' r='7' fill='white'/> <circle cx='22' cy='59' r='4' fill='black'/> <circle cx='20' cy='57' r='2' fill='white'/> <circle cx='23' cy='58' r='1' fill='white'/> </svg>",
  'gulpereel': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <path d='M10 40 C10 35 18 30 30 30 L50 35 L50 55 L30 50 C18 48 10 45 10 40Z' fill='%231A1A2E'/> <path d='M10 80 C10 85 18 92 30 92 L50 85 L50 65 L30 70 C18 72 10 75 10 80Z' fill='%232D2D44'/> <path d='M12 45 L48 40 L48 80 L12 75 Z' fill='%230A0A15'/> <path d='M50 42 C60 38 80 40 95 48 C105 54 115 60 120 62 C115 66 105 70 95 72 C80 76 60 78 50 78 Z' fill='%231A1A2E'/> <path d='M50 55 C65 52 85 54 100 58 C105 60 110 62 120 62 C110 64 105 66 100 68 C85 72 65 74 50 65 Z' fill='%232D2D44' opacity='0.5'/> <circle cx='122' cy='62' r='4' fill='%23FF1744' opacity='0.8'/> <circle cx='122' cy='62' r='7' fill='%23FF1744' opacity='0.2'/> <circle cx='46' cy='42' r='6' fill='white'/> <circle cx='48' cy='43' r='4' fill='black'/> <circle cx='46' cy='41' r='1.5' fill='white'/> <circle cx='49' cy='42' r='0.8' fill='white'/> </svg>",
  'vampiresquid': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <defs> <radialGradient id='vsBody' cx='40%' cy='40%' r='60%'> <stop offset='0%' stop-color='%23FF8A65'/> <stop offset='100%' stop-color='%23E64A19'/> </radialGradient> </defs> <ellipse cx='64' cy='50' rx='36' ry='28' fill='url(%23vsBody)'/> <ellipse cx='35' cy='35' rx='12' ry='8' transform='rotate(-30 35 35)' fill='%23FF7043'/> <ellipse cx='93' cy='35' rx='12' ry='8' transform='rotate(30 93 35)' fill='%23FF7043'/> <path d='M35 72 C30 85 28 98 32 105 C36 108 38 100 40 90 L44 75 Z' fill='%23E64A19'/> <path d='M44 75 C42 88 42 100 46 106 C50 108 50 98 50 88 L52 76 Z' fill='%23EF6C00'/> <path d='M52 76 C52 90 54 102 58 106 C62 108 62 98 62 88 L62 78 Z' fill='%23E64A19'/> <path d='M62 78 C64 92 66 102 70 106 C74 108 74 98 72 88 L70 76 Z' fill='%23EF6C00'/> <path d='M70 76 C72 88 74 100 78 106 C82 108 82 98 80 88 L78 75 Z' fill='%23E64A19'/> <path d='M78 75 C82 86 86 96 88 102 C92 104 90 96 88 86 L84 74 Z' fill='%23EF6C00'/> <path d='M84 74 C90 84 94 92 96 98 C98 100 98 92 96 84 L90 72 Z' fill='%23E64A19'/> <path d='M35 72 L44 75 L52 76 L62 78 L70 76 L78 75 L84 74 L90 72 C88 80 82 84 64 86 C46 84 38 80 35 72Z' fill='%23FF7043' opacity='0.5'/> <circle cx='50' cy='48' r='10' fill='white'/> <circle cx='53' cy='50' r='6' fill='black'/> <circle cx='50' cy='46' r='3' fill='white'/> <circle cx='54' cy='49' r='1.5' fill='white'/> <circle cx='78' cy='48' r='10' fill='white'/> <circle cx='81' cy='50' r='6' fill='black'/> <circle cx='78' cy='46' r='3' fill='white'/> <circle cx='82' cy='49' r='1.5' fill='white'/> <path d='M60 60 C62 62 66 62 68 60' stroke='%23BF360C' stroke-width='1.5' fill='none'/> </svg>",
  'barreleye': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <defs> <radialGradient id='beDome' cx='50%' cy='40%' r='60%'> <stop offset='0%' stop-color='%23B3E5FC' stop-opacity='0.3'/> <stop offset='100%' stop-color='%2381D4FA' stop-opacity='0.15'/> </radialGradient> </defs> <ellipse cx='60' cy='72' rx='35' ry='20' fill='%23455A64'/> <path d='M28 60 C28 32 50 22 68 22 C82 22 92 32 92 52 C92 62 82 68 68 68 C50 68 28 68 28 60Z' fill='url(%23beDome)' stroke='%23B3E5FC' stroke-width='1' stroke-opacity='0.5'/> <ellipse cx='62' cy='48' rx='10' ry='6' fill='%23EF9A9A' opacity='0.3'/> <ellipse cx='48' cy='45' rx='6' ry='8' fill='%2300C853'/> <circle cx='48' cy='40' r='4' fill='%2369F0AE'/> <circle cx='48' cy='39' r='2' fill='white'/> <ellipse cx='68' cy='45' rx='6' ry='8' fill='%2300C853'/> <circle cx='68' cy='40' r='4' fill='%2369F0AE'/> <circle cx='68' cy='39' r='2' fill='white'/> <circle cx='32' cy='65' r='3' fill='black'/> <circle cx='32' cy='65' r='1.5' fill='%23263238'/> <path d='M28 68 C30 70 34 70 36 68' stroke='%2337474F' stroke-width='1' fill='none'/> <path d='M92 66 L108 58 L106 72 L108 86 L92 78 Z' fill='%2337474F'/> <path d='M50 88 L48 98 L56 92 Z' fill='%23546E7A' opacity='0.7'/> <path d='M55 54 L58 46 L62 54 Z' fill='%23546E7A' opacity='0.5'/> </svg>",
  'piranha': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <ellipse cx='58' cy='64' rx='35' ry='28' fill='%2390A4AE'/> <path d='M30 68 C35 80 50 90 65 90 C78 90 88 82 90 72 C80 80 60 84 40 78 C34 76 30 72 30 68Z' fill='%23E53935'/> <ellipse cx='52' cy='55' rx='20' ry='12' fill='%23CFD8DC' opacity='0.5'/> <path d='M50 38 L55 26 L64 36 Z' fill='%2378909C'/> <path d='M55 90 L60 100 L68 90 Z' fill='%23C62828'/> <path d='M90 56 L108 46 L106 64 L108 82 L90 72 Z' fill='%2378909C'/> <path d='M40 74 L34 84 L46 80 Z' fill='%2390A4AE' opacity='0.7'/> <path d='M24 60 L24 72' stroke='%23455A64' stroke-width='1.5'/> <path d='M24 60 L26 63 L28 60 L30 63 L32 60' fill='white'/> <path d='M24 72 L26 69 L28 72 L30 69 L32 72' fill='white'/> <circle cx='36' cy='56' r='9' fill='white'/> <circle cx='39' cy='58' r='5' fill='%23D32F2F'/> <circle cx='39' cy='58' r='3' fill='black'/> <circle cx='37' cy='55' r='2' fill='white'/> <circle cx='40' cy='57' r='1' fill='white'/> <path d='M28 48 L42 52' stroke='%23455A64' stroke-width='2' stroke-linecap='round'/> </svg>",
  'oscar': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <ellipse cx='58' cy='64' rx='38' ry='28' fill='%23263238'/> <ellipse cx='42' cy='55' rx='8' ry='6' fill='%23FF6D00' opacity='0.7'/> <ellipse cx='60' cy='50' rx='10' ry='7' fill='%23FF3D00' opacity='0.6'/> <ellipse cx='78' cy='56' rx='8' ry='6' fill='%23FF6D00' opacity='0.7'/> <ellipse cx='50' cy='70' rx='9' ry='6' fill='%23FF3D00' opacity='0.6'/> <ellipse cx='68' cy='72' rx='8' ry='5' fill='%23FF6D00' opacity='0.7'/> <ellipse cx='84' cy='65' rx='6' ry='5' fill='%23FF3D00' opacity='0.5'/> <circle cx='88' cy='62' r='6' fill='%231A1A1A'/> <circle cx='88' cy='62' r='4' fill='%23FF6D00'/> <circle cx='88' cy='62' r='2' fill='black'/> <path d='M35 38 C42 28 58 26 72 30 C78 32 82 36 82 38' fill='%2337474F'/> <path d='M45 90 C52 98 62 100 72 96 C76 94 78 90 78 88' fill='%2337474F'/> <path d='M92 56 L110 50 L108 64 L110 78 L92 72 Z' fill='%2337474F'/> <path d='M38 76 L32 86 L44 82 Z' fill='%2337474F' opacity='0.7'/> <circle cx='34' cy='56' r='9' fill='white'/> <circle cx='37' cy='58' r='5' fill='black'/> <circle cx='35' cy='55' r='2.5' fill='white'/> <circle cx='38' cy='57' r='1' fill='white'/> <path d='M22 66 C24 68 24 68 22 70' stroke='%231A1A1A' stroke-width='1.5' fill='none'/> </svg>",
  'stingray': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <ellipse cx='55' cy='64' rx='42' ry='32' fill='%23607D8B'/> <ellipse cx='55' cy='68' rx='35' ry='22' fill='%2390A4AE' opacity='0.4'/> <circle cx='38' cy='52' r='3' fill='%23455A64' opacity='0.5'/> <circle cx='55' cy='48' r='3.5' fill='%23455A64' opacity='0.5'/> <circle cx='72' cy='52' r='3' fill='%23455A64' opacity='0.5'/> <circle cx='45' cy='62' r='2.5' fill='%23455A64' opacity='0.5'/> <circle cx='65' cy='60' r='3' fill='%23455A64' opacity='0.5'/> <circle cx='40' cy='74' r='2.5' fill='%23455A64' opacity='0.5'/> <circle cx='58' cy='76' r='3' fill='%23455A64' opacity='0.5'/> <circle cx='74' cy='68' r='2.5' fill='%23455A64' opacity='0.5'/> <path d='M14 58 C10 55 8 60 10 66 C12 70 15 68 14 64' fill='%23546E7A'/> <path d='M96 58 C100 55 102 60 100 66 C98 70 95 68 96 64' fill='%23546E7A'/> <path d='M90 64 C100 64 110 66 120 72 C122 74 124 78 126 82' stroke='%23546E7A' stroke-width='3' fill='none' stroke-linecap='round'/> <path d='M120 72 L124 70 L126 74 Z' fill='%23455A64'/> <circle cx='42' cy='52' r='7' fill='white'/> <circle cx='44' cy='53' r='4' fill='black'/> <circle cx='42' cy='51' r='2' fill='white'/> <path d='M48 70 C52 72 58 72 62 70' stroke='%23455A64' stroke-width='1.5' fill='none'/> </svg>",
  'flowerhorn': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <defs> <linearGradient id='fhBody' x1='0' y1='0' x2='1' y2='1'> <stop offset='0%' stop-color='%23E53935'/> <stop offset='50%' stop-color='%23FF6F00'/> <stop offset='100%' stop-color='%231565C0'/> </linearGradient> </defs> <ellipse cx='60' cy='68' rx='38' ry='26' fill='url(%23fhBody)'/> <path d='M28 52 C24 38 28 24 38 20 C48 16 52 24 50 36 C48 44 42 50 34 52 Z' fill='%23FF5252'/> <circle cx='50' cy='60' r='3' fill='black' opacity='0.3'/> <circle cx='62' cy='58' r='3.5' fill='black' opacity='0.3'/> <circle cx='74' cy='62' r='3' fill='black' opacity='0.3'/> <circle cx='56' cy='72' r='3' fill='black' opacity='0.3'/> <circle cx='68' cy='74' r='2.5' fill='black' opacity='0.3'/> <circle cx='82' cy='68' r='2.5' fill='black' opacity='0.3'/> <path d='M30 68 C50 66 70 66 92 68' stroke='black' stroke-width='2' opacity='0.4'/> <path d='M42 44 C50 34 65 30 78 36 C82 38 85 42 85 44' fill='%231565C0' opacity='0.8'/> <path d='M50 92 C58 100 68 100 76 94' fill='%231565C0' opacity='0.8'/> <path d='M94 60 L112 52 L110 68 L112 84 L94 76 Z' fill='%231565C0'/> <path d='M38 80 L32 92 L46 86 Z' fill='%23E53935' opacity='0.7'/> <circle cx='34' cy='56' r='8' fill='white'/> <circle cx='37' cy='58' r='5' fill='%23D32F2F'/> <circle cx='37' cy='58' r='3' fill='black'/> <circle cx='35' cy='55' r='2' fill='white'/> <circle cx='38' cy='57' r='1' fill='white'/> <path d='M22 66 C20 64 18 66 18 70 C18 74 20 76 22 74 Z' fill='%23FFAB91'/> </svg>",
  'redtailcatfish': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <path d='M15 55 C15 40 35 32 60 32 C85 32 105 40 110 55 C112 62 112 72 110 78 C105 90 85 95 60 95 C35 95 15 82 15 55Z' fill='%2337474F'/> <path d='M18 68 C18 62 38 58 60 58 C85 58 108 62 108 68 C108 80 88 88 60 88 C38 88 18 80 18 68Z' fill='%23ECEFF1'/> <path d='M108 55 L124 42 L122 66 L124 90 L108 78 Z' fill='%23D32F2F'/> <path d='M55 34 L60 22 L68 32 Z' fill='%23263238'/> <path d='M85 38 C88 34 92 34 92 38' fill='%23263238'/> <path d='M30 82 L22 96 L38 90 Z' fill='%23455A64' opacity='0.7'/> <path d='M16 52 C6 44 0 36 -4 30' stroke='%23546E7A' stroke-width='2' fill='none'/> <path d='M16 58 C6 54 -2 52 -6 48' stroke='%23546E7A' stroke-width='2' fill='none'/> <path d='M16 64 C8 66 2 72 -2 78' stroke='%23546E7A' stroke-width='1.5' fill='none'/> <path d='M16 68 C8 72 2 80 -2 88' stroke='%23546E7A' stroke-width='1.5' fill='none'/> <path d='M15 50 C12 48 10 52 10 58 C10 64 12 68 15 66 Z' fill='%2337474F'/> <circle cx='24' cy='50' r='8' fill='white'/> <circle cx='27' cy='52' r='5' fill='black'/> <circle cx='25' cy='49' r='2' fill='white'/> <circle cx='28' cy='51' r='1' fill='white'/> <path d='M12 60 C14 62 14 62 12 64' stroke='%23263238' stroke-width='1.5' fill='none'/> </svg>",
  'electriceel': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <defs> <radialGradient id='eeGlow' cx='50%' cy='50%' r='50%'> <stop offset='0%' stop-color='%23FFFF00' stop-opacity='0.3'/> <stop offset='100%' stop-color='%23FFFF00' stop-opacity='0'/> </radialGradient> </defs> <ellipse cx='64' cy='64' rx='60' ry='35' fill='url(%23eeGlow)'/> <path d='M8 58 C8 48 18 42 30 42 C50 42 55 48 70 50 C85 52 95 50 110 52 C118 54 122 58 122 64 C122 70 118 74 110 76 C95 78 85 76 70 74 C55 72 50 78 30 78 C18 78 8 72 8 58Z' fill='%23556B2F'/> <path d='M10 64 C10 60 22 56 35 56 C55 56 60 60 75 62 C90 64 100 62 115 64 C120 66 120 70 115 72 C100 74 90 72 75 70 C60 68 55 72 35 72 C22 72 10 68 10 64Z' fill='%238B9862' opacity='0.6'/> <path d='M40 38 L44 30 L38 34 L42 26' stroke='%23FFFF00' stroke-width='1.5' fill='none' opacity='0.7'/> <path d='M70 40 L74 32 L68 36 L72 28' stroke='%23FFFF00' stroke-width='1.5' fill='none' opacity='0.7'/> <path d='M95 42 L99 34 L93 38 L97 30' stroke='%23FFFF00' stroke-width='1.5' fill='none' opacity='0.7'/> <path d='M55 82 L59 90 L53 86 L57 94' stroke='%23FFFF00' stroke-width='1.5' fill='none' opacity='0.6'/> <path d='M85 80 L89 88 L83 84 L87 92' stroke='%23FFFF00' stroke-width='1.5' fill='none' opacity='0.6'/> <circle cx='18' cy='56' r='7' fill='white'/> <circle cx='20' cy='57' r='4' fill='black'/> <circle cx='18' cy='55' r='2' fill='white'/> <circle cx='21' cy='56' r='1' fill='%23FFFF00'/> <path d='M8 62 C10 64 10 64 8 66' stroke='%233E4A1E' stroke-width='1' fill='none'/> </svg>",
  'phoenix': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <defs> <linearGradient id='phBody' x1='0' y1='0' x2='1' y2='1'> <stop offset='0%' stop-color='%23FFD600'/> <stop offset='50%' stop-color='%23FF6D00'/> <stop offset='100%' stop-color='%23D50000'/> </linearGradient> <radialGradient id='phGlow' cx='50%' cy='50%' r='60%'> <stop offset='0%' stop-color='%23FFD600' stop-opacity='0.3'/> <stop offset='100%' stop-color='%23FF6D00' stop-opacity='0'/> </radialGradient> </defs> <ellipse cx='58' cy='64' rx='55' ry='45' fill='url(%23phGlow)'/> <ellipse cx='55' cy='64' rx='35' ry='22' fill='url(%23phBody)'/> <path d='M35 44 C32 30 38 18 42 14 C44 22 48 16 50 10 C52 20 56 14 58 8 C58 18 62 22 60 34' fill='%23FF6D00' opacity='0.8'/> <path d='M38 40 C36 28 42 22 44 18 C46 26 50 22 52 18 C52 28 55 24 56 36' fill='%23FFD600' opacity='0.6'/> <path d='M88 52 C95 42 105 30 110 24 C108 38 115 32 118 26 C115 40 120 36 122 32 C118 48 112 56 105 60' fill='%23D50000' opacity='0.8'/> <path d='M88 76 C95 86 105 98 110 104 C108 90 115 96 118 102 C115 88 120 92 122 96 C118 80 112 72 105 68' fill='%23D50000' opacity='0.8'/> <path d='M92 56 C100 48 108 38 112 32 C110 44 106 52 100 58' fill='%23FF6D00' opacity='0.6'/> <path d='M92 72 C100 80 108 90 112 96 C110 84 106 76 100 70' fill='%23FF6D00' opacity='0.6'/> <path d='M38 78 C32 86 28 96 26 102 C30 94 34 90 38 84' fill='%23FF6D00' opacity='0.7'/> <circle cx='36' cy='58' r='8' fill='white'/> <circle cx='39' cy='60' r='5' fill='%23D50000'/> <circle cx='39' cy='60' r='3' fill='black'/> <circle cx='37' cy='57' r='2' fill='white'/> <circle cx='40' cy='59' r='1' fill='%23FFD600'/> </svg>",
  'leviathan': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <defs> <radialGradient id='lvEye' cx='50%' cy='50%' r='50%'> <stop offset='0%' stop-color='%23FF1744'/> <stop offset='100%' stop-color='%23FF1744' stop-opacity='0'/> </radialGradient> </defs> <path d='M10 55 C10 38 25 28 45 28 C65 28 70 38 75 48 C80 55 90 52 100 48 C110 44 118 48 122 56 C126 64 122 76 110 80 C100 84 90 78 80 72 C70 66 60 72 45 78 C30 84 10 78 10 55Z' fill='%231A237E'/> <path d='M14 62 C14 55 30 48 48 48 C60 48 68 52 74 58 C68 62 56 68 44 72 C30 76 14 72 14 62Z' fill='%23283593' opacity='0.6'/> <path d='M28 30 L32 20 L36 30' fill='%230D47A1'/> <path d='M42 28 L46 16 L50 28' fill='%230D47A1'/> <path d='M56 32 L60 22 L64 34' fill='%230D47A1'/> <path d='M98 46 L102 36 L106 48' fill='%230D47A1'/> <path d='M112 50 L116 40 L118 52' fill='%230D47A1'/> <path d='M118 56 C124 50 128 42 126 38 C122 42 120 50 118 56' fill='%231A237E'/> <path d='M118 72 C124 78 128 86 126 90 C122 86 120 78 118 72' fill='%231A237E'/> <ellipse cx='35' cy='48' rx='6' ry='4' fill='%23283593' opacity='0.4'/> <ellipse cx='50' cy='44' rx='6' ry='4' fill='%23283593' opacity='0.4'/> <circle cx='22' cy='50' r='12' fill='url(%23lvEye)'/> <circle cx='22' cy='50' r='8' fill='white'/> <circle cx='24' cy='52' r='5' fill='%23FF1744'/> <circle cx='24' cy='52' r='3' fill='black'/> <circle cx='22' cy='49' r='2' fill='white'/> <circle cx='25' cy='51' r='1' fill='%23FF8A80'/> <path d='M10 58 L6 56 L10 62 L4 60 L10 66' stroke='%230D47A1' stroke-width='1.5' fill='none'/> <path d='M8 56 L10 60 L12 56' fill='white'/> <path d='M6 60 L8 64 L10 60' fill='white'/> </svg>",
  'moonjellyfish': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <defs> <radialGradient id='mjGlow' cx='50%' cy='30%' r='60%'> <stop offset='0%' stop-color='%23E1F5FE' stop-opacity='0.9'/> <stop offset='100%' stop-color='%23B3E5FC' stop-opacity='0.3'/> </radialGradient> </defs> <path d='M24 58 C24 28 44 14 64 14 C84 14 104 28 104 58 L24 58Z' fill='url(%23mjGlow)' stroke='%23B3E5FC' stroke-width='1'/> <path d='M24 58 C30 62 36 56 42 60 C48 64 54 56 60 60 C66 64 72 56 78 60 C84 64 90 56 96 60 C100 62 104 58 104 58' fill='none' stroke='%2381D4FA' stroke-width='2'/> <circle cx='52' cy='38' r='8' fill='%23CE93D8' opacity='0.4'/> <circle cx='76' cy='38' r='8' fill='%23CE93D8' opacity='0.4'/> <circle cx='52' cy='50' r='8' fill='%23CE93D8' opacity='0.4'/> <circle cx='76' cy='50' r='8' fill='%23CE93D8' opacity='0.4'/> <path d='M32 60 C30 72 28 84 30 96 C32 102 34 108 32 114' stroke='%23B3E5FC' stroke-width='1.5' fill='none' opacity='0.6'/> <path d='M44 62 C42 76 44 88 42 100 C40 108 42 114 40 120' stroke='%23B3E5FC' stroke-width='1.5' fill='none' opacity='0.6'/> <path d='M56 62 C58 78 56 90 58 104 C60 110 58 116 60 122' stroke='%23B3E5FC' stroke-width='1.5' fill='none' opacity='0.5'/> <path d='M68 62 C66 78 68 90 66 104 C64 110 66 116 64 122' stroke='%23B3E5FC' stroke-width='1.5' fill='none' opacity='0.5'/> <path d='M80 62 C82 76 80 88 82 100 C84 108 82 114 84 120' stroke='%23B3E5FC' stroke-width='1.5' fill='none' opacity='0.6'/> <path d='M92 60 C94 72 96 84 94 96 C92 102 90 108 92 114' stroke='%23B3E5FC' stroke-width='1.5' fill='none' opacity='0.6'/> <circle cx='52' cy='34' r='6' fill='white' opacity='0.9'/> <circle cx='54' cy='35' r='3.5' fill='black'/> <circle cx='52' cy='33' r='1.5' fill='white'/> <circle cx='76' cy='34' r='6' fill='white' opacity='0.9'/> <circle cx='78' cy='35' r='3.5' fill='black'/> <circle cx='76' cy='33' r='1.5' fill='white'/> <path d='M58 42 C60 44 68 44 70 42' stroke='%2390CAF9' stroke-width='1.5' fill='none'/> </svg>",
  'crystaldragon': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <defs> <linearGradient id='cdPrism' x1='0' y1='0' x2='1' y2='1'> <stop offset='0%' stop-color='%23E1BEE7'/> <stop offset='25%' stop-color='%23B3E5FC'/> <stop offset='50%' stop-color='%23C8E6C9'/> <stop offset='75%' stop-color='%23FFF9C4'/> <stop offset='100%' stop-color='%23FFCDD2'/> </linearGradient> <radialGradient id='cdGlow' cx='50%' cy='50%' r='60%'> <stop offset='0%' stop-color='white' stop-opacity='0.4'/> <stop offset='100%' stop-color='white' stop-opacity='0'/> </radialGradient> </defs> <ellipse cx='60' cy='64' rx='55' ry='45' fill='url(%23cdGlow)'/> <polygon points='20,58 35,40 55,35 75,38 90,48 95,64 90,80 75,88 55,90 35,85 20,72' fill='url(%23cdPrism)' stroke='white' stroke-width='1' opacity='0.85'/> <line x1='55' y1='35' x2='55' y2='90' stroke='white' stroke-width='0.5' opacity='0.5'/> <line x1='35' y1='40' x2='75' y2='88' stroke='white' stroke-width='0.5' opacity='0.5'/> <line x1='75' y1='38' x2='35' y2='85' stroke='white' stroke-width='0.5' opacity='0.5'/> <line x1='20' y1='58' x2='95' y2='64' stroke='white' stroke-width='0.5' opacity='0.5'/> <line x1='20' y1='72' x2='90' y2='48' stroke='white' stroke-width='0.5' opacity='0.4'/> <polygon points='40,40 38,22 44,24 42,38' fill='%23B3E5FC' opacity='0.7'/> <polygon points='52,36 50,16 56,18 54,34' fill='%23E1BEE7' opacity='0.7'/> <polygon points='64,38 62,20 68,22 66,36' fill='%23C8E6C9' opacity='0.7'/> <polygon points='76,42 75,26 80,28 78,40' fill='%23FFF9C4' opacity='0.7'/> <polygon points='25,52 18,38 22,36 28,48' fill='%23CE93D8' opacity='0.8'/> <polygon points='30,46 24,30 28,28 34,42' fill='%23B3E5FC' opacity='0.8'/> <polygon points='90,48 108,36 112,42 96,56' fill='%23FFCDD2' opacity='0.7'/> <polygon points='95,64 115,64 112,70 96,68' fill='%23B3E5FC' opacity='0.7'/> <polygon points='90,80 108,92 112,86 96,74' fill='%23C8E6C9' opacity='0.7'/> <line x1='20' y1='60' x2='6' y2='52' stroke='%23CE93D8' stroke-width='1.5' opacity='0.6'/> <line x1='20' y1='66' x2='6' y2='70' stroke='%23B3E5FC' stroke-width='1.5' opacity='0.6'/> <circle cx='32' cy='56' r='8' fill='white'/> <circle cx='34' cy='58' r='5' fill='%237C4DFF'/> <circle cx='34' cy='58' r='3' fill='black'/> <circle cx='32' cy='55' r='2' fill='white'/> <circle cx='35' cy='57' r='1' fill='%23E1BEE7'/> </svg>",
  'cosmicwhale': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <defs> <linearGradient id='cwBody' x1='0' y1='0' x2='1' y2='1'> <stop offset='0%' stop-color='%231A237E'/> <stop offset='40%' stop-color='%234A148C'/> <stop offset='100%' stop-color='%23311B92'/> </linearGradient> <radialGradient id='cwNebula' cx='50%' cy='50%' r='50%'> <stop offset='0%' stop-color='%23E040FB' stop-opacity='0.3'/> <stop offset='100%' stop-color='%23E040FB' stop-opacity='0'/> </radialGradient> </defs> <path d='M8 58 C8 36 28 24 55 24 C80 24 100 34 108 50 C112 58 112 72 108 80 C100 96 80 102 55 102 C28 102 8 88 8 58Z' fill='url(%23cwBody)'/> <ellipse cx='60' cy='60' rx='35' ry='25' fill='url(%23cwNebula)'/> <circle cx='35' cy='45' r='1' fill='white' opacity='0.9'/> <circle cx='50' cy='38' r='1.5' fill='white' opacity='0.8'/> <circle cx='68' cy='42' r='1' fill='white' opacity='0.9'/> <circle cx='82' cy='50' r='1.5' fill='white' opacity='0.7'/> <circle cx='45' cy='60' r='1' fill='white' opacity='0.8'/> <circle cx='72' cy='55' r='1' fill='white' opacity='0.9'/> <circle cx='58' cy='48' r='1.5' fill='%23B388FF' opacity='0.8'/> <circle cx='90' cy='62' r='1' fill='white' opacity='0.7'/> <circle cx='38' cy='72' r='1' fill='white' opacity='0.8'/> <circle cx='55' cy='78' r='1' fill='white' opacity='0.7'/> <circle cx='75' cy='74' r='1.5' fill='%23B388FF' opacity='0.6'/> <circle cx='65' cy='65' r='1' fill='%23FF80AB' opacity='0.5'/> <path d='M50 50 C55 45 65 45 70 50 C75 55 75 65 70 70 C65 75 55 72 52 68' stroke='%237C4DFF' stroke-width='1' fill='none' opacity='0.4'/> <path d='M12 68 C12 62 32 56 55 56 C80 56 105 62 105 68 C102 84 82 92 55 92 C32 92 12 82 12 68Z' fill='%233949AB' opacity='0.4'/> <path d='M105 55 C112 42 122 32 126 28 C124 40 120 50 115 58' fill='%231A237E'/> <path d='M105 78 C112 90 122 100 126 104 C124 92 120 82 115 74' fill='%231A237E'/> <path d='M32 82 C24 92 20 100 22 104 C28 100 34 92 38 84' fill='%23311B92'/> <circle cx='22' cy='54' r='9' fill='white'/> <circle cx='25' cy='56' r='5' fill='%237C4DFF'/> <circle cx='25' cy='56' r='3' fill='black'/> <circle cx='23' cy='53' r='2.5' fill='white'/> <circle cx='26' cy='55' r='1' fill='%23E1BEE7'/> <path d='M10 64 C12 66 12 66 10 68' stroke='%230D47A1' stroke-width='1.5' fill='none'/> </svg>",
  'worldserpent': "data:image/svg+xml,<svg width='128' height='128' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'> <defs> <linearGradient id='wsBody' x1='0' y1='0' x2='1' y2='0'> <stop offset='0%' stop-color='%231B5E20'/> <stop offset='100%' stop-color='%232E7D32'/> </linearGradient> </defs> <path d='M10 52 C10 38 22 30 38 30 C55 30 60 42 65 52 C70 60 80 58 90 52 C100 46 110 48 118 56 C124 62 122 72 115 78 C108 84 98 82 88 76 C78 70 68 72 58 80 C48 88 35 90 22 84 C12 78 10 68 10 52Z' fill='url(%23wsBody)'/> <path d='M14 58 C14 50 26 42 42 42 C54 42 58 50 64 58 C56 62 48 58 40 54 C30 50 20 52 14 58Z' fill='%23388E3C' opacity='0.5'/> <circle cx='30' cy='48' r='2.5' fill='%2369F0AE' opacity='0.8'/> <path d='M28 48 L32 48 M30 46 L30 50' stroke='%2369F0AE' stroke-width='1' opacity='0.8'/> <circle cx='50' cy='42' r='2.5' fill='%2369F0AE' opacity='0.7'/> <path d='M48 40 L52 44 M52 40 L48 44' stroke='%2369F0AE' stroke-width='1' opacity='0.7'/> <circle cx='75' cy='56' r='2.5' fill='%2369F0AE' opacity='0.8'/> <path d='M73 54 L77 58 M73 58 L77 54' stroke='%2369F0AE' stroke-width='1' opacity='0.8'/> <circle cx='100' cy='52' r='2.5' fill='%2369F0AE' opacity='0.7'/> <path d='M98 52 L102 52 M100 50 L100 54' stroke='%2369F0AE' stroke-width='1' opacity='0.7'/> <circle cx='55' cy='80' r='2.5' fill='%2369F0AE' opacity='0.6'/> <path d='M53 78 L57 82 M57 78 L53 82' stroke='%2369F0AE' stroke-width='1' opacity='0.6'/> <path d='M14 44 L8 30 L16 36 Z' fill='%231B5E20'/> <path d='M22 38 L18 22 L26 30 Z' fill='%231B5E20'/> <path d='M38 30 L40 22 L43 30' fill='%232E7D32'/> <path d='M48 32 L50 24 L53 32' fill='%232E7D32'/> <path d='M90 50 L92 42 L95 50' fill='%232E7D32'/> <path d='M108 52 L110 44 L113 54' fill='%232E7D32'/> <path d='M118 56 L126 50 L128 58' fill='%231B5E20'/> <path d='M118 74 L126 80 L128 72' fill='%231B5E20'/> <circle cx='16' cy='50' r='7' fill='white'/> <circle cx='18' cy='51' r='4' fill='%2369F0AE'/> <circle cx='18' cy='51' r='2.5' fill='black'/> <circle cx='16' cy='49' r='2' fill='white'/> <circle cx='19' cy='50' r='1' fill='%2369F0AE'/> <path d='M10 56 L6 54 L6 60 L10 58' fill='%230D3311'/> <path d='M7 54 L8 58' stroke='white' stroke-width='1.5' stroke-linecap='round'/> <path d='M9 54 L9.5 57' stroke='white' stroke-width='1' stroke-linecap='round'/> </svg>",
};

// ============================================================
// âœ¨ å¤‰ç•°ç¨®ï¼ˆãƒ¬ã‚¢é­šï¼‰
// ============================================================
const VARIANT_TYPES = [
  { id:'gold',   name:'ã‚´ãƒ¼ãƒ«ãƒ‰', suffix:'ã€é‡‘ã€‘', incomeMultiplier:2.5,
    paletteOverride:{body:'#ffd700',fin:'#daa520',belly:'#fff8dc',stripe:'#b8860b'},
    glowColor:'rgba(255,215,0,0.4)', particleColor:'#ffd700' },
  { id:'albino', name:'ã‚¢ãƒ«ãƒ“ãƒ', suffix:'ã€ç™½ã€‘', incomeMultiplier:2.5,
    paletteOverride:{body:'#fff5f5',fin:'#ffe0e0',belly:'#ffffff',stripe:'#ffcccc'},
    glowColor:'rgba(255,200,200,0.3)', particleColor:'#ffdddd' },
  { id:'neon',   name:'ãƒã‚ªãƒ³',   suffix:'ã€å…‰ã€‘', incomeMultiplier:2.5,
    paletteOverride:null,
    glowColor:'rgba(0,255,200,0.6)', particleColor:'#00ffc8' },
  { id:'holo',   name:'ãƒ›ãƒ­',     suffix:'ã€è™¹ã€‘', incomeMultiplier:2.5,
    paletteOverride:null,
    glowColor:'rgba(255,255,255,0.4)', particleColor:'#ffffff' },
];

// ============================================================
// ğŸ“– ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³å›³é‘‘
// ============================================================
let collection = {};
function initCollection() {
  for (const ft of FISH_TYPES) {
    if (!collection[ft.id]) {
      collection[ft.id] = { discovered:false, variantDiscovered:{gold:false,albino:false,neon:false,holo:false}, hueShifts:[] };
    } else if (!collection[ft.id].hueShifts) {
      collection[ft.id].hueShifts = [];
    }
  }
}
function discoverFish(typeId, variantType, hueShift) {
  if (!collection[typeId]) collection[typeId] = { discovered:false, variantDiscovered:{gold:false,albino:false,neon:false,holo:false}, hueShifts:[] };
  if (!collection[typeId].hueShifts) collection[typeId].hueShifts = [];
  let isNew = false;
  if (!collection[typeId].discovered) {
    collection[typeId].discovered = true; isNew = true;
    const ft = FISH_TYPES.find(t => t.id === typeId);
    if (ft) showNotification('ğŸ“– å›³é‘‘ç™»éŒ²ï¼ ' + ft.name + ' ã‚’ç™ºè¦‹ï¼');
  }
  if (variantType && !collection[typeId].variantDiscovered[variantType]) {
    collection[typeId].variantDiscovered[variantType] = true; isNew = true;
    const ft = FISH_TYPES.find(t => t.id === typeId);
    const vt = VARIANT_TYPES.find(v => v.id === variantType);
    if (ft && vt) showNotification('âœ¨ ãƒ¬ã‚¢å›³é‘‘ï¼ ' + ft.name + vt.suffix + ' ã‚’ç™ºè¦‹ï¼');
  }
  // ã‚«ãƒ©ãƒ¼ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä¿å­˜ï¼ˆå¤‰ç•°ç¨®ã§ãªã„å ´åˆã®ã¿ã€æœ€å¤§12è‰²ã¾ã§ï¼‰
  if (hueShift !== undefined && !variantType) {
    const hs = collection[typeId].hueShifts;
    if (!hs.includes(hueShift) && hs.length < 12) hs.push(hueShift);
  }
  return isNew;
}
function getCollectionCompletion() {
  let total = 0, discovered = 0;
  for (const ft of FISH_TYPES) {
    total += 5;
    if (collection[ft.id]?.discovered) discovered++;
    for (const vt of VARIANT_TYPES) { if (collection[ft.id]?.variantDiscovered?.[vt.id]) discovered++; }
  }
  return { total, discovered, percent: Math.round(discovered/total*100) };
}

// ã‚¬ãƒãƒ£è¨­å®š
const GACHA_TIERS = [
  { name:'ãƒãƒ¼ãƒãƒ«ã‚¬ãƒãƒ£',   icon:'ğŸ²', cost:50000,   variantChance:0.03, desc:'ãƒ¬ã‚¢ç‡3%' },
  { name:'ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚¬ãƒãƒ£', icon:'ğŸ°', cost:500000,  variantChance:0.08, desc:'ãƒ¬ã‚¢ç‡8%' },
  { name:'ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰ã‚¬ãƒãƒ£', icon:'ğŸ‘‘', cost:5000000, variantChance:0.15, desc:'ãƒ¬ã‚¢ç‡15%' },
];

// ============================================================
// ğŸ—ºï¸ ã‚¨ãƒªã‚¢
// ============================================================
const AREAS = [
  { id:'freshwater', name:'æ·¡æ°´', icon:'ğŸï¸', price:0, unlocked:true,
    desc:'æœ€åˆã®ã‚¨ãƒªã‚¢ã€‚æ·¡æ°´ã®é­šãŸã¡',
    bg: {
      day:   ['#0a3d5c','#0c5c7a','#0d3b4f'],
      night: ['#050d15','#081a28','#060f18'],
      blue:  ['#0a1a3a','#0c2a5a','#081540']
    },
    sandRGB:[194,170,110],
    plantStyle:'seaweed',
    plantColors:[{r:40,g:160,b:60},{r:30,g:130,b:80}]
  },
  { id:'coral', name:'ã‚µãƒ³ã‚´ç¤', icon:'ğŸª¸', price:2000000, unlocked:false,
    desc:'ã‚«ãƒ©ãƒ•ãƒ«ãªã‚µãƒ³ã‚´ã®æµ·',
    bg: {
      day:   ['#064a6e','#0878a0','#065a7a'],
      night: ['#031520','#052030','#041825'],
      blue:  ['#082050','#0a3878','#061848']
    },
    sandRGB:[230,210,170],
    plantStyle:'coral',
    plantColors:[{r:220,g:80,b:100},{r:255,g:140,b:60},{r:180,g:60,b:160}]
  },
  { id:'deepsea', name:'æ·±æµ·', icon:'ğŸŒ‘', price:20000000, unlocked:false,
    desc:'æš—ã„æ·±æµ·ã€‚ç¥ç§˜çš„ãªç”Ÿãç‰©ãŸã¡',
    bg: {
      day:   ['#020a14','#041828','#030e1c'],
      night: ['#010408','#020a14','#01060c'],
      blue:  ['#020818','#041430','#020c20']
    },
    sandRGB:[80,75,90],
    plantStyle:'deepsea',
    plantColors:[{r:20,g:60,b:80},{r:10,g:80,b:60}]
  },
  { id:'tropical', name:'ç†±å¸¯æ²³å·', icon:'ğŸŒ´', price:80000000, unlocked:false,
    desc:'ã‚¢ãƒã‚¾ãƒ³ã®å¤§æ²³ã€‚å·¨å¤§é­šã®æ¥½åœ’',
    bg: {
      day:   ['#1a3a20','#1c5c30','#143a1c'],
      night: ['#080f08','#0c1a0e','#0a120a'],
      blue:  ['#0a2a1a','#0c3c2c','#081c14']
    },
    sandRGB:[160,130,80],
    plantStyle:'tropical',
    plantColors:[{r:30,g:180,b:40},{r:20,g:140,b:30},{r:60,g:160,b:50}]
  },
  { id:'mystic', name:'ç¥ç§˜ã®æ³‰', icon:'âœ¨', price:300000000, unlocked:false,
    desc:'ä¸æ€è­°ãªå…‰ãŒæ¼‚ã†ä¼èª¬ã®ã‚¨ãƒªã‚¢',
    bg: {
      day:   ['#1a0a3a','#2c1a5a','#180840'],
      night: ['#0a0418','#14082a','#0c0520'],
      blue:  ['#100830','#1c1050','#0c0628']
    },
    sandRGB:[140,120,180],
    plantStyle:'crystal',
    plantColors:[{r:120,g:60,b:200},{r:80,g:40,b:160},{r:160,g:80,b:220}]
  },
];

// ã‚¨ãƒªã‚¢ã”ã¨ã®çŠ¶æ…‹
const areaStates = {};
for (const a of AREAS) areaStates[a.id] = { fishes:[], plants:[], sandParticles:[] };
let currentAreaId = 'freshwater';
function getCurrentArea() { return AREAS.find(a => a.id === currentAreaId); }

function switchArea(areaId) {
  const area = AREAS.find(a => a.id === areaId);
  if (!area || !area.unlocked) return;
  // ä»Šã®ã‚¨ãƒªã‚¢ã‚’ä¿å­˜
  areaStates[currentAreaId].fishes = fishes;
  areaStates[currentAreaId].plants = plants;
  areaStates[currentAreaId].sandParticles = sandParticles;
  // åˆ‡ã‚Šæ›¿ãˆ
  currentAreaId = areaId;
  fishes = areaStates[areaId].fishes;
  plants = areaStates[areaId].plants;
  sandParticles = areaStates[areaId].sandParticles;
  // åˆè¨ªå•ãªã‚‰environmentç”Ÿæˆ
  if (plants.length === 0) initEnvironment();
  // ä¸€æ™‚çš„ãªã‚‚ã®ã‚’ãƒªã‚»ãƒƒãƒˆ
  bubbles = []; foods = []; treasureBubbles = [];
  updateIncomeDisplay();
  buildAreaTabs();
}

function buildAreaTabs() {
  const c = document.getElementById('areaTabs');
  c.innerHTML = '';
  for (const a of AREAS) {
    const btn = document.createElement('button');
    const fishCount = areaStates[a.id].fishes.length;
    btn.className = 'area-tab' + (a.id === currentAreaId ? ' active' : '') + (!a.unlocked ? ' locked' : '');
    btn.innerHTML = a.icon + ' ' + a.name + (a.unlocked ? '<span class="tab-count">(' + fishCount + ')</span>' : ' ğŸ”’');
    btn.onclick = () => { if (a.unlocked) switchArea(a.id); };
    c.appendChild(btn);
  }
}

// ============================================================
// çŠ¶æ…‹
// ============================================================
let bubblerOn = true, lightMode = 'day', lightIndex = 0;
const lightModes = ['day','night','blue'];
let fishes = [], bubbles = [], foods = [], plants = [], sandParticles = [], treasureBubbles = [];
let autoFeederTimer = 0, breedTimer = 0, treasureTimer = 0;
let mouseX = -999, mouseY = -999, hoveredFish = null;

// ============================================================
// ğŸŸ é­šã‚¯ãƒ©ã‚¹
// ============================================================
class Fish {
  constructor(typeId, x, y, isVariant, variantType) {
    const type = FISH_TYPES.find(t => t.id === typeId) || FISH_TYPES[0];
    this.type = type; this.typeId = typeId;
    this.x = x || Math.random() * canvas.width;
    this.y = y || 60 + Math.random() * (canvas.height - 160);
    this.size = type.sizeRange[0] + Math.random() * (type.sizeRange[1] - type.sizeRange[0]);
    this.baseSize = this.size;
    this.speed = type.speedRange[0] + Math.random() * (type.speedRange[1] - type.speedRange[0]);
    this.direction = Math.random() > 0.5 ? 1 : -1;
    this.targetX = this.x; this.targetY = this.y;
    this.changeTimer = 0;
    this.tailPhase = Math.random() * Math.PI * 2;
    const pal = type.palettes[Math.floor(Math.random() * type.palettes.length)];
    this.colors = { ...pal };
    if (type.patternType === 'random') {
      this.patternType = ['none','vstripes','dots'][Math.floor(Math.random()*3)];
    } else {
      this.patternType = type.patternType;
    }
    // ãƒ©ãƒ³ãƒ€ãƒ ã‚«ãƒ©ãƒ¼ï¼ˆã‚¢ã‚¤ã‚³ãƒ³ç”¨hue-rotateï¼‰
    this.hueShift = Math.floor(Math.random() * 360);
    // å¤‰ç•°ç¨®ã‚µãƒãƒ¼ãƒˆ
    this.isVariant = isVariant || false;
    this.variantType = variantType || null;
    this.variantParticles = [];
    if (this.isVariant && this.variantType) {
      const vt = VARIANT_TYPES.find(v => v.id === this.variantType);
      if (vt && vt.paletteOverride) this.colors = { ...vt.paletteOverride };
    }
  }

  getPassiveIncome() {
    let base = this.type.passiveIncome;
    if (this.isVariant) {
      const vt = VARIANT_TYPES.find(v => v.id === this.variantType);
      if (vt) base *= vt.incomeMultiplier;
    }
    return base;
  }

  update() {
    this.changeTimer--;
    if (this.changeTimer <= 0) {
      this.targetX = 40 + Math.random() * (canvas.width - 80);
      if (this.type.bottomDweller) {
        this.targetY = canvas.height - 70 - Math.random() * 50;
      } else {
        this.targetY = 40 + Math.random() * (canvas.height - 140);
      }
      this.changeTimer = 120 + Math.random() * 200;
    }
    if (foods.length > 0) {
      let nearest = null, minDist = Infinity;
      for (const f of foods) { const d = Math.hypot(f.x - this.x, f.y - this.y); if (d < minDist) { minDist = d; nearest = f; } }
      if (nearest && minDist < 280) {
        this.targetX = nearest.x; this.targetY = nearest.y;
        if (minDist < this.size) {
          addCoins(nearest.coinReward, nearest.x, nearest.y);
          this.size = Math.min(this.size + nearest.growAmount, this.baseSize * 3.5);
          foods.splice(foods.indexOf(nearest), 1);
        }
      }
    }
    const dx = this.targetX - this.x, dy = this.targetY - this.y;
    this.x += dx * 0.01 * this.speed;
    this.y += dy * 0.005 * this.speed;
    if (Math.abs(dx) > 2) this.direction = dx > 0 ? 1 : -1;
    this.tailPhase += 0.08 * this.speed;
    // Keep in bounds
    this.x = Math.max(20, Math.min(canvas.width - 20, this.x));
    this.y = Math.max(20, Math.min(canvas.height - 40, this.y));
  }

  draw() {
    ctx.save();
    ctx.translate(this.x, this.y);
    ctx.scale(this.direction, 1);
    const s = this.size;

    switch(this.type.shape) {
      case 'seahorse': this.drawSeahorse(s); break;
      case 'puffer': this.drawPuffer(s); break;
      case 'serpent': this.drawSerpent(s); break;
      case 'manta': this.drawManta(s); break;
      case 'mythic': this.drawMythic(s); break;
      default: this.drawGeneric(s); break;
    }
    this.drawVariantEffects(s);

    ctx.restore();
  }

  // ---------- å¤‰ç•°ç¨®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ ----------
  drawVariantEffects(s) {
    if (!this.isVariant) return;
    const vt = VARIANT_TYPES.find(v => v.id === this.variantType);
    if (!vt) return;
    // ãƒ›ãƒ­è™¹è‰²ã‚µã‚¤ã‚¯ãƒ«
    if (vt.id === 'holo') {
      const hue = (Date.now()*0.1)%360;
      this.colors.body = `hsl(${hue},70%,60%)`;
      this.colors.fin = `hsl(${(hue+30)%360},70%,50%)`;
      this.colors.belly = `hsl(${(hue+60)%360},50%,80%)`;
    }
    // ã‚°ãƒ­ãƒ¼ã‚ªãƒ¼ãƒ©
    if (vt.glowColor) {
      ctx.shadowColor = vt.glowColor;
      ctx.shadowBlur = 12 + Math.sin(Date.now()*0.003)*5;
      ctx.fillStyle = vt.glowColor.replace(/[\d.]+\)$/,'0.08)');
      ctx.beginPath(); ctx.ellipse(0,0,s*1.2,s*0.7,0,0,Math.PI*2); ctx.fill();
      ctx.shadowBlur = 0;
    }
    // ã‚­ãƒ©ã‚­ãƒ©ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«
    if (Math.random() < 0.12) {
      this.variantParticles.push({ ox:(Math.random()-0.5)*s*2, oy:(Math.random()-0.5)*s*1.5, life:40, maxLife:40 });
    }
    if (this.variantParticles.length > 5) this.variantParticles.shift();
    for (let i = this.variantParticles.length-1; i >= 0; i--) {
      const p = this.variantParticles[i];
      p.life--; p.oy -= 0.3;
      if (p.life <= 0) { this.variantParticles.splice(i,1); continue; }
      const a = p.life/p.maxLife;
      ctx.globalAlpha = a*0.7;
      ctx.fillStyle = vt.particleColor;
      ctx.beginPath();
      // æ˜Ÿå½¢ã‚­ãƒ©ã‚­ãƒ©
      const sz = 2 + a*2;
      ctx.moveTo(p.ox, p.oy-sz); ctx.lineTo(p.ox+sz*0.3, p.oy-sz*0.3);
      ctx.lineTo(p.ox+sz, p.oy); ctx.lineTo(p.ox+sz*0.3, p.oy+sz*0.3);
      ctx.lineTo(p.ox, p.oy+sz); ctx.lineTo(p.ox-sz*0.3, p.oy+sz*0.3);
      ctx.lineTo(p.ox-sz, p.oy); ctx.lineTo(p.ox-sz*0.3, p.oy-sz*0.3);
      ctx.closePath(); ctx.fill();
      ctx.globalAlpha = 1;
    }
  }

  // ---------- æ±ç”¨æç”» ----------
  drawGeneric(s) {
    const bw = this.type.bodyW || 0.7;
    const bh = this.type.bodyH || 0.4;
    const tw = Math.sin(this.tailPhase) * 5;
    const ts = this.type.tailStyle;

    // å°¾ãƒ“ãƒ¬
    ctx.fillStyle = this.colors.fin;
    if (ts === 'flowing') {
      const tw1 = Math.sin(this.tailPhase)*8, tw2 = Math.sin(this.tailPhase+1)*6;
      ctx.beginPath();
      ctx.moveTo(-s*bw*0.5, 0);
      ctx.bezierCurveTo(-s*bw*1.3, -s*0.7+tw1, -s*bw*2+tw2, -s*0.5, -s*bw*1.8+tw1, 0);
      ctx.bezierCurveTo(-s*bw*2+tw2, s*0.5, -s*bw*1.3, s*0.7+tw1, -s*bw*0.5, 0);
      ctx.globalAlpha = 0.6; ctx.fill(); ctx.globalAlpha = 1;
    } else if (ts === 'fan') {
      ctx.beginPath();
      ctx.moveTo(-s*bw*0.5, 0);
      ctx.bezierCurveTo(-s*bw*1.2, -s*0.6+tw, -s*bw*1.6, -s*0.3, -s*bw*1.4+tw*0.3, 0);
      ctx.bezierCurveTo(-s*bw*1.6, s*0.3, -s*bw*1.2, s*0.6+tw, -s*bw*0.5, 0);
      ctx.globalAlpha = 0.7; ctx.fill(); ctx.globalAlpha = 1;
    } else if (ts === 'fork') {
      ctx.beginPath();
      ctx.moveTo(-s*bw*0.5, 0);
      ctx.quadraticCurveTo(-s*bw*1.0, -s*bh*0.3, -s*bw*1.5+tw, -s*bh*1.2);
      ctx.quadraticCurveTo(-s*bw*1.1, -s*bh*0.1, -s*bw*0.9, 0);
      ctx.quadraticCurveTo(-s*bw*1.1, s*bh*0.1, -s*bw*1.5+tw, s*bh*1.2);
      ctx.quadraticCurveTo(-s*bw*1.0, s*bh*0.3, -s*bw*0.5, 0);
      ctx.closePath(); ctx.fill();
    } else if (ts === 'lobe') {
      // ã‚·ãƒ¼ãƒ©ã‚«ãƒ³ã‚¹ã®ãƒ’ãƒ¬
      ctx.beginPath();
      ctx.moveTo(-s*bw*0.5, 0);
      ctx.ellipse(-s*bw*0.85, -s*bh*0.3+tw*0.3, s*0.2, s*bh*0.6, -0.2, 0, Math.PI*2);
      ctx.fill();
      ctx.beginPath();
      ctx.ellipse(-s*bw*0.85, s*bh*0.3+tw*0.3, s*0.2, s*bh*0.6, 0.2, 0, Math.PI*2);
      ctx.fill();
    } else {
      // ä¸¸ã¿ã®ã‚ã‚‹å°¾ãƒ“ãƒ¬ï¼ˆtriï¼‰
      ctx.beginPath();
      ctx.moveTo(-s*bw*0.5, 0);
      ctx.quadraticCurveTo(-s*bw*1.0, -s*bh*0.4, -s*bw*1.4+tw, -s*bh*1.1);
      ctx.quadraticCurveTo(-s*bw*1.5+tw, 0, -s*bw*1.4+tw, s*bh*1.1);
      ctx.quadraticCurveTo(-s*bw*1.0, s*bh*0.4, -s*bw*0.5, 0);
      ctx.closePath(); ctx.fill();
    }

    // ã‚°ãƒ­ãƒ¼
    if (this.type.glowColor) { ctx.shadowColor = this.type.glowColor; ctx.shadowBlur = 12; }

    // ä½“
    ctx.fillStyle = this.colors.body;
    ctx.beginPath(); ctx.ellipse(0, 0, s*bw, s*bh, 0, 0, Math.PI*2); ctx.fill();
    ctx.shadowBlur = 0;

    // ãŠè…¹
    ctx.fillStyle = this.colors.belly;
    ctx.beginPath(); ctx.ellipse(0, s*bh*0.2, s*(bw*0.75), s*(bh*0.55), 0, 0, Math.PI); ctx.fill();

    // æ¨¡æ§˜
    this.drawPattern(s, bw, bh);

    // èƒŒãƒ“ãƒ¬
    ctx.fillStyle = this.colors.fin;
    const ds = this.type.dorsalStyle;
    if (ds === 'tall') {
      ctx.beginPath(); ctx.moveTo(-s*bw*0.3, -s*bh);
      ctx.quadraticCurveTo(0, -s*bh*2.8, s*bw*0.3, -s*bh); ctx.closePath(); ctx.fill();
    } else if (ds === 'flowing') {
      const sw = Math.sin(this.tailPhase*0.7)*3;
      ctx.globalAlpha = 0.55;
      ctx.beginPath(); ctx.moveTo(-s*bw*0.5, -s*bh);
      ctx.quadraticCurveTo(0, -s*bh*2.2+sw, s*bw*0.5, -s*bh); ctx.closePath(); ctx.fill();
      ctx.globalAlpha = 1;
    } else {
      ctx.globalAlpha = 0.7;
      ctx.beginPath(); ctx.moveTo(-s*bw*0.25, -s*bh*0.85);
      ctx.bezierCurveTo(-s*bw*0.1, -s*bh*1.8, s*bw*0.3, -s*bh*1.8, s*bw*0.45, -s*bh*0.85);
      ctx.closePath(); ctx.fill();
      ctx.globalAlpha = 1;
    }

    // è…¹ãƒ“ãƒ¬ï¼ˆã‚¨ãƒ³ã‚¼ãƒ«ï¼‰
    if (this.type.hasVentralFin) {
      ctx.fillStyle = this.colors.fin;
      ctx.beginPath(); ctx.moveTo(-s*bw*0.1, s*bh);
      ctx.quadraticCurveTo(0, s*bh*2.5, s*bw*0.15, s*bh); ctx.closePath(); ctx.fill();
    }

    // ãƒ’ã‚²
    if (this.type.hasWhiskers) {
      ctx.strokeStyle = this.colors.fin; ctx.lineWidth = 1.5; ctx.lineCap = 'round';
      const hx = s*bw*0.7;
      ctx.beginPath(); ctx.moveTo(hx, -s*0.02);
      ctx.quadraticCurveTo(hx+s*0.15, -s*0.12, hx+s*0.25, -s*0.2); ctx.stroke();
      ctx.beginPath(); ctx.moveTo(hx, s*0.04);
      ctx.quadraticCurveTo(hx+s*0.15, s*0.12, hx+s*0.25, s*0.18); ctx.stroke();
    }

    // ç›®
    this.drawEye(s, s*(bw-0.2), -s*bh*0.2);
    // ã»ã£ãº
    this.drawBlush(s, s*(bw-0.35), s*bh*0.15);
  }

  // ---------- ã‚¿ãƒ„ãƒã‚ªãƒˆã‚·ã‚´ ----------
  drawSeahorse(s) {
    const wave = Math.sin(this.tailPhase)*3;

    // å·»ãã—ã£ã½
    ctx.strokeStyle = this.colors.body; ctx.lineWidth = s*0.18; ctx.lineCap = 'round';
    ctx.beginPath();
    ctx.arc(0, s*0.6, s*0.25, -Math.PI*0.3, Math.PI*0.9);
    ctx.stroke();

    // ä½“ï¼ˆã·ã£ãã‚Šï¼‰
    ctx.fillStyle = this.colors.body;
    ctx.beginPath();
    ctx.moveTo(s*0.1, -s*0.7);
    ctx.bezierCurveTo(s*0.38, -s*0.4, s*0.35+wave*0.01, s*0.0, s*0.1, s*0.35);
    ctx.bezierCurveTo(-s*0.15, s*0.0, -s*0.2, -s*0.4, s*0.0, -s*0.7);
    ctx.closePath(); ctx.fill();

    // ãŠè…¹
    ctx.fillStyle = this.colors.belly;
    ctx.beginPath(); ctx.ellipse(s*0.16, -s*0.1, s*0.1, s*0.25, 0.1, 0, Math.PI*2); ctx.fill();

    // ãã¡ã°ã—
    ctx.fillStyle = this.colors.body;
    ctx.beginPath(); ctx.ellipse(s*0.3, -s*0.65, s*0.18, s*0.05, 0.15, 0, Math.PI*2); ctx.fill();

    // èƒŒãƒ“ãƒ¬
    ctx.fillStyle = this.colors.fin; ctx.globalAlpha = 0.5;
    ctx.beginPath(); ctx.ellipse(-s*0.08, -s*0.2+wave*0.01, s*0.08, s*0.13, -0.3, 0, Math.PI*2); ctx.fill();
    ctx.globalAlpha = 1;

    // ç›®ï¼ˆã‹ã‚ã„ã„ç‰ˆï¼‰
    this.drawEye(s, s*0.13, -s*0.58);
    // ã»ã£ãº
    this.drawBlush(s, s*0.22, -s*0.35);
  }

  // ---------- ãƒ•ã‚° ----------
  drawPuffer(s) {
    const tw = Math.sin(this.tailPhase)*2;

    // å°ã•ã„å°»å°¾
    ctx.fillStyle = this.colors.fin;
    ctx.beginPath(); ctx.moveTo(-s*0.4, 0);
    ctx.lineTo(-s*0.65+tw, -s*0.12); ctx.lineTo(-s*0.65+tw, s*0.12); ctx.closePath(); ctx.fill();

    // ã¾ã‚“ã¾ã‚‹ãƒœãƒ‡ã‚£
    ctx.fillStyle = this.colors.body;
    ctx.beginPath(); ctx.arc(0, 0, s*0.5, 0, Math.PI*2); ctx.fill();

    // ãŠè…¹
    ctx.fillStyle = this.colors.belly;
    ctx.beginPath(); ctx.ellipse(0, s*0.1, s*0.38, s*0.3, 0, 0, Math.PI); ctx.fill();

    // æ¨¡æ§˜ï¼ˆç‚¹ã€…ï¼‰
    const sc = this.colors.stripe || 'rgba(100,80,50,0.3)';
    ctx.fillStyle = sc;
    const spots = [[-0.2,-0.2],[0.15,-0.15],[-0.1,0.1],[0.2,0.05],[0,-0.25],[0.1,0.2]];
    for (const [sx,sy] of spots) {
      ctx.beginPath(); ctx.arc(sx*s, sy*s, s*0.035, 0, Math.PI*2); ctx.fill();
    }

    // èƒ¸ãƒ“ãƒ¬
    ctx.fillStyle = this.colors.fin; ctx.globalAlpha = 0.5;
    ctx.beginPath(); ctx.ellipse(s*0.2, s*0.15, s*0.12, s*0.05, 0.3+tw*0.03, 0, Math.PI*2); ctx.fill();
    ctx.globalAlpha = 1;

    // ã§ã‹ã„ç›®
    this.drawEye(s, s*0.2, -s*0.12);
    // ã»ã£ãº
    this.drawBlush(s, s*0.1, s*0.08);
  }

  // ---------- ãƒªãƒ¥ã‚¦ã‚°ã‚¦ãƒãƒ„ã‚«ã‚¤ ----------
  drawSerpent(s) {
    const segments = 8, segLen = s*0.35;
    const pts = [];
    let px = s*0.3, py = 0;
    for (let i = 0; i <= segments; i++) {
      const wave = Math.sin(this.tailPhase + i*0.7) * (2 + i*1.5);
      pts.push({x: px, y: py + wave});
      px -= segLen;
    }

    // ä½“ï¼ˆå¤ªã„ç·šï¼‰
    ctx.strokeStyle = this.colors.body; ctx.lineWidth = s*0.22; ctx.lineCap = 'round'; ctx.lineJoin = 'round';
    ctx.beginPath(); ctx.moveTo(pts[0].x, pts[0].y);
    for (let i = 1; i < pts.length; i++) ctx.lineTo(pts[i].x, pts[i].y);
    ctx.stroke();

    // ãŠè…¹ãƒ©ã‚¤ãƒ³
    ctx.strokeStyle = this.colors.belly; ctx.lineWidth = s*0.12;
    ctx.beginPath(); ctx.moveTo(pts[0].x, pts[0].y+s*0.03);
    for (let i = 1; i < pts.length; i++) ctx.lineTo(pts[i].x, pts[i].y+s*0.03);
    ctx.stroke();

    // èµ¤ã„èƒŒãƒ“ãƒ¬ï¼ˆã‚¯ãƒ¬ã‚¹ãƒˆï¼‰
    ctx.strokeStyle = this.colors.fin; ctx.lineWidth = s*0.1;
    ctx.beginPath(); ctx.moveTo(pts[0].x, pts[0].y-s*0.12);
    for (let i = 1; i <= 3; i++) ctx.lineTo(pts[i].x, pts[i].y - s*0.15 - Math.sin(this.tailPhase+i)*2);
    ctx.stroke();

    // é ­ã®é£¾ã‚Šãƒ’ãƒ¬
    ctx.fillStyle = this.colors.fin; ctx.globalAlpha = 0.7;
    ctx.beginPath();
    ctx.moveTo(pts[0].x, pts[0].y - s*0.12);
    ctx.lineTo(pts[0].x + s*0.15, pts[0].y - s*0.45);
    ctx.lineTo(pts[0].x - s*0.1, pts[0].y - s*0.35);
    ctx.closePath(); ctx.fill();
    ctx.globalAlpha = 1;

    // ç›®ï¼ˆã‹ã‚ã„ã„ç‰ˆï¼‰
    this.drawEye(s, pts[0].x+s*0.02, pts[0].y-s*0.02);
    // ã»ã£ãº
    this.drawBlush(s, pts[0].x-s*0.05, pts[0].y+s*0.1);
  }

  // ---------- ãƒãƒ³ã‚¿ ----------
  drawManta(s) {
    const flap = Math.sin(this.tailPhase*0.6)*0.15;

    // ã—ã£ã½
    ctx.strokeStyle = this.colors.fin; ctx.lineWidth = s*0.05; ctx.lineCap = 'round';
    ctx.beginPath(); ctx.moveTo(-s*0.5, 0);
    ctx.lineTo(-s*1.4, Math.sin(this.tailPhase)*s*0.1); ctx.stroke();

    // ç¿¼ï¼ˆä½“ï¼‰
    ctx.fillStyle = this.colors.body;
    ctx.beginPath();
    ctx.moveTo(s*0.5, 0);
    ctx.quadraticCurveTo(s*0.2, -s*(0.7+flap*s*0.02), -s*0.4, -s*0.08);
    ctx.quadraticCurveTo(-s*0.5, 0, -s*0.4, s*0.08);
    ctx.quadraticCurveTo(s*0.2, s*(0.7+flap*s*0.02), s*0.5, 0);
    ctx.fill();

    // ãŠè…¹
    ctx.fillStyle = this.colors.belly;
    ctx.beginPath(); ctx.ellipse(0, 0, s*0.3, s*0.08, 0, 0, Math.PI*2); ctx.fill();

    // ç›®ï¼ˆã‹ã‚ã„ã„ç‰ˆï¼‰
    this.drawEye(s, s*0.3, -s*0.06);
    // ã»ã£ãº
    this.drawBlush(s, s*0.2, s*0.06);
  }

  // ---------- é¾ç¥ ----------
  drawMythic(s) {
    const tw = Math.sin(this.tailPhase)*5;

    // ã‚ªãƒ¼ãƒ©
    ctx.shadowColor = 'rgba(255,215,0,0.6)'; ctx.shadowBlur = 20;
    ctx.fillStyle = 'rgba(255,215,0,0.08)';
    ctx.beginPath(); ctx.ellipse(0, 0, s*1.2, s*0.6, 0, 0, Math.PI*2); ctx.fill();
    ctx.shadowBlur = 0;

    // æµã‚Œã‚‹ãƒ’ãƒ¬ï¼ˆå°¾ï¼‰
    ctx.fillStyle = this.colors.fin;
    const tw1 = Math.sin(this.tailPhase)*10, tw2 = Math.sin(this.tailPhase+1)*8;
    ctx.globalAlpha = 0.5;
    ctx.beginPath();
    ctx.moveTo(-s*0.5, 0);
    ctx.bezierCurveTo(-s*1.2, -s*0.6+tw1, -s*1.8+tw2, -s*0.4, -s*1.6+tw1, 0);
    ctx.bezierCurveTo(-s*1.8+tw2, s*0.4, -s*1.2, s*0.6+tw1, -s*0.5, 0);
    ctx.fill(); ctx.globalAlpha = 1;

    // ã‚°ãƒ­ãƒ¼ä»˜ãä½“
    ctx.shadowColor = 'rgba(255,215,0,0.4)'; ctx.shadowBlur = 15;
    ctx.fillStyle = this.colors.body;
    ctx.beginPath(); ctx.ellipse(0, 0, s*0.9, s*0.3, 0, 0, Math.PI*2); ctx.fill();
    ctx.shadowBlur = 0;

    // ãŠè…¹
    ctx.fillStyle = this.colors.belly;
    ctx.beginPath(); ctx.ellipse(0, s*0.06, s*0.7, s*0.18, 0, 0, Math.PI); ctx.fill();

    // é±—
    ctx.strokeStyle = 'rgba(255,180,0,0.25)'; ctx.lineWidth = 0.5;
    for (let row = -1; row <= 1; row++) {
      for (let col = -3; col <= 3; col++) {
        ctx.beginPath(); ctx.arc(col*s*0.18, row*s*0.1, s*0.07, 0, Math.PI*2); ctx.stroke();
      }
    }

    // èƒŒãƒ“ãƒ¬ï¼ˆé¾ã®é¬£ï¼‰
    ctx.fillStyle = this.colors.fin; ctx.globalAlpha = 0.6;
    const sw = Math.sin(this.tailPhase*0.7)*4;
    ctx.beginPath(); ctx.moveTo(-s*0.5, -s*0.28);
    ctx.quadraticCurveTo(-s*0.1, -s*0.8+sw, s*0.5, -s*0.28); ctx.closePath(); ctx.fill();
    ctx.globalAlpha = 1;

    // ãƒ’ã‚²ï¼ˆé¾ï¼‰
    ctx.strokeStyle = this.colors.fin; ctx.lineWidth = 1.5; ctx.lineCap = 'round';
    const hx = s*0.7;
    ctx.beginPath(); ctx.moveTo(hx, -s*0.05);
    ctx.quadraticCurveTo(hx+s*0.3, -s*0.25+tw*0.02, hx+s*0.45, -s*0.3); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(hx, s*0.05);
    ctx.quadraticCurveTo(hx+s*0.3, s*0.2+tw*0.02, hx+s*0.4, s*0.25); ctx.stroke();

    // ç›®
    ctx.shadowColor = 'rgba(255,215,0,0.8)'; ctx.shadowBlur = 6;
    this.drawEye(s, s*0.5, -s*0.05);
    ctx.shadowBlur = 0;
    // ã»ã£ãº
    this.drawBlush(s, s*0.35, s*0.1);
  }

  // ---------- æ¨¡æ§˜æç”» ----------
  drawPattern(s, bw, bh) {
    const pt = this.patternType;
    if (!pt || pt === 'none') return;

    if (pt === 'vstripes') {
      ctx.strokeStyle = 'rgba(255,255,255,0.2)'; ctx.lineWidth = 1.5;
      for (let i = -2; i <= 2; i++) { ctx.beginPath(); ctx.moveTo(i*s*0.18, -s*bh*0.8); ctx.lineTo(i*s*0.18, s*bh*0.8); ctx.stroke(); }
    } else if (pt === 'dots') {
      ctx.fillStyle = 'rgba(255,255,255,0.25)';
      for (let i = 0; i < 4; i++) { ctx.beginPath(); ctx.arc(-s*bw*0.4+i*s*bw*0.28, 0, s*0.05, 0, Math.PI*2); ctx.fill(); }
    } else if (pt === 'neon') {
      ctx.strokeStyle = this.colors.stripe||'#ff3366'; ctx.lineWidth = s*0.1;
      ctx.shadowColor = this.colors.stripe||'#ff3366'; ctx.shadowBlur = 8;
      ctx.beginPath(); ctx.moveTo(-s*bw*0.7, 0); ctx.lineTo(s*bw*0.5, 0); ctx.stroke(); ctx.shadowBlur = 0;
      ctx.strokeStyle = this.colors.body; ctx.lineWidth = s*0.06;
      ctx.shadowColor = this.colors.body; ctx.shadowBlur = 6;
      ctx.beginPath(); ctx.moveTo(-s*bw*0.6, -s*bh*0.4); ctx.lineTo(s*bw*0.4, -s*bh*0.4); ctx.stroke(); ctx.shadowBlur = 0;
    } else if (pt === 'bands') {
      ctx.fillStyle = this.colors.stripe||'rgba(255,255,255,0.85)';
      for (let i = -1; i <= 1; i++) {
        ctx.beginPath(); ctx.ellipse(i*s*bw*0.5, 0, s*0.03, s*bh*0.9, 0, 0, Math.PI*2); ctx.fill();
      }
    } else if (pt === 'vbands') {
      ctx.fillStyle = this.colors.stripe||'rgba(0,0,0,0.3)'; ctx.globalAlpha = 0.3;
      for (let i = -1; i <= 1; i++) { ctx.beginPath(); ctx.ellipse(i*s*bw*0.4, 0, s*0.05, s*bh*0.85, 0, 0, Math.PI*2); ctx.fill(); }
      ctx.globalAlpha = 1;
    } else if (pt === 'scales') {
      ctx.strokeStyle = this.colors.stripe||'rgba(255,255,255,0.2)'; ctx.lineWidth = 0.5; ctx.globalAlpha = 0.3;
      for (let row = -1; row <= 1; row++) for (let col = -3; col <= 3; col++) { ctx.beginPath(); ctx.arc(col*s*bw*0.22, row*s*bh*0.35, s*0.07, 0, Math.PI*2); ctx.stroke(); }
      ctx.globalAlpha = 1;
    } else if (pt === 'swirl') {
      ctx.strokeStyle = this.colors.stripe||'rgba(255,100,0,0.4)'; ctx.lineWidth = 1.5; ctx.globalAlpha = 0.35;
      for (let i = 0; i < 3; i++) { ctx.beginPath(); ctx.arc((i-1)*s*bw*0.35, 0, s*bh*0.3, 0, Math.PI*1.5); ctx.stroke(); }
      ctx.globalAlpha = 1;
    } else if (pt === 'spots') {
      ctx.fillStyle = this.colors.stripe||'rgba(255,255,255,0.3)';
      const sp = [[-0.35,-0.15],[0.1,-0.2],[0.35,0.05],[-0.15,0.15],[0.0,-0.05],[-0.3,0.05],[0.25,-0.12],[0.15,0.12]];
      for (const [sx,sy] of sp) { ctx.beginPath(); ctx.arc(sx*s*bw*1.3, sy*s*bh*1.3, s*0.035, 0, Math.PI*2); ctx.fill(); }
    } else if (pt === 'eyespot') {
      ctx.fillStyle = '#1a1a2e';
      ctx.beginPath(); ctx.arc(-s*bw*0.3, -s*bh*0.15, s*0.1, 0, Math.PI*2); ctx.fill();
      ctx.fillStyle = this.colors.stripe||'#ffd700';
      ctx.beginPath(); ctx.arc(-s*bw*0.3, -s*bh*0.15, s*0.05, 0, Math.PI*2); ctx.fill();
    }
  }

  // ---------- ç›®ã®æç”»ï¼ˆã§ã‹ã‹ã‚ã„ã„ï¼‰ ----------
  drawEye(s, ex, ey) {
    // ç™½ç›®ï¼ˆå¤§ãã‚ï¼‰
    ctx.fillStyle = '#fff';
    ctx.beginPath(); ctx.arc(ex, ey, s*0.16, 0, Math.PI*2); ctx.fill();
    // é»’ç›®
    ctx.fillStyle = '#1a1a2e';
    ctx.beginPath(); ctx.arc(ex+s*0.03, ey+s*0.01, s*0.095, 0, Math.PI*2); ctx.fill();
    // ãƒã‚¤ãƒ©ã‚¤ãƒˆå¤§
    ctx.fillStyle = '#fff';
    ctx.beginPath(); ctx.arc(ex+s*0.06, ey-s*0.05, s*0.045, 0, Math.PI*2); ctx.fill();
    // ãƒã‚¤ãƒ©ã‚¤ãƒˆå°
    ctx.fillStyle = '#fff';
    ctx.beginPath(); ctx.arc(ex-s*0.01, ey+s*0.03, s*0.025, 0, Math.PI*2); ctx.fill();
  }

  // ---------- ã»ã£ãºæç”» ----------
  drawBlush(s, bx, by) {
    ctx.fillStyle = 'rgba(255,130,150,0.35)';
    ctx.beginPath(); ctx.ellipse(bx, by, s*0.09, s*0.06, 0, 0, Math.PI*2); ctx.fill();
  }
}

// ============================================================
// é­šã‚¢ã‚¤ã‚³ãƒ³ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ï¼ˆSVGãƒ™ãƒ¼ã‚¹ + hue-rotateï¼‰
// ============================================================
function fishIconHTML(typeId, size, variantType, hueShift) {
  const src = FISH_SVGS[typeId] || '';
  if (!src) return '<span style="font-size:'+size+'px">ğŸŸ</span>';
  let filter = '';
  // å¤‰ç•°ç¨®ã‚«ãƒ©ãƒ¼
  if (variantType === 'gold') filter = 'sepia(1) saturate(3) hue-rotate(10deg) brightness(1.1)';
  else if (variantType === 'albino') filter = 'saturate(0.15) brightness(1.5)';
  else if (variantType === 'neon') filter = 'saturate(2) brightness(1.3) contrast(1.1)';
  else if (variantType === 'holo') filter = 'saturate(1.5) hue-rotate('+(Date.now()%360)+'deg)';
  // ãƒ©ãƒ³ãƒ€ãƒ ã‚«ãƒ©ãƒ¼ï¼ˆhueShiftãŒæŒ‡å®šã•ã‚ŒãŸã‚‰é©ç”¨ï¼‰
  else if (hueShift) filter = 'hue-rotate('+hueShift+'deg)';
  const style = 'width:'+size+'px;height:'+size+'px;vertical-align:middle'+(filter?' ;filter:'+filter:'');
  return '<img src="'+src+'" style="'+style+'" />';
}

// ============================================================
// æ³¡ãƒ»ã‚¨ã‚µãƒ»æ°´è‰ãƒ»ãŠå®ãƒãƒ–ãƒ«
// ============================================================
class Bubble {
  constructor(x, y) { this.x = x; this.y = y||canvas.height-30; this.radius = 1+Math.random()*4; this.speed = 0.3+Math.random()*0.8; this.wobble = Math.random()*Math.PI*2; }
  update() { this.y -= this.speed; this.wobble += 0.03; this.x += Math.sin(this.wobble)*0.3; return this.y+this.radius > 0; }
  draw() {
    ctx.strokeStyle = 'rgba(180,220,255,0.4)'; ctx.lineWidth = 1;
    ctx.beginPath(); ctx.arc(this.x, this.y, this.radius, 0, Math.PI*2); ctx.stroke();
    ctx.fillStyle = 'rgba(220,240,255,0.3)';
    ctx.beginPath(); ctx.arc(this.x-this.radius*0.3, this.y-this.radius*0.3, this.radius*0.3, 0, Math.PI*2); ctx.fill();
  }
}

class TreasureBubble {
  constructor(x) {
    this.x = x; this.y = canvas.height-30;
    this.radius = 4+Math.random()*5;
    this.speed = 0.4+Math.random()*0.4;
    this.wobble = Math.random()*Math.PI*2;
    this.reward = Math.floor(3 + this.radius * 2);
  }
  update() { this.y -= this.speed; this.wobble += 0.02; this.x += Math.sin(this.wobble)*0.5; return this.y - this.radius > -5; }
  draw() {
    ctx.strokeStyle = 'rgba(255,215,0,0.6)'; ctx.lineWidth = 1.5;
    ctx.shadowColor = 'rgba(255,215,0,0.4)'; ctx.shadowBlur = 8;
    ctx.beginPath(); ctx.arc(this.x, this.y, this.radius, 0, Math.PI*2); ctx.stroke();
    ctx.fillStyle = 'rgba(255,215,0,0.15)';
    ctx.beginPath(); ctx.arc(this.x, this.y, this.radius, 0, Math.PI*2); ctx.fill();
    ctx.shadowBlur = 0;
    ctx.fillStyle = 'rgba(255,255,255,0.5)';
    ctx.beginPath(); ctx.arc(this.x-this.radius*0.3, this.y-this.radius*0.3, this.radius*0.25, 0, Math.PI*2); ctx.fill();
  }
}

class Food {
  constructor(x, y, foodType, coinRewardOverride, growAmountOverride) {
    this.x = x; this.y = y; this.foodType = foodType; this.size = foodType.size;
    this.sinkSpeed = 0.3+Math.random()*0.3; this.wobble = Math.random()*Math.PI*2; this.life = 600;
    // ãƒ¬ãƒ™ãƒ«ãƒ™ãƒ¼ã‚¹å ±é…¬ï¼ˆã‚ªãƒ¼ãƒˆãƒ•ã‚£ãƒ¼ãƒ€ãƒ¼ã¯å›ºå®šå€¤ã‚’æ¸¡ã™ï¼‰
    this.coinReward = coinRewardOverride !== undefined ? coinRewardOverride : getFoodCoinReward(foodType.id);
    this.growAmount = growAmountOverride !== undefined ? growAmountOverride : getFoodGrowAmount(foodType.id);
  }
  update() { if (this.y < canvas.height-50) { this.y += this.sinkSpeed; this.wobble += 0.04; this.x += Math.sin(this.wobble)*0.3; } this.life--; return this.life > 0; }
  draw() {
    const a = Math.min(1, this.life/60), c = this.foodType.color;
    ctx.fillStyle = `rgba(${c.r},${c.g},${c.b},${a})`;
    ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI*2); ctx.fill();
    if (this.foodType.id !== 'normal') {
      ctx.fillStyle = `rgba(255,255,255,${a*0.4})`;
      ctx.beginPath(); ctx.arc(this.x-1, this.y-1, this.size*0.4, 0, Math.PI*2); ctx.fill();
    }
    if (this.foodType.id === 'legendary') {
      ctx.shadowColor = `rgba(${c.r},${c.g},${c.b},0.6)`; ctx.shadowBlur = 8;
      ctx.fillStyle = `rgba(${c.r},${c.g},${c.b},${a*0.3})`;
      ctx.beginPath(); ctx.arc(this.x, this.y, this.size*1.5, 0, Math.PI*2); ctx.fill();
      ctx.shadowBlur = 0;
    }
  }
}

class Plant {
  constructor(x, colors, style) {
    this.x = x; this.baseY = canvas.height-20; this.phase = Math.random()*Math.PI*2;
    this.color = colors[Math.floor(Math.random()*colors.length)];
    this.style = style || 'seaweed';
    this.segments = 4+Math.floor(Math.random()*4);
    this.segmentLength = 15+Math.random()*20;
    this.width = 6+Math.random()*6;
    // ã‚µãƒ³ã‚´ç”¨
    this.branches = 2+Math.floor(Math.random()*3);
    this.coralH = 30+Math.random()*50;
    // ç†±å¸¯ç”¨
    this.leafCount = 2+Math.floor(Math.random()*3);
    this.stemH = 40+Math.random()*40;
    // ã‚¯ãƒªã‚¹ã‚¿ãƒ«ç”¨
    this.crystalH = 25+Math.random()*45;
    this.crystalW = 6+Math.random()*8;
    this.crystalAngle = (Math.random()-0.5)*0.4;
  }
  draw(time) {
    switch(this.style) {
      case 'coral': this.drawCoral(time); break;
      case 'deepsea': this.drawDeepsea(time); break;
      case 'tropical': this.drawTropical(time); break;
      case 'crystal': this.drawCrystal(time); break;
      default: this.drawSeaweed(time); break;
    }
  }

  // --- æ·¡æ°´ï¼šã‚†ã‚‰ã‚†ã‚‰æ°´è‰ ---
  drawSeaweed(time) {
    ctx.save(); ctx.lineCap = 'round';
    let px = this.x, py = this.baseY;
    for (let i = 0; i < this.segments; i++) {
      const sway = Math.sin(time*0.001+this.phase+i*0.5)*(3+i*2);
      const nx = px+sway, ny = py-this.segmentLength, ratio = 1-i/this.segments;
      ctx.strokeStyle = `rgba(${this.color.r},${this.color.g},${this.color.b},${0.6+ratio*0.4})`;
      ctx.lineWidth = this.width*ratio;
      ctx.beginPath(); ctx.moveTo(px, py); ctx.quadraticCurveTo(px+sway*0.5, (py+ny)/2, nx, ny); ctx.stroke();
      if (i%2===0 && i<this.segments-1) {
        const ld = i%4===0?1:-1;
        ctx.fillStyle = `rgba(${this.color.r+20},${this.color.g+30},${this.color.b},0.5)`;
        ctx.beginPath(); ctx.ellipse(nx+ld*10, ny+5, 12, 4, ld*0.3, 0, Math.PI*2); ctx.fill();
      }
      px = nx; py = ny;
    }
    ctx.restore();
  }

  // --- ã‚µãƒ³ã‚´ç¤ï¼šæåˆ†ã‹ã‚Œã‚µãƒ³ã‚´ ---
  drawCoral(time) {
    ctx.save();
    const {r,g,b} = this.color;
    const sway = Math.sin(time*0.0008+this.phase)*2;
    const bx = this.x, by = this.baseY;
    // å¹¹
    ctx.strokeStyle = `rgba(${r},${g},${b},0.9)`; ctx.lineCap = 'round'; ctx.lineWidth = this.width*1.2;
    ctx.beginPath(); ctx.moveTo(bx, by); ctx.lineTo(bx+sway, by-this.coralH); ctx.stroke();
    // æ
    for (let i = 0; i < this.branches; i++) {
      const t = (i+1)/(this.branches+1);
      const sy = by - this.coralH*t;
      const dir = i%2===0?1:-1;
      const branchLen = this.coralH*0.4*(1-t*0.3);
      const sw2 = Math.sin(time*0.001+this.phase+i*1.2)*1.5;
      ctx.lineWidth = this.width*(1-t*0.5);
      ctx.beginPath();
      ctx.moveTo(bx+sway*t, sy);
      ctx.quadraticCurveTo(bx+sway*t+dir*branchLen*0.5, sy-branchLen*0.3+sw2, bx+sway*t+dir*branchLen, sy-branchLen*0.6+sw2);
      ctx.stroke();
      // æå…ˆã®ä¸¸
      ctx.fillStyle = `rgba(${Math.min(r+40,255)},${Math.min(g+40,255)},${Math.min(b+40,255)},0.7)`;
      ctx.beginPath(); ctx.arc(bx+sway*t+dir*branchLen, sy-branchLen*0.6+sw2, this.width*0.6, 0, Math.PI*2); ctx.fill();
    }
    // é ‚ä¸Šã®ä¸¸
    ctx.fillStyle = `rgba(${Math.min(r+30,255)},${Math.min(g+30,255)},${Math.min(b+30,255)},0.8)`;
    ctx.beginPath(); ctx.arc(bx+sway, by-this.coralH, this.width*0.8, 0, Math.PI*2); ctx.fill();
    ctx.restore();
  }

  // --- æ·±æµ·ï¼šç™ºå…‰ãƒãƒ¥ãƒ¼ãƒ– ---
  drawDeepsea(time) {
    ctx.save();
    const {r,g,b} = this.color;
    const bx = this.x, by = this.baseY;
    const pulse = 0.4+Math.sin(time*0.002+this.phase)*0.3;
    // èŒï¼ˆæš—ã‚ï¼‰
    ctx.strokeStyle = `rgba(${r},${g},${b},0.4)`; ctx.lineCap = 'round'; ctx.lineWidth = this.width*0.6;
    const h = this.segmentLength * this.segments * 0.6;
    const sway = Math.sin(time*0.0006+this.phase)*4;
    ctx.beginPath(); ctx.moveTo(bx, by);
    ctx.quadraticCurveTo(bx+sway, by-h*0.5, bx+sway*1.5, by-h); ctx.stroke();
    // ç™ºå…‰çƒï¼ˆå…ˆç«¯ï¼‰
    ctx.shadowColor = `rgba(${r+60},${g+60},${b+60},${pulse})`;
    ctx.shadowBlur = 15;
    ctx.fillStyle = `rgba(${Math.min(r+80,255)},${Math.min(g+80,255)},${Math.min(b+80,255)},${pulse+0.2})`;
    ctx.beginPath(); ctx.arc(bx+sway*1.5, by-h, 5+this.width*0.5, 0, Math.PI*2); ctx.fill();
    ctx.shadowBlur = 0;
    // å°ã•ãªå…‰ã®ç²’ï¼ˆé€”ä¸­ï¼‰
    for (let i = 1; i <= 2; i++) {
      const t = i*0.3;
      const px = bx+sway*t, py = by-h*t;
      const p2 = 0.3+Math.sin(time*0.003+this.phase+i*2)*0.2;
      ctx.fillStyle = `rgba(${Math.min(r+60,255)},${Math.min(g+60,255)},${Math.min(b+60,255)},${p2})`;
      ctx.beginPath(); ctx.arc(px, py, 2+this.width*0.2, 0, Math.PI*2); ctx.fill();
    }
    ctx.restore();
  }

  // --- ç†±å¸¯æ²³å·ï¼šå¤§ããªè‘‰ã£ã± ---
  drawTropical(time) {
    ctx.save();
    const {r,g,b} = this.color;
    const bx = this.x, by = this.baseY;
    const sway = Math.sin(time*0.0007+this.phase)*3;
    // èŒ
    ctx.strokeStyle = `rgba(${Math.max(r-20,0)},${Math.max(g-20,0)},${Math.max(b-20,0)},0.8)`;
    ctx.lineCap = 'round'; ctx.lineWidth = 3;
    ctx.beginPath(); ctx.moveTo(bx, by); ctx.lineTo(bx+sway*0.5, by-this.stemH); ctx.stroke();
    // è‘‰ã£ã±
    for (let i = 0; i < this.leafCount; i++) {
      const t = (i+1)/(this.leafCount+1);
      const ly = by - this.stemH*t;
      const dir = i%2===0?1:-1;
      const sw = Math.sin(time*0.001+this.phase+i)*2;
      const leafW = 18+this.width*1.5;
      const leafH = 8+this.width*0.5;
      ctx.save();
      ctx.translate(bx+sway*t*0.5, ly);
      ctx.rotate(dir*0.4+sw*0.05);
      // è‘‰æœ¬ä½“
      ctx.fillStyle = `rgba(${r},${g},${b},0.7)`;
      ctx.beginPath();
      ctx.moveTo(0, 0);
      ctx.bezierCurveTo(dir*leafW*0.3, -leafH, dir*leafW*0.7, -leafH*0.8, dir*leafW, 0);
      ctx.bezierCurveTo(dir*leafW*0.7, leafH*0.5, dir*leafW*0.3, leafH*0.3, 0, 0);
      ctx.fill();
      // è‘‰è„ˆ
      ctx.strokeStyle = `rgba(${Math.min(r+30,255)},${Math.min(g+30,255)},${Math.min(b+30,255)},0.4)`;
      ctx.lineWidth = 1;
      ctx.beginPath(); ctx.moveTo(0, 0); ctx.lineTo(dir*leafW*0.85, 0); ctx.stroke();
      ctx.restore();
    }
    // å…ˆç«¯ã®å°ã•ãªè‘‰
    ctx.fillStyle = `rgba(${r+10},${Math.min(g+20,255)},${b},0.6)`;
    ctx.beginPath();
    ctx.ellipse(bx+sway*0.5, by-this.stemH, 6, 10, sway*0.02, 0, Math.PI*2); ctx.fill();
    ctx.restore();
  }

  // --- ç¥ç§˜ã®æ³‰ï¼šå…‰ã‚‹ã‚¯ãƒªã‚¹ã‚¿ãƒ« ---
  drawCrystal(time) {
    ctx.save();
    const {r,g,b} = this.color;
    const bx = this.x, by = this.baseY;
    const pulse = 0.5+Math.sin(time*0.0015+this.phase)*0.3;
    // ã‚°ãƒ­ãƒ¼
    ctx.shadowColor = `rgba(${r},${g},${b},${pulse*0.5})`;
    ctx.shadowBlur = 12;
    // ã‚¯ãƒªã‚¹ã‚¿ãƒ«æœ¬ä½“
    ctx.save();
    ctx.translate(bx, by);
    ctx.rotate(this.crystalAngle);
    const w = this.crystalW, h = this.crystalH;
    ctx.fillStyle = `rgba(${r},${g},${b},${0.4+pulse*0.3})`;
    ctx.beginPath();
    ctx.moveTo(0, 0);
    ctx.lineTo(-w, -h*0.3);
    ctx.lineTo(-w*0.5, -h);
    ctx.lineTo(w*0.5, -h);
    ctx.lineTo(w, -h*0.3);
    ctx.closePath();
    ctx.fill();
    // ãƒã‚¤ãƒ©ã‚¤ãƒˆ
    ctx.fillStyle = `rgba(255,255,255,${0.15+pulse*0.15})`;
    ctx.beginPath();
    ctx.moveTo(-w*0.2, -h*0.2);
    ctx.lineTo(-w*0.5, -h*0.8);
    ctx.lineTo(0, -h*0.9);
    ctx.lineTo(w*0.1, -h*0.3);
    ctx.closePath();
    ctx.fill();
    ctx.restore();
    ctx.shadowBlur = 0;
    // å°ã•ãªå…‰ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«
    const sp = Math.sin(time*0.003+this.phase);
    ctx.fillStyle = `rgba(${Math.min(r+80,255)},${Math.min(g+80,255)},${Math.min(b+80,255)},${0.2+sp*0.2})`;
    ctx.beginPath(); ctx.arc(bx+sp*3, by-h*0.7+Math.cos(time*0.002+this.phase)*3, 2, 0, Math.PI*2); ctx.fill();
    ctx.restore();
  }
}

// ============================================================
// åˆæœŸåŒ–
// ============================================================
function initEnvironment() {
  const area = getCurrentArea();
  const sr = area.sandRGB;
  plants = [];
  const pCount = area.plantStyle==='coral'?10 : area.plantStyle==='crystal'?12 : 8;
  for (let i = 0; i < pCount; i++) plants.push(new Plant(30+(canvas.width-60)*(i/(pCount-1))+(Math.random()-0.5)*40, area.plantColors, area.plantStyle));
  sandParticles = [];
  for (let i = 0; i < 80; i++) sandParticles.push({
    x: Math.random()*canvas.width, y: canvas.height-25+Math.random()*25, size: 1+Math.random()*2,
    color: `rgba(${sr[0]+Math.random()*55},${sr[1]+Math.random()*50},${sr[2]+Math.random()*60},${0.3+Math.random()*0.4})`
  });
  // ã‚¨ãƒªã‚¢ã‚¹ãƒ†ãƒ¼ãƒˆã«ä¿å­˜
  areaStates[currentAreaId].plants = plants;
  areaStates[currentAreaId].sandParticles = sandParticles;
}

function firstInit() {
  initCollection();
  const loaded = loadGame();
  initEnvironment();
  if (!loaded) {
    for (let i = 0; i < 5; i++) { const f = new Fish('common'); fishes.push(f); discoverFish('common', null, f.hueShift); }
    areaStates[currentAreaId].fishes = fishes;
  }
  buildFoodSelector();
  buildAreaTabs();
  updateCoinDisplay();
  updateIncomeDisplay();
  updateBubblerBtn();
}

// ============================================================
// ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ï¼ˆãƒ›ãƒãƒ¼ï¼‰
// ============================================================
const tooltip = document.getElementById('fishTooltip');
const ttName = document.getElementById('ttName');
const ttGreeting = document.getElementById('ttGreeting');
const ttStats = document.getElementById('ttStats');

canvas.addEventListener('mousemove', e => {
  const rect = canvas.getBoundingClientRect();
  mouseX = e.clientX - rect.left;
  mouseY = e.clientY - rect.top;
});
canvas.addEventListener('mouseleave', () => { mouseX = -999; mouseY = -999; });

function updateTooltip() {
  let closest = null, closestDist = Infinity;
  for (const f of fishes) {
    const d = Math.hypot(f.x - mouseX, f.y - mouseY);
    if (d < f.size * 1.8 && d < closestDist) { closest = f; closestDist = d; }
  }

  if (closest) {
    hoveredFish = closest;
    let nameText = closest.type.name;
    if (closest.isVariant && closest.variantType) {
      const vt = VARIANT_TYPES.find(v => v.id === closest.variantType);
      if (vt) nameText += ' ' + vt.suffix;
    }
    const ttKey = closest.typeId + '_' + closest.hueShift + (closest.isVariant ? '_' + closest.variantType : '');
    if (ttName._lastKey !== ttKey) {
      ttName.innerHTML = fishIconHTML(closest.typeId, 22, closest.isVariant ? closest.variantType : null, closest.hueShift) + ' ' + nameText;
      ttName._lastKey = ttKey;
    }
    ttGreeting.textContent = closest.type.greeting;
    const sizePercent = Math.round((closest.size / closest.baseSize) * 100);
    let sizeLabel = 'ã‚µã‚¤ã‚º: ' + sizePercent + '%';
    if (sizePercent >= 250) sizeLabel += ' âš ï¸ ã‚‚ã†ã™ããŠåˆ¥ã‚Œâ€¦';
    else if (sizePercent >= 200) sizeLabel += ' ğŸ’¦ ã ã„ã¶å¤§ãã„ï¼';
    const incomeVal = closest.getPassiveIncome();
    ttStats.textContent = 'åå…¥: ' + incomeVal + 'ğŸª™/10ç§’' + (closest.isVariant ? ' (ãƒ¬ã‚¢2.5å€!)' : '') + ' ãƒ» ' + sizeLabel;

    const rect = canvas.getBoundingClientRect();
    const wrapRect = tankWrapper.getBoundingClientRect();
    let tx = closest.x + 20;
    let ty = closest.y - 50;
    // Keep tooltip in bounds
    if (tx + 200 > canvas.width) tx = closest.x - 180;
    if (ty < 10) ty = closest.y + 20;
    tooltip.style.left = (tx + (rect.left - wrapRect.left)) + 'px';
    tooltip.style.top = (ty + (rect.top - wrapRect.top)) + 'px';
    tooltip.classList.add('visible');
  } else {
    hoveredFish = null;
    tooltip.classList.remove('visible');
  }
}

// ============================================================
// ã‚¨ã‚µé¸æŠ UI
// ============================================================
function buildFoodSelector() {
  const c = document.getElementById('foodSelector');
  c.innerHTML = '<span>ã‚¨ã‚µé¸æŠ:</span>';
  for (const ft of FOOD_TYPES) {
    const lv = getFoodLevel(ft.id);
    const locked = lv <= 0;
    const btn = document.createElement('button');
    btn.className = 'food-btn'+(ft.id===selectedFoodId?' active':'')+(locked?' locked':'');
    btn.textContent = ft.icon+' '+ft.name+(lv>0?' Lv'+lv:' ğŸ”’');
    btn.onclick = () => { if (locked) return; selectedFoodId = ft.id; document.querySelectorAll('.food-btn').forEach(b=>b.classList.remove('active')); btn.classList.add('active'); };
    c.appendChild(btn);
  }
}

// ============================================================
// ã‚·ãƒ§ãƒƒãƒ—
// ============================================================
function openShop() { document.getElementById('shopOverlay').classList.add('open'); renderShop(); }
function closeShop() { document.getElementById('shopOverlay').classList.remove('open'); }

function renderShop() {
  document.getElementById('shopCoins').textContent = 'ğŸª™ '+coins.toLocaleString();
  const c = document.getElementById('shopContents');
  c.innerHTML = '';
  function sec(title) { const t = document.createElement('div'); t.className = 'shop-section-title'; t.textContent = title; c.appendChild(t); }
  function row(icon, name, desc) { const item = document.createElement('div'); item.className = 'shop-item'; item.innerHTML = '<div class="shop-item-icon">'+icon+'</div><div class="shop-item-info"><div class="shop-item-name">'+name+'</div><div class="shop-item-desc">'+desc+'</div></div>'; return item; }

  // 1. ã‚¨ãƒªã‚¢è§£æ”¾
  sec('ğŸ—ºï¸ ã‚¨ãƒªã‚¢è§£æ”¾');
  for (const a of AREAS) {
    if (a.price === 0) continue;
    const item = row(a.icon, a.name, a.desc);
    const btn = document.createElement('button'); btn.className = 'shop-buy-btn';
    if (a.unlocked) { btn.textContent = 'âœ“ è§£æ”¾æ¸ˆã¿'; btn.className += ' owned'; btn.disabled = true; }
    else { btn.textContent = 'ğŸª™ '+a.price.toLocaleString(); btn.disabled = coins<a.price; btn.onclick = () => { if (spendCoins(a.price)) { a.unlocked = true; renderShop(); buildAreaTabs(); showNotification(a.name+'ã‚¨ãƒªã‚¢ãŒè§£æ”¾ã•ã‚ŒãŸï¼'); } }; }
    item.appendChild(btn); c.appendChild(item);
  }

  // 2. è¨­å‚™
  sec('ğŸ”§ è¨­å‚™');
  for (const up of UPGRADES) {
    const item = row(up.icon, up.name, up.desc);
    const btn = document.createElement('button'); btn.className = 'shop-buy-btn';
    if (up.owned) { btn.textContent = 'âœ“ è³¼å…¥æ¸ˆã¿'; btn.className += ' owned'; btn.disabled = true; }
    else { btn.textContent = 'ğŸª™ '+up.price.toLocaleString(); btn.disabled = coins<up.price; btn.onclick = () => { if (spendCoins(up.price)) { up.owned = true; renderShop(); showNotification(up.name+'ã‚’è³¼å…¥ã—ãŸï¼'); } }; }
    item.appendChild(btn); c.appendChild(item);
  }

  // 3. ã‚¨ã‚µãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—
  sec('ğŸ ã‚¨ã‚µãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—');
  for (const ft of FOOD_TYPES) {
    const lv = getFoodLevel(ft.id);
    const lvText = lv === 0 ? 'æœªè§£æ”¾' : 'Lv.'+lv+(lv>=10?' MAX':'');
    const reward = lv > 0 ? getFoodCoinReward(ft.id).toFixed(1) : ft.baseCoinReward;
    const grow = lv > 0 ? getFoodGrowAmount(ft.id).toFixed(2) : ft.baseGrowAmount.toFixed(2);
    const item = row(ft.icon, ft.name+' ('+lvText+')', 'å ±é…¬:'+reward+'ğŸª™ æˆé•·:'+grow+' ãƒ» '+ft.desc);
    const btn = document.createElement('button'); btn.className = 'shop-buy-btn';
    if (lv >= 10) { btn.textContent = 'MAX'; btn.className += ' owned'; btn.disabled = true; }
    else {
      const cost = getFoodUpgradeCost(ft.id);
      btn.textContent = (lv===0?'ğŸ”“è§£æ”¾ ':'â¬†Lv'+(lv+1)+' ')+'ğŸª™ '+cost.toLocaleString();
      btn.disabled = coins<cost;
      btn.onclick = () => { if (spendCoins(cost)) { foodLevels[ft.id]=(lv||0)+1; if(lv===0) selectedFoodId=ft.id; renderShop(); buildFoodSelector(); showNotification(ft.name+' Lv.'+(lv+1)+'ã«ï¼'); } };
    }
    item.appendChild(btn); c.appendChild(item);
  }

  // 4. ã‚ªãƒ¼ãƒˆãƒ•ã‚£ãƒ¼ãƒ€ãƒ¼
  sec('ğŸ¤– ã‚ªãƒ¼ãƒˆãƒ•ã‚£ãƒ¼ãƒ€ãƒ¼');
  const afLv = autoFeederLevel;
  const afText = afLv===0?'æœªè³¼å…¥':'Lv.'+afLv+(afLv>=10?' MAX':'');
  const afFood = afLv>0?getAutoFeederFoodType().name:'-';
  const afInt = afLv>0?(getAutoFeederInterval()/60).toFixed(1)+'ç§’':'-';
  const afCnt = afLv>0?getAutoFeederFoodCount()+'å€‹':'-';
  const afItem = row('ğŸ¤–', 'ã‚ªãƒ¼ãƒˆãƒ•ã‚£ãƒ¼ãƒ€ãƒ¼ ('+afText+')', 'ã‚¨ã‚µ:'+afFood+' é–“éš”:'+afInt+' æ•°:'+afCnt);
  const afBtn = document.createElement('button'); afBtn.className = 'shop-buy-btn';
  if (afLv >= 10) { afBtn.textContent = 'MAX'; afBtn.className += ' owned'; afBtn.disabled = true; }
  else {
    const cost = getAutoFeederUpgradeCost();
    afBtn.textContent = (afLv===0?'ğŸ”“è³¼å…¥ ':'â¬†Lv'+(afLv+1)+' ')+'ğŸª™ '+cost.toLocaleString();
    afBtn.disabled = coins<cost;
    afBtn.onclick = () => { if (spendCoins(cost)) { autoFeederLevel++; renderShop(); showNotification('ã‚ªãƒ¼ãƒˆãƒ•ã‚£ãƒ¼ãƒ€ãƒ¼ Lv.'+autoFeederLevel+'ã«ï¼'); } };
  }
  afItem.appendChild(afBtn); c.appendChild(afItem);

  // 5. é­šã‚’è³¼å…¥ï¼ˆç¾åœ¨ã®ã‚¨ãƒªã‚¢é™å®šï¼‰
  const curArea = AREAS.find(a => a.id === currentAreaId);
  sec('ğŸŸ é­šã‚’è³¼å…¥ï¼ˆ'+curArea.icon+' '+curArea.name+'ï¼‰');
  const sortedFish = [...FISH_TYPES].filter(f => f.area === currentAreaId).sort((a,b) => a.shopPrice - b.shopPrice);
  for (const ft of sortedFish) {
    const item = row(fishIconHTML(ft.id, 32), ft.name, ft.desc+' ãƒ» åå…¥'+ft.passiveIncome+'ğŸª™/10ç§’');
    const btn = document.createElement('button'); btn.className = 'shop-buy-btn';
    if (ft.shopPrice === 0) {
      btn.textContent = 'ğŸª™ ç„¡æ–™';
      btn.onclick = () => { const f=new Fish(ft.id); fishes.push(f); discoverFish(ft.id, null, f.hueShift); renderShop(); updateIncomeDisplay(); buildAreaTabs(); showNotification(ft.name+'ãŒä»²é–“ã«ï¼'); };
    } else {
      btn.textContent = 'ğŸª™ '+ft.shopPrice.toLocaleString(); btn.disabled = coins<ft.shopPrice;
      btn.onclick = () => { if (spendCoins(ft.shopPrice)) { ft.unlocked=true; const f=new Fish(ft.id); fishes.push(f); discoverFish(ft.id, null, f.hueShift); renderShop(); updateIncomeDisplay(); buildAreaTabs(); showNotification(ft.name+'ãŒä»²é–“ã«ï¼'); } };
    }
    item.appendChild(btn); c.appendChild(item);
  }

  // 6. ã‚¬ãƒãƒ£
  const curAreaName = curArea.icon + ' ' + curArea.name;
  sec('ğŸ° ã‚¬ãƒãƒ£ï¼ˆ'+curAreaName+'ã®ãƒ¬ã‚¢é­šãƒãƒ£ãƒ³ã‚¹ï¼ï¼‰');
  for (const g of GACHA_TIERS) {
    const item = row(g.icon, g.name, g.desc + 'ãƒ»' + curArea.name + 'ã®é­šãŒå‡ºã‚‹');
    const btnWrap = document.createElement('div');
    btnWrap.style.cssText = 'display:flex;gap:4px;flex-wrap:wrap;';
    for (const n of [1, 5, 10]) {
      const total = g.cost * n;
      const btn = document.createElement('button'); btn.className = 'shop-buy-btn';
      btn.style.cssText = 'font-size:0.75rem;padding:4px 8px;';
      btn.textContent = (n===1?'':'') + n + 'é€£ ğŸª™' + total.toLocaleString();
      btn.disabled = coins < total;
      btn.onclick = () => { if (spendCoins(total)) performMultiGacha(g, n); };
      btnWrap.appendChild(btn);
    }
    item.appendChild(btnWrap); c.appendChild(item);
  }
}

// ã‚¬ãƒãƒ£æŠ½é¸ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆå…±é€šï¼‰
function rollGacha(gacha) {
  const pool = FISH_TYPES.filter(f => f.area === currentAreaId);
  const weights = pool.map(f => 1/Math.sqrt(Math.max(f.shopPrice,1)));
  const totalW = weights.reduce((a,b) => a+b, 0);
  let r = Math.random() * totalW, chosen = pool[0];
  for (let i=0; i<pool.length; i++) { r -= weights[i]; if (r<=0) { chosen=pool[i]; break; } }
  const isVariant = Math.random() < gacha.variantChance;
  let variantType = null;
  if (isVariant) variantType = VARIANT_TYPES[Math.floor(Math.random()*VARIANT_TYPES.length)].id;
  const fish = new Fish(chosen.id, undefined, undefined, isVariant, variantType);
  fishes.push(fish); chosen.unlocked = true;
  discoverFish(chosen.id, variantType, fish.hueShift);
  return { fishType: chosen, isVariant, variantType, fish };
}

// ã‚¬ãƒãƒ£æ¼”å‡ºã®çŠ¶æ…‹ç®¡ç†
let gachaAnimating = false;
let gachaSkipRequested = false;
let gachaQueue = []; // è¤‡æ•°é€£ã®æ®‹ã‚Šã‚­ãƒ¥ãƒ¼
let gachaAllResults = []; // è¤‡æ•°é€£ã®ã¾ã¨ã‚ç”¨
let gachaCurrentGacha = null;

function gachaSleep(ms) {
  return new Promise(resolve => {
    const t = setTimeout(resolve, ms);
    const check = setInterval(() => {
      if (gachaSkipRequested) { clearTimeout(t); clearInterval(check); resolve(); }
    }, 50);
  });
}

function performGacha(gacha) {
  const result = rollGacha(gacha);
  updateIncomeDisplay(); buildAreaTabs(); renderShop();
  gachaQueue = [result];
  gachaAllResults = [result];
  gachaCurrentGacha = gacha;
  runGachaSequence(false);
}

function performMultiGacha(gacha, count) {
  if (count === 1) { performGacha(gacha); return; }
  const results = [];
  for (let i = 0; i < count; i++) results.push(rollGacha(gacha));
  updateIncomeDisplay(); buildAreaTabs(); renderShop();
  gachaQueue = results.slice();
  gachaAllResults = results.slice();
  gachaCurrentGacha = gacha;
  runGachaSequence(true);
}

async function runGachaSequence(isMulti) {
  gachaAnimating = true;
  gachaSkipRequested = false;

  const doors = document.getElementById('gachaDoors');
  const pillar = document.getElementById('gachaPillar');
  const crack = document.getElementById('gachaCrack');
  const flash = document.getElementById('gachaFlash');
  const overlay = document.getElementById('gachaOverlay');
  const counter = document.getElementById('gachaCounter');
  const skipHint = document.getElementById('gachaSkipHint');

  // ã‚¿ãƒƒãƒ—ã§ã‚¹ã‚­ãƒƒãƒ—
  function onTap() { gachaSkipRequested = true; }
  document.addEventListener('click', onTap, { once: false });

  for (let idx = 0; idx < gachaQueue.length; idx++) {
    const result = gachaQueue[idx];
    gachaSkipRequested = false;

    // ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼è¡¨ç¤ºï¼ˆè¤‡æ•°é€£ï¼‰
    if (isMulti) {
      counter.style.display = 'block';
      counter.textContent = (idx+1) + ' / ' + gachaQueue.length;
    }

    // ã‚¹ã‚­ãƒƒãƒ—ãƒ’ãƒ³ãƒˆ
    skipHint.classList.add('show');

    // === Phase 1: æ‰‰é–‰ã˜ ===
    doors.style.display = 'flex';
    doors.classList.remove('open');
    await gachaSleep(100);

    // === Phase 2: æ‰‰ã®éš™é–“ã‹ã‚‰å…‰ ===
    await gachaSleep(gachaSkipRequested ? 0 : 600);

    // === Phase 3: ãƒ¬ã‚¢åˆ¤å®šã§æ¼”å‡ºåˆ†å² ===
    if (result.isVariant && !gachaSkipRequested) {
      // ç”»é¢å‰²ã‚Œæ¼”å‡º
      crack.classList.add('active');
      await gachaSleep(400);
      // è™¹è‰²ã®æŸ±
      pillar.className = 'gacha-pillar active rare';
      await gachaSleep(500);
      crack.classList.remove('active');
    } else if (!gachaSkipRequested) {
      // é€šå¸¸ã®å…‰ã®æŸ±
      pillar.className = 'gacha-pillar active';
      await gachaSleep(400);
    }

    // === Phase 4: æ‰‰ã‚ªãƒ¼ãƒ—ãƒ³ ===
    doors.classList.add('open');
    await gachaSleep(gachaSkipRequested ? 0 : 500);

    // === Phase 5: ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ ===
    flash.classList.add('active');
    await gachaSleep(gachaSkipRequested ? 50 : 120);
    flash.classList.remove('active');

    // === Phase 6: ã‚«ãƒ¼ãƒ‰é™è‡¨ ===
    showGachaCard(result);
    await gachaSleep(gachaSkipRequested ? 50 : 100);
    overlay.classList.add('reveal');

    // ç´™å¹é›ª
    spawnConfetti(overlay, result.isVariant);

    // === å¾…æ©Ÿï¼ˆã‚¿ãƒƒãƒ—ã§æ¬¡ã¸ï¼‰ ===
    pillar.className = 'gacha-pillar';
    skipHint.classList.remove('show');

    // ã‚¿ãƒƒãƒ—å¾…ã¡
    gachaSkipRequested = false;
    await new Promise(resolve => {
      function handler() {
        document.removeEventListener('click', handler);
        resolve();
      }
      // å°‘ã—é…å»¶ã—ã¦ã‹ã‚‰ã‚¯ãƒªãƒƒã‚¯å—ä»˜ï¼ˆèª¤ã‚¿ãƒƒãƒ—é˜²æ­¢ï¼‰
      setTimeout(() => document.addEventListener('click', handler, { once: true }), 300);
    });

    // ã‚«ãƒ¼ãƒ‰ã‚’é–‰ã˜ã‚‹
    overlay.classList.remove('open', 'reveal');
    overlay.querySelectorAll('.gacha-confetti').forEach(e => e.remove());
    doors.style.display = 'none';

    await gachaSleep(150);
  }

  // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
  document.removeEventListener('click', onTap);
  counter.style.display = 'none';
  skipHint.classList.remove('show');
  doors.style.display = 'none';
  doors.classList.remove('open');
  pillar.className = 'gacha-pillar';
  gachaAnimating = false;

  // è¤‡æ•°é€£ãªã‚‰ã¾ã¨ã‚è¡¨ç¤º
  if (isMulti && gachaAllResults.length > 1) {
    await gachaSleep(200);
    showMultiSummary();
  }
}

function showGachaCard(result) {
  const overlay = document.getElementById('gachaOverlay');
  const glow = document.getElementById('gachaGlow');
  const rays = document.getElementById('gachaRays');
  const icon = document.getElementById('gachaIcon');
  const label = document.getElementById('gachaLabel');
  const nameEl = document.getElementById('gachaName');
  const badgeEl = document.getElementById('gachaBadge');
  const incomeEl = document.getElementById('gachaIncome');

  // ãƒªã‚»ãƒƒãƒˆ
  overlay.classList.remove('reveal');
  glow.className = 'gacha-glow';
  rays.className = 'gacha-rays';
  icon.className = 'gacha-icon';
  nameEl.className = 'gacha-name';
  label.className = 'gacha-label';
  badgeEl.innerHTML = '';
  overlay.querySelectorAll('.gacha-confetti').forEach(e => e.remove());

  // æ”¾å°„å…‰ç·šã‚’ç”Ÿæˆ
  rays.innerHTML = '';
  const rayCount = result.isVariant ? 16 : 10;
  for (let i = 0; i < rayCount; i++) {
    const ray = document.createElement('div');
    ray.className = 'gacha-ray';
    ray.style.setProperty('--r', (i * (360/rayCount)) + 'deg');
    rays.appendChild(ray);
  }
  if (result.isVariant) rays.classList.add('rare');

  // ã‚¢ã‚¤ã‚³ãƒ³
  icon.innerHTML = fishIconHTML(result.fishType.id, 110, result.variantType, result.fish.hueShift);

  // ãƒ©ãƒ™ãƒ«
  const vt = result.isVariant ? VARIANT_TYPES.find(v => v.id === result.variantType) : null;
  if (result.isVariant) {
    label.textContent = 'âœ¨ RARE âœ¨';
    label.classList.add('rare');
  } else {
    label.textContent = 'GET!';
  }

  // åå‰
  const fullName = result.fishType.name + (vt ? ' ' + vt.suffix : '');
  nameEl.textContent = fullName;

  if (result.isVariant) {
    glow.classList.add('rare');
    icon.classList.add('rare');
    nameEl.classList.add('rare');
    const badge = document.createElement('div');
    badge.className = 'gacha-variant-badge ' + result.variantType;
    badge.textContent = vt.name + ' å¤‰ç•°ç¨®ï¼ åå…¥2.5å€';
    badgeEl.appendChild(badge);
  }

  const income = result.fish.getPassiveIncome();
  incomeEl.textContent = 'ğŸ’° è‡ªå‹•åå…¥ +' + income + 'ğŸª™/10ç§’';

  overlay.classList.add('open');
}

function spawnConfetti(container, isRare) {
  const count = isRare ? 50 : 18;
  const colors = isRare
    ? ['#ffd700','#ff6f00','#ffeb3b','#ff5722','#e040fb','#00e5ff','#76ff03','#fff']
    : ['#7ec8e3','#ffd700','#6bcb77','#ff8a80','#b388ff'];
  for (let i = 0; i < count; i++) {
    setTimeout(() => {
      const conf = document.createElement('div');
      conf.className = 'gacha-confetti';
      conf.style.left = (10 + Math.random()*80) + '%';
      conf.style.top = (5 + Math.random()*15) + '%';
      conf.style.background = colors[Math.floor(Math.random()*colors.length)];
      conf.style.width = (4+Math.random()*10) + 'px';
      conf.style.height = (4+Math.random()*10) + 'px';
      conf.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
      conf.style.animationDuration = (1.5+Math.random()*2.5) + 's';
      container.appendChild(conf);
      setTimeout(() => conf.remove(), 4500);
    }, Math.random() * 800);
  }
}

function showMultiSummary() {
  const overlay = document.getElementById('gachaMultiOverlay');
  const title = document.getElementById('gachaMultiTitle');
  const grid = document.getElementById('gachaMultiGrid');
  const gacha = gachaCurrentGacha;
  const results = gachaAllResults;
  const rareCount = results.filter(r => r.isVariant).length;
  title.textContent = gacha.icon + ' ' + gacha.name + ' ' + results.length + 'é€£çµæœ' + (rareCount > 0 ? '  âœ¨ãƒ¬ã‚¢'+rareCount+'ä½“ï¼' : '');
  grid.innerHTML = '';
  results.forEach((r, i) => {
    const card = document.createElement('div');
    card.className = 'gacha-multi-card';
    card.style.animationDelay = (i * 0.08) + 's';
    const isRare = r.isVariant;
    card.style.cssText += ';background:' + (isRare ? 'linear-gradient(135deg,rgba(255,215,0,0.15),rgba(255,100,0,0.15))' : 'rgba(126,200,227,0.08)') + ';border-radius:10px;padding:10px;text-align:center;border:1px solid ' + (isRare ? 'rgba(255,215,0,0.4)' : 'rgba(126,200,227,0.15)') + ';';
    const vt = r.isVariant ? VARIANT_TYPES.find(v => v.id === r.variantType) : null;
    const name = r.fishType.name + (vt ? ' ' + vt.suffix : '');
    const income = r.fish.getPassiveIncome();
    card.innerHTML = '<div style="margin-bottom:6px;">' + fishIconHTML(r.fishType.id, 56, r.variantType, r.fish.hueShift) + '</div>'
      + (isRare ? '<div style="font-size:0.65rem;color:#ffd700;font-weight:bold;margin-bottom:2px;">âœ¨ ' + vt.name + '</div>' : '')
      + '<div style="font-size:0.8rem;color:#fff;font-weight:bold;">' + name + '</div>'
      + '<div style="font-size:0.7rem;color:rgba(255,255,255,0.5);margin-top:2px;">+' + income + 'ğŸª™/10ç§’</div>';
    grid.appendChild(card);
  });
  overlay.classList.add('open');
}

function closeMultiGacha(e) {
  if (e.target.id === 'gachaMultiOverlay') {
    document.getElementById('gachaMultiOverlay').classList.remove('open');
  }
}

function closeGachaResult() {
  // æ—§é–¢æ•°ï¼ˆäº’æ›ç”¨ï¼‰- æ–°ã—ã„æ¼”å‡ºã§ã¯ä½¿ã‚ãªã„
}

document.getElementById('shopOverlay').addEventListener('click', e => { if (e.target.id === 'shopOverlay') closeShop(); });
document.getElementById('collectionOverlay').addEventListener('click', e => { if (e.target.id === 'collectionOverlay') closeCollection(); });

// ============================================================
// ğŸ“– å›³é‘‘UI
// ============================================================
function openCollection() { document.getElementById('collectionOverlay').classList.add('open'); renderCollection(); }
function closeCollection() { document.getElementById('collectionOverlay').classList.remove('open'); }

function renderCollection() {
  const comp = getCollectionCompletion();
  const progEl = document.getElementById('collectionProgress');
  progEl.innerHTML = comp.discovered+' / '+comp.total+' ç™ºè¦‹ ('+comp.percent+'%)<div style="width:200px;height:8px;background:rgba(126,200,227,0.1);border-radius:4px;margin:6px auto;overflow:hidden"><div style="height:100%;width:'+comp.percent+'%;background:linear-gradient(90deg,#7ec8e3,#ffd700);border-radius:4px;transition:width 0.5s"></div></div>';

  const grid = document.getElementById('collectionGrid');
  grid.innerHTML = '';
  for (const ft of FISH_TYPES) {
    const disc = collection[ft.id]?.discovered;
    const entry = document.createElement('div');
    entry.style.cssText = 'background:rgba(126,200,227,0.04);border:1px solid rgba(126,200,227,'+(disc?'0.2':'0.06')+');border-radius:10px;padding:8px 4px;text-align:center;cursor:pointer;transition:all 0.2s;'+(disc?'':'opacity:0.3;filter:grayscale(1);');
    entry.onmouseover = () => { entry.style.background='rgba(126,200,227,0.12)'; };
    entry.onmouseout = () => { entry.style.background='rgba(126,200,227,0.04)'; };
    if (disc) entry.onclick = () => openFishDetail(ft.id);
    // ã‚¢ã‚¤ã‚³ãƒ³
    const iconDiv = document.createElement('div');
    iconDiv.style.fontSize = '1.5rem';
    if (disc) iconDiv.innerHTML = fishIconHTML(ft.id, 36);
    else iconDiv.textContent = 'â“';
    entry.appendChild(iconDiv);
    // åå‰
    const nameDiv = document.createElement('div');
    nameDiv.style.cssText = 'font-size:0.6rem;color:#cde4f0;margin-top:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis';
    nameDiv.textContent = disc ? ft.name : 'ï¼Ÿï¼Ÿï¼Ÿ';
    entry.appendChild(nameDiv);
    // å¤‰ç•°ç¨®ãƒ‰ãƒƒãƒˆ
    const dotsDiv = document.createElement('div');
    dotsDiv.style.cssText = 'display:flex;justify-content:center;gap:3px;margin-top:4px';
    const dotColors = { gold:'#ffd700', albino:'#fff5f5', neon:'#00ffc8', holo:'linear-gradient(135deg,#f00,#0f0,#00f)' };
    for (const vt of VARIANT_TYPES) {
      const dot = document.createElement('div');
      const vDisc = collection[ft.id]?.variantDiscovered?.[vt.id];
      dot.style.cssText = 'width:8px;height:8px;border-radius:50%;border:1px solid rgba(255,255,255,0.15);';
      if (vDisc) dot.style.background = dotColors[vt.id];
      else dot.style.background = 'rgba(100,100,100,0.25)';
      dot.title = vt.name + (vDisc ? ' (ç™ºè¦‹æ¸ˆã¿)' : ' (æœªç™ºè¦‹)');
      dotsDiv.appendChild(dot);
    }
    entry.appendChild(dotsDiv);
    // åå…¥è¡¨ç¤º
    if (disc) {
      const incDiv = document.createElement('div');
      incDiv.style.cssText = 'font-size:0.55rem;color:rgba(126,200,227,0.5);margin-top:2px';
      incDiv.textContent = ft.passiveIncome+'ğŸª™/10ç§’';
      entry.appendChild(incDiv);
    }
    grid.appendChild(entry);
  }
}

// --- å›³é‘‘ é­šè©³ç´° ---
function openFishDetail(fishId) {
  const ft = FISH_TYPES.find(t => t.id === fishId);
  if (!ft) return;
  const col = collection[fishId] || {};
  const area = AREAS.find(a => a.id === ft.area);
  const hueShifts = col.hueShifts || [];
  const panel = document.getElementById('fishDetailPanel');

  let html = '<div style="text-align:center;padding:8px 0">';
  // ãƒ¡ã‚¤ãƒ³ã‚¢ã‚¤ã‚³ãƒ³å¤§ãã
  html += '<div style="margin-bottom:8px">'+fishIconHTML(ft.id, 72)+'</div>';
  // åå‰
  html += '<div style="font-size:1.3rem;font-weight:bold;color:#7ec8e3">'+ft.name+'</div>';
  // ã‚¨ãƒªã‚¢
  html += '<div style="font-size:0.75rem;color:rgba(126,200,227,0.6);margin:4px 0">'+(area?area.icon+' '+area.name:'')+'</div>';
  // èª¬æ˜
  html += '<div style="font-size:0.85rem;color:#cde4f0;margin:8px 16px;line-height:1.5">'+ft.desc+'</div>';
  // åå…¥
  html += '<div style="font-size:0.8rem;color:rgba(255,215,0,0.8);margin:6px 0">åå…¥: '+ft.passiveIncome+' ğŸª™/10ç§’</div>';
  html += '<div style="font-size:0.75rem;color:rgba(126,200,227,0.4);margin-bottom:4px">è³¼å…¥ä¾¡æ ¼: '+(ft.shopPrice===0?'ç„¡æ–™':'ğŸª™ '+ft.shopPrice.toLocaleString())+'</div>';
  html += '</div>';

  // å¤‰ç•°ç¨®ã‚»ã‚¯ã‚·ãƒ§ãƒ³
  html += '<div style="border-top:1px solid rgba(126,200,227,0.15);margin:8px 0;padding-top:10px">';
  html += '<div style="font-size:0.8rem;color:rgba(126,200,227,0.6);margin-bottom:8px">âœ¨ å¤‰ç•°ç¨®</div>';
  html += '<div style="display:flex;justify-content:center;gap:12px;flex-wrap:wrap">';
  for (const vt of VARIANT_TYPES) {
    const vDisc = col.variantDiscovered?.[vt.id];
    html += '<div style="text-align:center;opacity:'+(vDisc?'1':'0.3')+';filter:'+(vDisc?'none':'grayscale(1)')+'">';
    html += '<div>'+fishIconHTML(ft.id, 40, vt.id)+'</div>';
    html += '<div style="font-size:0.6rem;color:'+(vDisc?'#cde4f0':'#666')+';margin-top:2px">'+vt.name+'</div>';
    html += '</div>';
  }
  html += '</div></div>';

  // ã‚«ãƒ©ãƒ¼ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã‚»ã‚¯ã‚·ãƒ§ãƒ³
  html += '<div style="border-top:1px solid rgba(126,200,227,0.15);margin:8px 0;padding-top:10px">';
  html += '<div style="font-size:0.8rem;color:rgba(126,200,227,0.6);margin-bottom:8px">ğŸ¨ ã‚«ãƒ©ãƒ¼ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ <span style="font-size:0.65rem;color:rgba(126,200,227,0.35)">'+hueShifts.length+'/12</span></div>';
  if (hueShifts.length > 0) {
    html += '<div style="display:flex;justify-content:center;gap:8px;flex-wrap:wrap">';
    for (const hs of hueShifts) {
      html += '<div style="text-align:center">';
      html += fishIconHTML(ft.id, 36, null, hs);
      html += '</div>';
    }
    html += '</div>';
  } else {
    html += '<div style="font-size:0.75rem;color:rgba(126,200,227,0.3)">ã¾ã è‰²ãŒé›†ã¾ã£ã¦ã„ã¾ã›ã‚“</div>';
  }
  html += '</div>';

  // é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³
  html += '<button class="shop-close" onclick="closeFishDetail()" style="margin-top:12px">ã‚‚ã©ã‚‹</button>';
  panel.innerHTML = html;
  document.getElementById('fishDetailOverlay').classList.add('open');
}

function closeFishDetail() {
  document.getElementById('fishDetailOverlay').classList.remove('open');
}
document.getElementById('fishDetailOverlay').addEventListener('click', e => { if (e.target.id === 'fishDetailOverlay') closeFishDetail(); });

// ============================================================
// æ”¾ç½®ç³»ã‚·ã‚¹ãƒ†ãƒ 
// ============================================================

// --- ã‚ªãƒ¼ãƒˆãƒ•ã‚£ãƒ¼ãƒ€ãƒ¼ ---
function updateAutoFeeder() {
  if (autoFeederLevel <= 0) return;

  autoFeederTimer++;
  const interval = getAutoFeederInterval();
  if (autoFeederTimer >= interval) {
    autoFeederTimer = 0;
    const x = 60 + Math.random() * (canvas.width - 120);
    const y = 20;
    const foodType = getAutoFeederFoodType();
    const count = getAutoFeederFoodCount();
    // ã‚ªãƒ¼ãƒˆãƒ•ã‚£ãƒ¼ãƒ€ãƒ¼ã¯ãƒ™ãƒ¼ã‚¹å€¤ï¼ˆLv1ç›¸å½“ï¼‰ã§ãƒ‰ãƒ­ãƒƒãƒ—
    const cr = foodType.baseCoinReward;
    const ga = foodType.baseGrowAmount;
    for (let i = 0; i < count; i++) foods.push(new Food(x+(Math.random()-0.5)*20, y+(Math.random()-0.5)*8, foodType, cr, ga));
  }
}

// --- ãŠå®ãƒãƒ–ãƒ« ---
function updateTreasureBubbles() {
  const hasTreasureGen = UPGRADES.find(u => u.id === 'treasureGen')?.owned;
  treasureTimer++;
  const interval = 600; // 10ç§’
  const chance = hasTreasureGen ? 0.4 : 0.15;

  if (treasureTimer >= interval) {
    treasureTimer = 0;
    if (Math.random() < chance) {
      treasureBubbles.push(new TreasureBubble(100 + Math.random()*(canvas.width-200)));
    }
  }

  treasureBubbles = treasureBubbles.filter(tb => {
    if (!tb.update()) {
      // æ°´é¢ã«åˆ°é” â†’ ã‚³ã‚¤ãƒ³ç²å¾—
      addCoins(tb.reward, tb.x, 10);
      return false;
    }
    return true;
  });
  for (const tb of treasureBubbles) tb.draw();
}

// --- ç¹æ®– ---
function updateBreeding() {
  breedTimer++;
  const hasBoost = UPGRADES.find(u => u.id === 'breedBoost')?.owned;
  const interval = 1800; // 30ç§’
  if (breedTimer >= interval) {
    breedTimer = 0;
    if (fishes.length >= 40) return; // ä¸Šé™

    // ã‚¿ã‚¤ãƒ—ã”ã¨ã«ã‚«ã‚¦ãƒ³ãƒˆ
    const counts = {};
    for (const f of fishes) { counts[f.typeId] = (counts[f.typeId]||0) + 1; }

    for (const [typeId, count] of Object.entries(counts)) {
      if (count >= 2) {
        const chance = hasBoost ? 0.12 : 0.06;
        if (Math.random() < chance) {
          const parent = fishes.find(f => f.typeId === typeId);
          // 5%ã®ç¢ºç‡ã§å¤‰ç•°ç¨®ï¼
          const isVariant = Math.random() < 0.05;
          let variantType = null;
          if (isVariant) variantType = VARIANT_TYPES[Math.floor(Math.random()*VARIANT_TYPES.length)].id;
          const baby = new Fish(typeId, parent.x + (Math.random()-0.5)*30, parent.y + (Math.random()-0.5)*20, isVariant, variantType);
          baby.size = baby.baseSize * 0.6;
          fishes.push(baby);
          discoverFish(typeId, variantType, baby.hueShift);
          const typeName = FISH_TYPES.find(t => t.id === typeId)?.name || typeId;
          const vtSuffix = isVariant ? VARIANT_TYPES.find(v => v.id===variantType).suffix : '';
          const prefix = isVariant ? 'âœ¨ ãƒ¬ã‚¢ï¼ ' : 'ğŸ‰ ';
          showNotification(prefix + typeName + vtSuffix + 'ã®èµ¤ã¡ã‚ƒã‚“ãŒç”Ÿã¾ã‚ŒãŸï¼');
          updateIncomeDisplay(); buildAreaTabs();
          break;
        }
      }
    }
  }
}

// ============================================================
// èƒŒæ™¯ï¼†æ°´é¢
// ============================================================
function drawBackground(time) {
  const area = getCurrentArea();
  const bgc = area.bg[lightMode] || area.bg.day;
  const sr = area.sandRGB;

  const grad = ctx.createLinearGradient(0,0,0,canvas.height);
  grad.addColorStop(0, bgc[0]); grad.addColorStop(0.5, bgc[1]); grad.addColorStop(1, bgc[2]);
  ctx.fillStyle = grad; ctx.fillRect(0,0,canvas.width,canvas.height);

  const la = lightMode==='night'?0.02:0.06;
  for (let i=0;i<5;i++) {
    const lx = canvas.width*0.15*i+Math.sin(time*0.0005+i)*40;
    ctx.fillStyle = `rgba(150,220,255,${la})`;
    ctx.beginPath(); ctx.moveTo(lx,0); ctx.lineTo(lx+60,0);
    ctx.lineTo(lx+40+Math.sin(time*0.001+i)*20,canvas.height);
    ctx.lineTo(lx-20+Math.sin(time*0.001+i)*20,canvas.height);
    ctx.closePath(); ctx.fill();
  }

  const sg = ctx.createLinearGradient(0,canvas.height-35,0,canvas.height);
  sg.addColorStop(0,`rgba(${sr[0]},${sr[1]},${sr[2]},0.6)`);
  sg.addColorStop(1,`rgba(${Math.max(0,sr[0]-24)},${Math.max(0,sr[1]-25)},${Math.max(0,sr[2]-20)},0.8)`);
  ctx.fillStyle = sg; ctx.beginPath(); ctx.moveTo(0,canvas.height-20);
  for (let x=0;x<=canvas.width;x+=20) ctx.lineTo(x, canvas.height-22+Math.sin(x*0.02+time*0.0005)*4);
  ctx.lineTo(canvas.width,canvas.height); ctx.lineTo(0,canvas.height); ctx.closePath(); ctx.fill();

  for (const p of sandParticles) { ctx.fillStyle=p.color; ctx.beginPath(); ctx.arc(p.x,p.y,p.size,0,Math.PI*2); ctx.fill(); }
}

function drawSurface(time) {
  ctx.fillStyle = 'rgba(100,200,255,0.08)';
  ctx.beginPath(); ctx.moveTo(0,0);
  for (let x=0;x<=canvas.width;x+=10) ctx.lineTo(x, 6+Math.sin(x*0.02+time*0.002)*3+Math.sin(x*0.01+time*0.001)*2);
  ctx.lineTo(canvas.width,0); ctx.closePath(); ctx.fill();
}

// ============================================================
// ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—
// ============================================================
function gameLoop(time) {
  drawBackground(time);
  for (const p of plants) p.draw(time);

  if (bubblerOn && Math.random()<0.08) bubbles.push(new Bubble(canvas.width*0.3+Math.random()*canvas.width*0.4));
  bubbles = bubbles.filter(b=>b.update());
  for (const b of bubbles) b.draw();

  foods = foods.filter(f=>f.update());
  for (const f of foods) f.draw();

  updateTreasureBubbles();

  for (const fish of fishes) { fish.update(); fish.draw(); }

  // å¯¿å‘½ãƒã‚§ãƒƒã‚¯ï¼ˆã‚µã‚¤ã‚º300%ã§å¤©å›½ã¸ï¼‰
  const deadFish = fishes.filter(f => f.size >= f.baseSize * 3);
  if (deadFish.length > 0) {
    for (const f of deadFish) {
      // å¤©å›½ã‚¨ãƒ•ã‚§ã‚¯ãƒˆï¼ˆæ³¡ã¨å…‰ï¼‰
      for (let i = 0; i < 8; i++) bubbles.push(new Bubble(f.x + (Math.random()-0.5)*20, f.y));
      showCoinPopup(0, f.x, f.y); // ãƒã‚¸ã‚·ãƒ§ãƒ³ç”¨
      // å¤©å›½ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—
      const popup = document.createElement('div');
      popup.className = 'coin-popup';
      popup.textContent = 'ğŸ˜‡ ' + f.type.name + 'ãŒå¤©å›½ã¸â€¦';
      popup.style.left = (f.x + 6) + 'px';
      popup.style.top = (f.y - 10) + 'px';
      popup.style.color = '#a0d8ef';
      tankWrapper.appendChild(popup);
      setTimeout(() => popup.remove(), 1500);
      // ãƒœãƒ¼ãƒŠã‚¹ã‚³ã‚¤ãƒ³ï¼ˆãŠåˆ¥ã‚Œãƒœãƒ¼ãƒŠã‚¹ï¼‰
      const bonus = Math.floor(f.getPassiveIncome() * 10);
      addCoins(bonus, f.x, f.y - 30);
      showNotification('ğŸ˜‡ ' + f.type.name + 'ãŒå¤©å›½ã¸æ—…ç«‹ã£ãŸâ€¦ ãŠåˆ¥ã‚Œãƒœãƒ¼ãƒŠã‚¹ +' + bonus + 'ğŸª™');
    }
    fishes = fishes.filter(f => f.size < f.baseSize * 3);
    areaStates[currentAreaId].fishes = fishes;
    updateIncomeDisplay(); buildAreaTabs();
  }

  drawSurface(time);

  updateTooltip();

  // ãƒ‘ãƒƒã‚·ãƒ–åå…¥
  passiveTimer++;
  if (passiveTimer >= 600) {
    passiveTimer = 0;
    let income = getTotalPassiveIncome();
    if (income > 0) addCoins(income, canvas.width-60, 30);
  }

  // ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³
  if (feedCooldown > 0) feedCooldown--;

  // æ”¾ç½®ç³»
  updateAutoFeeder();
  updateBreeding();

  requestAnimationFrame(gameLoop);
}

// ============================================================
// ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œ
// ============================================================
let feedCooldown = 0;
function dropFood(x, y) {
  if (feedCooldown > 0) return;
  feedCooldown = 30;
  const ft = getSelectedFood();
  const count = 2+Math.floor(Math.random()*2);
  for (let i=0;i<count;i++) foods.push(new Food(x+(Math.random()-0.5)*20, y+(Math.random()-0.5)*10, ft));
}
canvas.addEventListener('click', e => {
  const rect = canvas.getBoundingClientRect();
  dropFood(e.clientX-rect.left, e.clientY-rect.top);
});

function toggleBubbler() { bubblerOn = !bubblerOn; updateBubblerBtn(); }
function updateBubblerBtn() {
  const btn = document.getElementById('bubbleBtn');
  if (bubblerOn) btn.classList.add('active-toggle');
  else btn.classList.remove('active-toggle');
}
function toggleLight() { lightIndex=(lightIndex+1)%lightModes.length; lightMode=lightModes[lightIndex]; }
function killAll() {
  if (fishes.length === 0) return;
  if (!confirm('æœ¬å½“ã«ä»Šã®ã‚¨ãƒªã‚¢ã®é­šã‚’å…¨æ»…ã•ã›ã¾ã™ã‹ï¼Ÿï¼ˆå…ƒã«æˆ»ã›ã¾ã›ã‚“ï¼‰')) return;
  fishes.length = 0;
  areaStates[currentAreaId].fishes = fishes;
  updateIncomeDisplay(); buildAreaTabs();
  showNotification('å…¨ã¦ã®é­šãŒã„ãªããªã£ãŸâ€¦');
}

// ============================================================
// ã‚»ãƒ¼ãƒ–ãƒ»ãƒ­ãƒ¼ãƒ‰ï¼ˆlocalStorageï¼‰
// ============================================================
function saveGame() {
  try {
    // ç¾åœ¨ã®ã‚¨ãƒªã‚¢ã®çŠ¶æ…‹ã‚’ä¿å­˜
    areaStates[currentAreaId].fishes = fishes;
    areaStates[currentAreaId].plants = plants;
    areaStates[currentAreaId].sandParticles = sandParticles;

    const areaData = {};
    for (const a of AREAS) {
      areaData[a.id] = {
        fishes: areaStates[a.id].fishes.map(f => ({typeId: f.typeId, size: f.size, isVariant: f.isVariant||false, variantType: f.variantType||null, hueShift: f.hueShift||0}))
      };
    }
    const data = {
      version: 2,
      coins,
      currentAreaId,
      areaData,
      unlockedAreas: AREAS.filter(a => a.unlocked).map(a => a.id),
      foodLevels,
      autoFeederLevel,
      upgrades: UPGRADES.filter(u => u.owned).map(u => u.id),
      collection,
      selectedFoodId,
      bubblerOn,
      lightIndex,
      lastSave: Date.now()
    };
    localStorage.setItem('aquarium_save', JSON.stringify(data));
  } catch(e) { /* localStorageå¯èƒ½ã§ãªã„ç’°å¢ƒ */ }
}

function loadGame() {
  try {
    const raw = localStorage.getItem('aquarium_save');
    if (!raw) return false;
    const data = JSON.parse(raw);

    coins = data.coins || 0;

    // ã‚¨ãƒªã‚¢è§£æ”¾
    for (const id of (data.unlockedAreas || [])) {
      const a = AREAS.find(x => x.id === id);
      if (a) a.unlocked = true;
    }

    // === ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç§»è¡Œ ===
    if (!data.version || data.version < 2) {
      // æ—§ã‚»ãƒ¼ãƒ–: é¤Œunlockã‚’ãƒ¬ãƒ™ãƒ«1ã«å¤‰æ›
      foodLevels = { normal:1, premium:0, royal:0, legendary:0 };
      for (const id of (data.unlockedFoods || [])) { foodLevels[id] = 1; }
      // æ—§è¨­å‚™: autoFeeder/premiumFeeder ã‚’ãƒ¬ãƒ™ãƒ«ã«å¤‰æ›
      autoFeederLevel = 0;
      for (const id of (data.upgrades || [])) {
        if (id === 'autoFeeder') autoFeederLevel = Math.max(autoFeederLevel, 1);
        if (id === 'premiumFeeder') autoFeederLevel = Math.max(autoFeederLevel, 4);
        const up = UPGRADES.find(u => u.id === id);
        if (up) up.owned = true;
      }
    } else {
      // v2+ã‚»ãƒ¼ãƒ–
      foodLevels = data.foodLevels || { normal:1, premium:0, royal:0, legendary:0 };
      autoFeederLevel = data.autoFeederLevel || 0;
      for (const id of (data.upgrades || [])) {
        const up = UPGRADES.find(u => u.id === id);
        if (up) up.owned = true;
      }
    }

    // ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³å¾©å…ƒ
    collection = data.collection || {};
    initCollection();

    // ã‚¨ãƒªã‚¢ã”ã¨ã®é­šå¾©å…ƒï¼ˆå¤‰ç•°ç¨®å¯¾å¿œï¼‰
    if (data.areaData) {
      for (const [areaId, ad] of Object.entries(data.areaData)) {
        if (!areaStates[areaId]) continue;
        areaStates[areaId].fishes = [];
        for (const fd of (ad.fishes || [])) {
          const fish = new Fish(fd.typeId, undefined, undefined, fd.isVariant||false, fd.variantType||null);
          fish.size = fd.size || fish.size;
          if (fd.hueShift !== undefined) fish.hueShift = fd.hueShift;
          areaStates[areaId].fishes.push(fish);
          discoverFish(fd.typeId, fd.variantType||null, fish.hueShift);
        }
      }
    } else if (data.fishes) {
      areaStates.freshwater.fishes = [];
      for (const fd of data.fishes) {
        const fish = new Fish(fd.typeId);
        fish.size = fd.size || fish.size;
        areaStates.freshwater.fishes.push(fish);
        discoverFish(fd.typeId, null, fish.hueShift);
      }
    }

    currentAreaId = data.currentAreaId || 'freshwater';
    fishes = areaStates[currentAreaId].fishes;

    selectedFoodId = data.selectedFoodId || 'normal';
    if (!isFoodUnlocked(selectedFoodId)) selectedFoodId = 'normal';
    bubblerOn = data.bubblerOn !== undefined ? data.bubblerOn : true;
    lightIndex = data.lightIndex || 0;
    lightMode = lightModes[lightIndex];

    // ã‚ªãƒ•ãƒ©ã‚¤ãƒ³åç›Š
    if (data.lastSave) {
      const elapsed = (Date.now() - data.lastSave) / 1000;
      const seconds = Math.min(elapsed, 86400);
      let incomePerTick = 0;
      for (const a of AREAS) {
        if (!a.unlocked) continue;
        for (const f of areaStates[a.id].fishes) incomePerTick += f.getPassiveIncome();
      }
      const offlineEarnings = Math.floor(incomePerTick * seconds / 10 * 0.3);
      if (offlineEarnings > 0 && seconds > 30) {
        coins += offlineEarnings;
        setTimeout(() => {
          showNotification('ãŠã‹ãˆã‚Šï¼ç•™å®ˆã®é–“ã« ' + offlineEarnings.toLocaleString() + ' ã‚³ã‚¤ãƒ³ç¨¼ã„ã ã‚ˆï¼');
        }, 800);
      }
    }

    // é­šã®ç¨®é¡ã‚’è§£æ”¾æ¸ˆã¿ã«ãƒãƒ¼ã‚¯
    for (const a of AREAS) {
      for (const f of areaStates[a.id].fishes) {
        const ft = FISH_TYPES.find(t => t.id === f.typeId);
        if (ft) ft.unlocked = true;
      }
    }

    return true;
  } catch(e) { return false; }
}

// 30ç§’ã”ã¨ã«è‡ªå‹•ã‚»ãƒ¼ãƒ–
setInterval(saveGame, 30000);
window.addEventListener('beforeunload', saveGame);

// ============================================================
// ã‚¹ã‚¿ãƒ¼ãƒˆ
// ============================================================
firstInit();
requestAnimationFrame(gameLoop);
if ('serviceWorker' in navigator) navigator.serviceWorker.register('sw.js');
</script>
</body>
</html>
