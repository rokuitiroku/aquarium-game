<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="theme-color" content="#0a1628">
<link rel="manifest" href="manifest.json">
<title>üêü Ê∞¥ÊßΩ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: #0a0e1a;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    font-family: 'Zen Maru Gothic', sans-serif;
    overflow: hidden;
    user-select: none;
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }

  .header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: min(800px, calc(100vw - 40px));
    margin-bottom: 10px;
  }

  h1 {
    color: #7ec8e3;
    font-size: 1.3rem;
    letter-spacing: 0.1em;
    text-shadow: 0 0 20px rgba(126, 200, 227, 0.4);
  }

  .header-right {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .progress-display {
    font-size: 0.7rem;
    color: rgba(126, 200, 227, 0.55);
    display: flex;
    align-items: center;
    gap: 4px;
  }
  .progress-display .prog-bar {
    width: 48px;
    height: 6px;
    background: rgba(126, 200, 227, 0.1);
    border-radius: 3px;
    overflow: hidden;
  }
  .progress-display .prog-fill {
    height: 100%;
    border-radius: 3px;
    background: linear-gradient(90deg, #7ec8e3, #ffd700);
    transition: width 0.5s;
  }

  .income-display {
    color: rgba(126, 200, 227, 0.6);
    font-size: 0.75rem;
  }

  .coin-display {
    display: flex;
    align-items: center;
    gap: 8px;
    background: rgba(255, 215, 0, 0.1);
    border: 1px solid rgba(255, 215, 0, 0.3);
    border-radius: 20px;
    padding: 6px 16px;
    color: #ffd700;
    font-weight: 700;
    font-size: 1rem;
    text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
    transition: all 0.3s;
  }
  .coin-display.flash {
    background: rgba(255, 215, 0, 0.25);
    transform: scale(1.08);
  }

  .tank-wrapper {
    position: relative;
    border-radius: 16px;
    padding: 6px;
    background: linear-gradient(135deg, #1a3a4a, #0d1f2d);
    box-shadow: 0 0 40px rgba(30, 100, 160, 0.15), inset 0 0 30px rgba(0,0,0,0.3);
  }

  canvas { display: block; border-radius: 12px; cursor: pointer; }

  .coin-popup {
    position: absolute;
    color: #ffd700;
    font-weight: 700;
    font-size: 0.9rem;
    pointer-events: none;
    animation: coinPop 1s ease-out forwards;
    text-shadow: 0 0 6px rgba(255, 215, 0, 0.6);
    z-index: 10;
  }
  @keyframes coinPop {
    0% { opacity: 1; transform: translateY(0) scale(1); }
    100% { opacity: 0; transform: translateY(-40px) scale(1.3); }
  }

  .fish-tooltip {
    position: absolute;
    background: rgba(10, 20, 40, 0.92);
    border: 1px solid rgba(126, 200, 227, 0.4);
    border-radius: 12px;
    padding: 8px 14px;
    color: #cde4f0;
    font-size: 0.78rem;
    pointer-events: none;
    z-index: 20;
    white-space: nowrap;
    opacity: 0;
    transition: opacity 0.2s;
    box-shadow: 0 0 16px rgba(30, 100, 160, 0.3);
  }
  .fish-tooltip.visible { opacity: 1; }
  .fish-tooltip .tt-name { font-weight: 700; font-size: 0.85rem; margin-bottom: 2px; }
  .fish-tooltip .tt-greeting { color: rgba(126, 200, 227, 0.7); }
  .fish-tooltip .tt-stats { color: rgba(255, 215, 0, 0.7); font-size: 0.7rem; margin-top: 3px; }

  .notification {
    position: absolute;
    top: 16px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(10, 20, 40, 0.9);
    border: 1px solid rgba(126, 200, 227, 0.3);
    border-radius: 16px;
    padding: 8px 20px;
    color: #cde4f0;
    font-size: 0.8rem;
    z-index: 30;
    animation: notifAnim 3s ease-out forwards;
    white-space: nowrap;
  }
  @keyframes notifAnim {
    0% { opacity: 0; transform: translateX(-50%) translateY(-10px); }
    10% { opacity: 1; transform: translateX(-50%) translateY(0); }
    80% { opacity: 1; }
    100% { opacity: 0; transform: translateX(-50%) translateY(-10px); }
  }

  .food-selector {
    display: flex;
    gap: 6px;
    margin-top: 10px;
    align-items: center;
    flex-wrap: wrap;
    justify-content: center;
  }
  .food-selector span {
    color: rgba(126, 200, 227, 0.5);
    font-size: 0.75rem;
    margin-right: 4px;
  }

  .food-btn {
    font-family: 'Zen Maru Gothic', sans-serif;
    padding: 5px 12px;
    border: 1px solid rgba(126, 200, 227, 0.2);
    border-radius: 14px;
    background: rgba(126, 200, 227, 0.06);
    color: #7ec8e3;
    font-size: 0.75rem;
    cursor: pointer;
    transition: all 0.3s;
    white-space: nowrap;
  }
  .food-btn:hover { background: rgba(126, 200, 227, 0.15); }
  .food-btn.active {
    background: rgba(126, 200, 227, 0.2);
    border-color: rgba(126, 200, 227, 0.6);
    box-shadow: 0 0 8px rgba(126, 200, 227, 0.2);
  }
  .food-btn.locked { opacity: 0.4; cursor: not-allowed; }

  .controls {
    display: flex;
    gap: 8px;
    margin-top: 10px;
    flex-wrap: wrap;
    justify-content: center;
  }
  .controls button {
    font-family: 'Zen Maru Gothic', sans-serif;
    padding: 7px 14px;
    border: 1px solid rgba(126, 200, 227, 0.3);
    border-radius: 20px;
    background: rgba(126, 200, 227, 0.08);
    color: #7ec8e3;
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.3s;
  }
  .controls button:hover {
    background: rgba(126, 200, 227, 0.2);
    border-color: rgba(126, 200, 227, 0.6);
  }
  .controls button.active-toggle {
    background: rgba(126, 200, 227, 0.25);
    border-color: rgba(126, 200, 227, 0.7);
    box-shadow: 0 0 8px rgba(126, 200, 227, 0.2);
  }

  .shop-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.7);
    z-index: 100;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(4px);
  }
  .shop-overlay.open { display: flex; }

  .shop-panel {
    background: linear-gradient(145deg, #0f2233, #162d44);
    border: 1px solid rgba(126, 200, 227, 0.2);
    border-radius: 20px;
    padding: 28px 32px;
    max-width: 560px;
    width: 90vw;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: 0 0 60px rgba(30, 100, 160, 0.3);
  }

  .shop-title {
    color: #ffd700;
    font-size: 1.3rem;
    text-align: center;
    margin-bottom: 6px;
  }
  .shop-coins {
    text-align: center;
    color: #ffd700;
    font-size: 0.9rem;
    margin-bottom: 18px;
    opacity: 0.8;
  }
  .shop-section-title {
    color: #7ec8e3;
    font-size: 0.85rem;
    margin: 16px 0 10px;
    padding-bottom: 4px;
    border-bottom: 1px solid rgba(126, 200, 227, 0.15);
  }

  .shop-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 10px 14px;
    border-radius: 12px;
    margin-bottom: 8px;
    background: rgba(126, 200, 227, 0.04);
    border: 1px solid rgba(126, 200, 227, 0.08);
    transition: all 0.2s;
  }
  .shop-item:hover {
    background: rgba(126, 200, 227, 0.1);
    border-color: rgba(126, 200, 227, 0.2);
  }
  .shop-item-icon { font-size: 1.8rem; min-width: 36px; display: flex; align-items: center; justify-content: center; }
  .shop-item-icon img { border-radius: 6px; background: rgba(126,200,227,0.08); }
  .shop-item-info { flex: 1; }
  .shop-item-name { color: #cde4f0; font-size: 0.9rem; font-weight: 700; }
  .shop-item-desc { color: rgba(126, 200, 227, 0.5); font-size: 0.7rem; margin-top: 2px; }

  .shop-buy-btn {
    font-family: 'Zen Maru Gothic', sans-serif;
    padding: 6px 14px;
    border: 1px solid rgba(255, 215, 0, 0.3);
    border-radius: 14px;
    background: rgba(255, 215, 0, 0.1);
    color: #ffd700;
    font-size: 0.8rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s;
    white-space: nowrap;
  }
  .shop-buy-btn:hover:not(:disabled) {
    background: rgba(255, 215, 0, 0.25);
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.2);
  }
  .shop-buy-btn:disabled { opacity: 0.3; cursor: not-allowed; }
  .shop-buy-btn.owned {
    border-color: rgba(100, 200, 100, 0.4);
    color: #6bcb77;
    background: rgba(100, 200, 100, 0.1);
  }

  .shop-close {
    display: block;
    margin: 18px auto 0;
    font-family: 'Zen Maru Gothic', sans-serif;
    padding: 8px 28px;
    border: 1px solid rgba(126, 200, 227, 0.3);
    border-radius: 20px;
    background: rgba(126, 200, 227, 0.08);
    color: #7ec8e3;
    font-size: 0.85rem;
    cursor: pointer;
    transition: all 0.3s;
  }
  .shop-close:hover { background: rgba(126, 200, 227, 0.2); }

  /* ===== „Ç¨„ÉÅ„É£ÊºîÂá∫ ===== */
  .gacha-overlay {
    display:none; position:fixed; inset:0; z-index:200;
    align-items:center; justify-content:center;
    background:rgba(0,0,0,0);
    transition: background 0.5s;
  }
  .gacha-overlay.open { display:flex; background:rgba(0,0,0,0.92); }

  /* ÊââÊºîÂá∫ */
  .gacha-doors {
    position:fixed; inset:0; z-index:201; display:none; pointer-events:none;
  }
  .gacha-door {
    width:50%; height:100%;
    background: linear-gradient(180deg, #1a1a3e 0%, #0d0d2b 50%, #1a1a3e 100%);
    border: none; position:relative; overflow:hidden;
    transition: transform 0.8s cubic-bezier(0.6, 0, 0.2, 1);
  }
  .gacha-door::after {
    content:''; position:absolute; top:0; width:3px; height:100%;
    background: linear-gradient(180deg, transparent, rgba(126,200,227,0.6), rgba(255,215,0,0.6), rgba(126,200,227,0.6), transparent);
  }
  .gacha-door-left::after { right:0; }
  .gacha-door-right::after { left:0; }
  .gacha-door-left { transform-origin:left center; }
  .gacha-door-right { transform-origin:right center; }
  .gacha-doors.open .gacha-door-left { transform:translateX(-105%); }
  .gacha-doors.open .gacha-door-right { transform:translateX(105%); }
  .gacha-door-emblem {
    position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
    font-size:4rem; opacity:0.3;
  }

  /* ÂÖâ„ÅÆÊü± */
  .gacha-pillar {
    position:fixed; top:-10%; left:50%; transform:translateX(-50%); z-index:202;
    width:0; height:120%; pointer-events:none;
    background: linear-gradient(180deg, transparent, rgba(126,200,227,0.4), rgba(255,255,255,0.6), rgba(126,200,227,0.4), transparent);
    opacity:0; transition: width 0.4s, opacity 0.3s;
  }
  .gacha-pillar.active { width:120px; opacity:1; }
  .gacha-pillar.rare {
    background: linear-gradient(180deg, transparent, rgba(255,215,0,0.5), rgba(255,255,255,0.8), rgba(255,215,0,0.5), transparent);
    width:200px;
  }

  /* ÁîªÈù¢Ââ≤„ÇåÔºà„É¨„Ç¢ÊºîÂá∫Ôºâ */
  .gacha-crack {
    position:fixed; inset:0; z-index:203; pointer-events:none;
    opacity:0; transition:opacity 0.3s;
  }
  .gacha-crack.active { opacity:1; }
  .gacha-crack svg { width:100%; height:100%; }

  /* „Ç´„Éº„ÉâÊú¨‰Ωì */
  .gacha-card {
    position:relative; width:280px; text-align:center; z-index:204;
    transform: scale(0) rotateY(180deg);
    transition: transform 0.7s cubic-bezier(0.34, 1.56, 0.64, 1);
  }
  .gacha-overlay.reveal .gacha-card { transform: scale(1) rotateY(0deg); }

  .gacha-glow {
    position:absolute; inset:-60px; border-radius:50%;
    background:radial-gradient(circle, rgba(126,200,227,0.2) 0%, transparent 70%);
    animation: gachaPulse 2s ease-in-out infinite;
  }
  .gacha-glow.rare {
    background:radial-gradient(circle, rgba(255,215,0,0.4) 0%, rgba(255,100,0,0.15) 40%, transparent 70%);
    animation: gachaPulseRare 1.5s ease-in-out infinite;
  }
  @keyframes gachaPulse {
    0%, 100% { transform:scale(1); opacity:0.6; }
    50% { transform:scale(1.2); opacity:1; }
  }
  @keyframes gachaPulseRare {
    0%, 100% { transform:scale(1); opacity:0.7; }
    50% { transform:scale(1.4); opacity:1; }
  }

  /* ÊîæÂ∞ÑÁä∂„ÅÆÂÖâÁ∑ö */
  .gacha-rays {
    position:absolute; inset:-100px; z-index:0; pointer-events:none;
    opacity:0; transition: opacity 0.5s;
  }
  .gacha-overlay.reveal .gacha-rays { opacity:1; }
  .gacha-ray {
    position:absolute; top:50%; left:50%;
    width:2px; height:150px; transform-origin:bottom center;
    background: linear-gradient(to top, rgba(255,215,0,0.3), transparent);
    animation: rayRotate 8s linear infinite;
  }
  .gacha-rays.rare .gacha-ray {
    background: linear-gradient(to top, rgba(255,215,0,0.6), transparent);
    height:200px; width:3px;
  }
  @keyframes rayRotate { 0%{transform:rotate(var(--r))} 100%{transform:rotate(calc(var(--r) + 360deg))} }

  .gacha-icon {
    font-size:5rem; position:relative; z-index:1;
    filter: drop-shadow(0 0 20px rgba(126,200,227,0.4));
    animation: gachaFloat 2.5s ease-in-out infinite;
  }
  .gacha-icon.rare {
    filter: drop-shadow(0 0 35px rgba(255,215,0,0.9));
    animation: gachaFloat 2s ease-in-out infinite, gachaShine 3s linear infinite;
  }
  @keyframes gachaFloat {
    0%, 100% { transform:translateY(0); }
    50% { transform:translateY(-10px); }
  }
  @keyframes gachaShine {
    0% { filter: drop-shadow(0 0 35px rgba(255,215,0,0.9)) hue-rotate(0deg); }
    100% { filter: drop-shadow(0 0 35px rgba(255,215,0,0.9)) hue-rotate(360deg); }
  }

  .gacha-label {
    color:#7ec8e3; font-size:0.85rem; margin-top:8px; letter-spacing:2px;
    opacity:0; transform:translateY(10px);
    transition: opacity 0.4s 0.3s, transform 0.4s 0.3s;
  }
  .gacha-overlay.reveal .gacha-label { opacity:0.8; transform:translateY(0); }
  .gacha-label.rare { color:#ffd700; font-size:1rem; text-shadow:0 0 15px rgba(255,215,0,0.5); }

  .gacha-name {
    color:#fff; font-size:1.5rem; font-weight:900; margin-top:8px;
    text-shadow: 0 0 20px rgba(126,200,227,0.5);
    opacity:0; transform:translateY(15px) scale(0.8);
    transition: opacity 0.4s 0.5s, transform 0.5s 0.5s cubic-bezier(0.34,1.56,0.64,1);
  }
  .gacha-overlay.reveal .gacha-name { opacity:1; transform:translateY(0) scale(1); }
  .gacha-name.rare {
    color:#ffd700; font-size:1.7rem;
    text-shadow: 0 0 25px rgba(255,215,0,0.6), 0 0 50px rgba(255,100,0,0.3);
  }

  .gacha-variant-badge {
    display:inline-block; margin-top:10px; padding:5px 16px;
    border-radius:20px; font-size:0.85rem; font-weight:700;
    opacity:0; transform:scale(0);
    transition: opacity 0.3s 0.7s, transform 0.4s 0.7s cubic-bezier(0.34,1.56,0.64,1);
  }
  .gacha-overlay.reveal .gacha-variant-badge { opacity:1; transform:scale(1); }
  .gacha-variant-badge.gold { background:linear-gradient(135deg,#ffd700,#ff8f00); color:#3e2723; }
  .gacha-variant-badge.albino { background:linear-gradient(135deg,#fff,#ffcdd2); color:#4a148c; }
  .gacha-variant-badge.neon { background:linear-gradient(135deg,#00ffc8,#00b8d4); color:#004d40; }
  .gacha-variant-badge.holo { background:linear-gradient(135deg,#f44336,#4caf50,#2196f3,#ff9800); color:#fff; }

  .gacha-income {
    color:rgba(255,215,0,0.8); font-size:0.85rem; margin-top:8px;
    opacity:0; transition: opacity 0.4s 0.8s;
  }
  .gacha-overlay.reveal .gacha-income { opacity:1; }

  .gacha-close-hint {
    color:rgba(126,200,227,0.35); font-size:0.7rem; margin-top:24px;
    opacity:0; transition: opacity 0.4s 1s;
    animation: gachaBlink 2s ease-in-out infinite 1.5s;
  }
  .gacha-overlay.reveal .gacha-close-hint { opacity:1; }
  @keyframes gachaBlink {
    0%, 100% { opacity:0.35; }
    50% { opacity:0.7; }
  }

  /* „Çπ„Ç≠„ÉÉ„Éó„Éí„É≥„Éà */
  .gacha-skip-hint {
    position:fixed; bottom:12%; left:50%; transform:translateX(-50%);
    z-index:210; color:rgba(126,200,227,0.4); font-size:0.75rem;
    opacity:0; transition:opacity 0.3s;
    pointer-events:none;
  }
  .gacha-skip-hint.show { opacity:1; }

  /* Á¥ôÂêπÈõ™ */
  .gacha-confetti {
    position:absolute; width:8px; height:8px; border-radius:2px;
    animation: confettiFall linear forwards;
    pointer-events:none;
  }
  @keyframes confettiFall {
    0% { transform:translateY(-30px) rotate(0deg) scale(1); opacity:1; }
    100% { transform:translateY(350px) rotate(720deg) scale(0.2); opacity:0; }
  }

  /* „Éï„É©„ÉÉ„Ç∑„É• */
  .gacha-flash {
    position:fixed; inset:0; z-index:205; pointer-events:none;
    background:#fff; opacity:0; transition: opacity 0.1s;
  }
  .gacha-flash.active { opacity:0.8; }

  /* „Ç´„Ç¶„É≥„Éà„ÉÄ„Ç¶„É≥ */
  .gacha-opening {
    color:#ffd700; font-size:3rem; font-weight:900;
    text-shadow: 0 0 40px rgba(255,215,0,0.6);
    animation: gachaCountPulse 0.45s ease-out;
  }
  @keyframes gachaCountPulse {
    0% { transform:scale(2.5); opacity:0; }
    60% { transform:scale(0.9); opacity:1; }
    100% { transform:scale(1); opacity:1; }
  }

  /* Â§öÈÄ£„Ç¨„ÉÅ„É£ÁµêÊûú„ÅÆ„Ç∞„É™„ÉÉ„ÉâÈ†ÖÁõÆ„Ç¢„Éã„É° */
  .gacha-multi-card {
    opacity:0; transform:translateY(20px) scale(0.9);
    animation: multiCardIn 0.4s ease-out forwards;
  }
  @keyframes multiCardIn {
    to { opacity:1; transform:translateY(0) scale(1); }
  }

  /* Â§öÈÄ£ÁµêÊûú„ÅÆ„Ç´„Ç¶„É≥„Çø„Éº */
  .gacha-counter {
    position:fixed; top:8%; left:50%; transform:translateX(-50%);
    z-index:210; color:rgba(255,255,255,0.6); font-size:0.9rem;
    font-weight:bold; pointer-events:none;
  }

  .info {
    color: rgba(126, 200, 227, 0.45);
    font-size: 0.7rem;
    margin-top: 8px;
  }

  .area-tabs {
    display: flex;
    gap: 4px;
    margin-bottom: 6px;
    justify-content: center;
    width: min(800px, calc(100vw - 40px));
  }
  .area-tab {
    font-family: 'Zen Maru Gothic', sans-serif;
    padding: 5px 13px;
    border: 1px solid rgba(126, 200, 227, 0.15);
    border-bottom: none;
    border-radius: 12px 12px 0 0;
    background: rgba(126, 200, 227, 0.04);
    color: rgba(126, 200, 227, 0.5);
    font-size: 0.72rem;
    cursor: pointer;
    transition: all 0.3s;
    white-space: nowrap;
  }
  .area-tab:hover { background: rgba(126, 200, 227, 0.1); }
  .area-tab.active {
    background: rgba(126, 200, 227, 0.18);
    border-color: rgba(126, 200, 227, 0.5);
    color: #7ec8e3;
    font-weight: 700;
  }
  .area-tab.locked {
    opacity: 0.3;
    cursor: not-allowed;
  }
  .area-tab .tab-count {
    font-size: 0.6rem;
    opacity: 0.6;
    margin-left: 3px;
  }
</style>
</head>
<body>

<div class="header">
  <h1>üêü Ê∞¥ÊßΩ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥</h1>
  <div class="header-right">
    <div class="progress-display" id="progressDisplay" style="cursor:pointer" onclick="openCollection()"></div>
    <div class="income-display" id="incomeDisplay"></div>
    <div class="coin-display" id="coinDisplay">
      <span>ü™ô</span>
      <span id="coinText">0</span>
    </div>
  </div>
</div>

<div class="area-tabs" id="areaTabs"></div>

<div class="tank-wrapper" id="tankWrapper">
  <canvas id="tank"></canvas>
  <div class="fish-tooltip" id="fishTooltip">
    <div class="tt-name" id="ttName"></div>
    <div class="tt-greeting" id="ttGreeting"></div>
    <div class="tt-stats" id="ttStats"></div>
  </div>
</div>

<div class="food-selector" id="foodSelector"></div>

<div class="controls">
  <button onclick="openShop()">üõí „Ç∑„Éß„ÉÉ„Éó</button>
  <button onclick="openCollection()">üìñ Âõ≥Èëë</button>
  <button id="bubbleBtn" onclick="toggleBubbler()">ü´ß „Éñ„ÇØ„Éñ„ÇØ</button>
  <button onclick="toggleLight()">üí° „É©„Ç§„Éà</button>
  <button onclick="killAll()" style="background:rgba(255,60,60,0.15);border-color:rgba(255,60,60,0.3)">üíÄ ÂÖ®ÊªÖ</button>
</div>

<p class="info">Ê∞¥ÊßΩ„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„Ç®„Çµ„Çí„ÅÇ„Åí„Çà„ÅÜ „Éª È≠ö„Åå„Ç®„Çµ„ÇíÈ£ü„Åπ„Çã„Å®„Ç≥„Ç§„É≥GET „Éª ÊîæÁΩÆ„Åß„ÇÇÁ®º„Åí„Çã„ÇàÔºÅ</p>

<div class="shop-overlay" id="shopOverlay">
  <div class="shop-panel">
    <div class="shop-title">üõí „Ç∑„Éß„ÉÉ„Éó</div>
    <div class="shop-coins" id="shopCoins">ü™ô 0</div>
    <div id="shopContents"></div>
    <button class="shop-close" onclick="closeShop()">„Å®„Åò„Çã</button>
  </div>
</div>

<div class="shop-overlay" id="collectionOverlay">
  <div class="shop-panel" style="max-width:640px">
    <div class="shop-title">üìñ „Åä„Åï„Åã„Å™Âõ≥Èëë</div>
    <div id="collectionProgress" style="text-align:center;color:rgba(126,200,227,0.7);font-size:0.85rem;margin-bottom:12px"></div>
    <div id="collectionGrid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(90px,1fr));gap:6px;max-height:60vh;overflow-y:auto;padding:4px"></div>
    <button class="shop-close" onclick="closeCollection()">„Å®„Åò„Çã</button>
  </div>
</div>

<!-- Âõ≥Èëë È≠öË©≥Á¥∞ -->
<div class="shop-overlay" id="fishDetailOverlay" style="z-index:10001">
  <div class="shop-panel" id="fishDetailPanel" style="max-width:420px">
  </div>
</div>

<!-- Êââ -->
<div class="gacha-doors" id="gachaDoors">
  <div class="gacha-door gacha-door-left"><div class="gacha-door-emblem">üé∞</div></div>
  <div class="gacha-door gacha-door-right"><div class="gacha-door-emblem">üé∞</div></div>
</div>
<!-- ÂÖâ„ÅÆÊü± -->
<div class="gacha-pillar" id="gachaPillar"></div>
<!-- ÁîªÈù¢Ââ≤„Çå -->
<div class="gacha-crack" id="gachaCrack">
  <svg viewBox="0 0 100 100" preserveAspectRatio="none">
    <path d="M50 0 L48 18 L42 25 L46 38 L38 50 L44 62 L40 75 L46 88 L50 100" stroke="rgba(255,215,0,0.7)" stroke-width="0.4" fill="none"/>
    <path d="M50 0 L53 15 L58 28 L54 42 L60 55 L56 68 L62 82 L50 100" stroke="rgba(255,215,0,0.7)" stroke-width="0.4" fill="none"/>
    <path d="M0 50 L15 48 L28 44 L40 50 L55 46 L68 50 L80 44 L100 50" stroke="rgba(255,215,0,0.5)" stroke-width="0.3" fill="none"/>
  </svg>
</div>
<!-- „Éï„É©„ÉÉ„Ç∑„É• -->
<div class="gacha-flash" id="gachaFlash"></div>
<!-- „Ç´„Ç¶„É≥„Çø„ÉºÔºàË§áÊï∞ÈÄ£Áî®Ôºâ -->
<div class="gacha-counter" id="gachaCounter" style="display:none;"></div>
<!-- „Çπ„Ç≠„ÉÉ„Éó„Éí„É≥„Éà -->
<div class="gacha-skip-hint" id="gachaSkipHint">„Çø„ÉÉ„Éó„Åß„Çπ„Ç≠„ÉÉ„Éó</div>

<div class="gacha-overlay" id="gachaOverlay">
  <div class="gacha-card" id="gachaCard">
    <div class="gacha-rays" id="gachaRays"></div>
    <div class="gacha-glow" id="gachaGlow"></div>
    <div class="gacha-icon" id="gachaIcon"></div>
    <div class="gacha-label" id="gachaLabel"></div>
    <div class="gacha-name" id="gachaName"></div>
    <div id="gachaBadge"></div>
    <div class="gacha-income" id="gachaIncome"></div>
    <div class="gacha-close-hint" id="gachaCloseHint">„Çø„ÉÉ„Éó„Åó„Å¶Èñâ„Åò„Çã</div>
  </div>
</div>

<!-- Ë§áÊï∞ÈÄ£„Åæ„Å®„ÇÅÁµêÊûú -->
<div class="gacha-overlay" id="gachaMultiOverlay" onclick="closeMultiGacha(event)">
  <div id="gachaMultiPanel" style="background:rgba(10,14,26,0.95);border-radius:16px;padding:20px;max-width:520px;width:92%;max-height:80vh;overflow-y:auto;border:2px solid rgba(126,200,227,0.3);">
    <div id="gachaMultiTitle" style="text-align:center;font-size:1.3rem;font-weight:bold;color:#7ec8e3;margin-bottom:14px;"></div>
    <div id="gachaMultiGrid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:10px;"></div>
    <div style="text-align:center;margin-top:16px;color:rgba(255,255,255,0.5);font-size:0.85rem;">„Çø„ÉÉ„Éó„Åó„Å¶Èñâ„Åò„Çã</div>
  </div>
</div>

<script>
// Canvas & Âü∫Êú¨Ë®≠ÂÆö
const canvas = document.getElementById('tank');
const ctx = canvas.getContext('2d');
const tankWrapper = document.getElementById('tankWrapper');
function resize() {
  const w = Math.min(window.innerWidth - 40, 800);
  const h = Math.min(window.innerHeight - 220, 480);
  canvas.width = w; canvas.height = h;
}
resize();
window.addEventListener('resize', () => { resize(); initEnvironment(); });
</script>
<script src="js/data.js"></script>
<script src="js/fish.js"></script>
<script src="js/ui.js"></script>
<script src="js/gacha.js"></script>
<script src="js/game.js"></script>
</body>
</html>
